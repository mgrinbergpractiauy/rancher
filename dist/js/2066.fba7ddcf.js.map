{"version":3,"file":"js/2066.fba7ddcf.js","mappings":"uHAGA,IAAIA,EAAU,EAAQ,OACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,kBAAZF,IAAsBA,EAAU,CAAC,CAACG,EAAOC,GAAIJ,EAAS,MAC7DA,EAAQK,SAAQF,EAAOG,QAAUN,EAAQK,QAE5C,IAAIE,EAAM,WACGA,EAAI,WAAYP,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa,G,qJCC5E,SACE,WAAMQ,GACJ,IACE,MAAMC,QAAY,QAAQ,CAExBC,gBAAgB,QAAqBC,KAAKC,QAC1CC,KAAgB,IAAgBC,mBAAmBH,KAAKC,WAIrD,WACH,OAAWD,KAAKC,QAGlBD,KAAKE,KAAOJ,EAAII,IAClB,CAAE,MAAOE,GAAK,CAGdJ,KAAKK,sBAAwBL,KAAKE,QAAUF,KAAKD,cACnD,EAEA,IAAAO,GACE,MAAO,CACLJ,KAAM,KAAMG,oBAAqB,KAAME,aAAa,EAExD,EAEAC,SAAU,KACL,QAAW,CAAEC,SAAU,kBAM1B,cAAAV,GACE,OAAOC,KAAKC,OAAOS,QAAQ,kBAAkB,KAAWC,QAC1D,EAEA,KAAAC,GACE,MAAMC,EAAUb,KAAKD,gBAAgBe,KAAMC,GAAOA,EAAGtB,KAAO,KAAQuB,OAEpE,OAAOH,GAASI,KAClB,EAEA,KAAAC,GACE,MAAML,EAAUb,KAAKD,gBAAgBe,KAAMC,GAAOA,EAAGtB,KAAO,KAAQ0B,eAEpE,OAAON,GAASI,KAClB,EAEA,SAAAG,GACE,MAAMP,EAAUb,KAAKD,gBAAgBe,KAAMC,GAAOA,EAAGtB,KAAO,KAAQ4B,YAEpE,OAAOR,GAASI,KAClB,EAEA,KAAAK,GACE,MAAMT,EAAUb,KAAKD,gBAAgBe,KAAMC,GAAOA,EAAGtB,KAAO,KAAQ8B,OAGpE,OAAIV,GAASI,MACJJ,GAASI,MAGXjB,KAAKC,OAAOS,QAAQ,cAC7B,EAEA,UAAAc,GACE,OAAKxB,KAAKyB,kBAUH,IAAgBC,cAAc,CAAEzB,OAAQD,KAAKC,OAAQC,KAAMF,KAAKE,OAN9D,EAOX,EAEA,iBAAAuB,GAGE,OAAOzB,KAAKS,UAAYT,KAAKK,mBAC/B,GAGFsB,MAAO,CACLT,MAAO,CACL,OAAAU,CAAQC,GACFA,EACF7B,KAAK8B,eAAeD,GAEpB7B,KAAK+B,mBAET,EACAC,WAAW,GAEbZ,UAAW,CACT,OAAAQ,CAAQC,GACFA,EACF7B,KAAK8B,eAAeD,EAAK,QAEzB7B,KAAK+B,kBAAkB,OAE3B,EACAC,WAAW,GAEbV,MAAO,CACL,OAAAM,GACM5B,KAAKkB,OACPlB,KAAK8B,eAAe9B,KAAKkB,OAEvBlB,KAAKoB,WACPpB,KAAK8B,eAAe9B,KAAKoB,UAAW,QAEtCpB,KAAKiC,cACP,EACAD,WAAW,GAGbR,WAAY,CACV,OAAAI,CAAQC,GACN,GAAK7B,KAAKyB,mBAKNI,IAAQ7B,KAAKY,MAAO,CAEtB,MAAMsB,EAAelC,KAAKD,gBAAgBe,KAAMC,GAAOA,EAAGtB,KAAO,KAAQuB,OAEzE,GAAIkB,EACFA,EAAajB,MAAQ,MACrBiB,EAAaC,WACR,CACL,MAAMC,EAASpC,KAAKC,OAAOS,QAAQ,wBAAwB,KAAWC,SAChE0B,EAAMD,GAAQE,QAAQ,cAExBD,GACFrC,KAAKC,OAAOsC,SAAS,oBAAqB,CACxCC,KAAM,KAAW7B,QAAS8B,SAAU,CAAEC,KAAM,KAAQ1B,OAASC,MAAO,MAAO1B,QAAS,KACnFoD,KAAM9B,GAAYA,EAAQsB,OAEjC,CACF,CACF,EACAH,WAAW,GAEbpB,MAAO,CACL,OAAAgB,GACE5B,KAAKiC,cACP,EACAD,WAAW,IAIf,OAAAY,GACE5C,KAAKiC,gBACL,SACF,EACAY,QAAS,CACP,cAAAf,CAAeZ,EAAOwB,EAAO,WAC3B,MAAMI,GAAO,QAAc5B,EAAOlB,KAAKsB,MAAOoB,GAE9C,IAAK,MAAMK,KAAQD,EACjBE,SAASC,KAAKC,MAAMC,YAAYJ,EAAMD,EAAKC,GAE/C,EAEA,iBAAAhB,CAAkBW,EAAO,WACvB,MAAMI,GAAO,QAAc,aAAc9C,KAAKsB,MAAOoB,GAErD,IAAK,MAAMK,KAAQD,EACjBE,SAASC,KAAKC,MAAME,eAAeL,EAEvC,EACA,YAAAd,GACE,MAAMgB,EAAOD,SAASK,qBAAqB,QAAQ,GAC7CC,EAAW,iCACjB,IAAIC,EAAY,SAAUvD,KAAKsB,SAAWgC,IAE1C,GAAKtD,KAAKY,MACR,IACE,MAAM4C,EAAY,SAAQ,KAAwBxD,KAAKY,uBAEtB,SAA7B4C,GAAWC,cACbF,EAAY,GAAID,KAActD,KAAKY,eAAiBZ,KAAKsB,SAEzDiC,EAAY,SAAUvD,KAAKsB,uCAC3BtB,KAAKC,OAAOsC,SAAS,sBAAsC,SAAfvC,KAAKsB,OAErD,CAAE,MAAO,CAEX2B,EAAKS,UAAYH,CACnB,G,mHC1MAI,EAA0B,IAA4B,KAC1DA,EAAwBC,EAAE,KAE1BD,EAAwBE,KAAK,CAACrE,EAAOC,GAAI,8jCAA+jC,KAExmC,S,0ECHA,MAAMqE,EAAmB,CAAC,sBAAuB,+BAOjD,MAAMC,EACJ,oBAAOC,CAAc/D,GACnB,OAAOA,EAAOS,QAAQ,gCAAgC,CAAEjB,GAAI,KAAQwE,IAAKC,QAAS,YACpF,CAEA,yBAAO/D,CAAmBF,GAExB,OAAIA,EAAOS,QAAQ,sBAAsB,KAAQuD,KAC3CF,EAAgBC,cAAc/D,GAEzBA,EAAOsC,SAAS,sBAAuB,CAC5CC,KAAM,KAAQyB,IACdE,IAAM,CACJC,WAAY,IAAI,KAAW,CACzBC,QAAS,KAAsBC,qBAAqBR,EAAiBS,IAClEC,GAAM,IAAI,KAAsB,CAC/BC,MAAO,gBACPxD,MAAOuD,WAQZvE,EAAOsC,SAAS,qBAAsB,CAAEC,KAAM,KAAQyB,MAGxDS,QAAQC,QAAQ,GACzB,CAEA,oBAAOjD,EAAc,OAAEzB,EAAM,KAAEC,IAE7B,OAAW,OAAJA,QAAI,IAAJA,OAAI,EAAJA,EAAMY,KAAM8D,IAAK,MAAC,OAAAd,EAAiBe,SAAmB,QAAV,EAAAD,EAAEnC,gBAAQ,eAAEC,OACjE,EAGF,S,4GCkIQoC,MAAM,c,SAONA,MAAM,c,aAKHA,MAAM,iB,mBAqBHA,MAAM,c,SAONA,MAAM,c,8DA9DV,EAAU,a,WADlB,QA4EM,O,MA1EHrF,GAAI,EAAAA,I,CAGI,EAAAsF,aA4BO,EAAU,a,WAA1B,QA0CM,S,aAzCJ,QAAmC,OAA9BD,MAAM,uBAAqB,U,yBAChC,QAuCM,MAvCN,EAuCM,EAtCJ,QAqCM,OApCJA,MAAM,sBACL5B,OAAK,QAAE,EAAA8B,c,EAER,QAyBM,OAxBJF,MAAM,SACL5B,OAAK,QAAE,EAAA+B,c,CAGG,EAAa,gB,WAAxB,QAQM,W,aAPJ,QAMM,mBALoB,EAAAC,OAAOC,KAAI,CAA3BA,EAAMC,M,WADhB,QAMM,OAJHC,IAAKD,EACNN,MAAM,c,QAEHK,GAAI,K,SAIE,EAAAD,OAAW,O,WADxB,QAKM,MALN,GAKM,QADD,EAAAA,OAAOC,MAAI,IAGH,EAAAD,OAAW,M,qBADxB,QAIE,MAJF,EAIE,Y,GAFc,EAAAA,OAAOI,S,4CAIzB,QAMS,UALP,cAAY,mCACZR,MAAM,mBACL,QAAK,eAAE,EAAAS,gB,QAEL,EAAAL,OAAOM,QAAM,I,qCAnExB,QA4BM,O,MA1BJV,OAAK,SAAC,SAAQ,kBAGa,EAAAW,QAAS,gBAAiB,EAAAP,OAAOC,QAF5D,cAAY,gBACXjC,OAAK,QAAE,EAAA+B,c,CAIG,EAAa,gB,WAAxB,QAQM,W,aAPJ,QAMM,mBALoB,EAAAC,OAAOC,KAAI,CAA3BA,EAAMC,M,WADhB,QAMM,OAJHC,IAAKD,EACNN,MAAM,c,QAEHK,GAAI,K,SAIE,EAAAD,OAAW,O,WADxB,QAKM,MALN,GAKM,QADD,EAAAA,OAAOC,MAAI,IAGH,EAAAD,OAAW,M,qBADxB,QAIE,MAJF,EAIE,Y,GAFc,EAAAA,OAAOI,S,oGApL7B,SACEI,MAAO,CACLC,OAAQ,CACNnD,KAASoD,QACTrG,SAAS,GAEXkG,QAAS,CACPjD,KAASoD,QACTrG,SAAS,GAEXsG,OAAQ,CACNrD,KAASoD,QACTrG,SAAS,IAIb,IAAAe,GACE,MAAO,CACLwF,YAAa,EACbC,YAAa,EACbC,YAAa,EACbC,aAAa,EACbf,OAAa,CAAC,EAElB,EAEArC,QAAS,CACP,UAAA0C,GACEvF,KAAK8F,YAAa,CACpB,EACA,2BAAAI,CAA4BhB,GAC1B,GAAIA,EAAOC,MAAMgB,OAAQ,CAEvB,MAAMC,EAAYlB,EAAOC,KAAKkB,MAAM,MAAMC,OAAQC,GAAYA,GAE1DH,EAAUD,OAAS,IACrBC,EAAUI,QAAQ,CAACC,EAAK7C,KACtBwC,EAAUxC,GAAK6C,EAAIC,SAErBxB,EAAOC,KAAOiB,EAElB,CAEA,OAAOlB,CACT,GAGF1E,SAAU,CACR,kBAAAmG,GACE,OAAO,OAAqB3G,KAAKC,OACnC,EAEA,aAAA2G,GACE,OAAO5G,KAAKC,OAAOS,QAAQ,kBAAkB,KAAWC,SAASG,KAAM+F,GAAMA,EAAEpH,KAAO,KAAQqH,QAChG,EAEA,WAAA7B,GACE,MAAO,CACL/D,MAAoBlB,KAAKkF,OAAOhE,MAChC,mBAAoBlB,KAAKkF,OAAO6B,WAChC,aAAoB/G,KAAKkF,OAAO8B,cAChC,cAAoBhH,KAAKkF,OAAO+B,WAAa,OAAS,GACtD,aAAoBjH,KAAKkF,OAAOgC,UAAY,SAAW,GACvD,YAAoBlH,KAAKkF,OAAOiC,SAChC,kBAAoBnH,KAAKkF,OAAOkC,eAAiB,YAAc,GAEnE,EACA,WAAApC,GACE,MAAO,CACL9D,MAAoBlB,KAAKkF,OAAOhE,MAChC,mBAAoBlB,KAAKkF,OAAO6B,WAEpC,EACA,UAAAM,GACE,SAAKrH,KAAKkF,QAAQC,OAASnF,KAAKkF,QAAQ6B,cAIpC/G,KAAK2F,OACA3F,KAAK+F,WACH/F,KAAKyF,QACPzF,KAAKiG,YACHjG,KAAK6F,OACP7F,KAAKgG,WAGP,KACT,EACA,aAAAsB,GACE,OAAOC,MAAMC,QAAQxH,KAAKkF,QAAQC,KACpC,EACA,YAAAJ,GACE,OAAO/E,KAAKyF,WAAazF,KAAKkF,OAAOM,MACvC,EAGA,EAAA/F,GACE,OAAIO,KAAK2F,OACA,gBACE3F,KAAKyF,QACP,iBACEzF,KAAK6F,OACP,gBAGF,QACT,GAGFlE,MAAO,CACLiF,cAAe,CACba,MAAM,EACN,OAAA7F,CAAQC,GACN,GAAIA,GAAKZ,OAAuB,KAAdY,EAAIZ,MACpB,IACE,MAAMyG,EAASC,KAAKC,MAAM/F,EAAIZ,QAE9B,OAAyByG,EAAQ1H,KAAK2G,oBAEtC,MAAM,aACJkB,EAAY,aAAEC,EAAY,cAAEC,EAAa,OAAE7C,EAAM,WAAEa,EAAU,WAAEC,EAAU,YAAEC,GACzEyB,EACJ,IAAIM,EAAgBN,GAAQxC,QAAU,CAAC,EAEnC,IAAQA,KAER8C,EADEjC,GAAc/F,KAAK2F,OACL3F,KAAKkG,4BAA4B2B,IAAiB,CAAC,EAC1D5B,GAAejG,KAAKyF,QACbzF,KAAKkG,4BAA4B6B,IAAkB,CAAC,EAC3D/B,GAAchG,KAAK6F,QACZ7F,KAAKkG,4BAA4B4B,IAEjC,CAAC,GAIrB9H,KAAK+F,WAA4B,SAAfA,EAClB/F,KAAKgG,WAA4B,SAAfA,EAClBhG,KAAKiG,YAA8B,SAAhBA,EACnBjG,KAAKkF,OAAS8C,CAChB,CAAE,MAAO,CAEb,EACAhG,WAAW,K,uBC9IjB,MAAMiG,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,G,uECDA,MAAMC,EAAgB,eAChBC,EAAgB,eAChBC,EAAe,gBAEfC,EAAqB,CACzB,mBAA2BH,EAC3B,mBAA2BC,EAC3B,0BAA2BC,GAGvBE,EAAsB,CAC1B,CAACJ,GAAgB,aACjB,CAACC,GAAgB,aACjB,CAACC,GAAgB,eAMZ,SAASG,EAAqBC,GACnC,MAAMC,EAAU,CAAC,EAGXC,EAAcF,EAAM/H,QAAQ,kBAAkB,KAAWC,SAU/D,OARAgI,EAAYnC,QAAS3F,IACnB,GAAIA,EAAQI,OAAWqH,EAAmBzH,EAAQpB,IAAK,CACrD,MAAMmJ,EAAYN,EAAmBzH,EAAQpB,IAE7CiJ,EAAQE,GAAa/H,CACvB,IAGK6H,CACT,CAKO,SAASG,EAAyBC,EAAcJ,GACrDK,OAAOC,KAAKN,GAASlC,QAAS/G,IAC5B,IACE,MAAMwJ,EAAyBtB,KAAKC,MAAMc,EAAQjJ,GAAIwB,OAChDiI,EAAUX,EAAoB9I,GAEpCqJ,EAAarJ,GAAMwJ,EACnBH,EAAaI,GAAW,MAC1B,CAAE,MAAO,GAEb,C,kFCtDA,IAAIC,GAAa,EAEV,SAASC,IACd,OAAOD,CACT,CAEO,SAASE,EAAWZ,GACzB,MAAM3I,EAAM2I,EAAM/H,QAAQ,mBAAmB,KAAWC,QAAS,KAAQ2I,SACnEpH,EAAeuG,EAAM/H,QAAQ,mBAAmB,KAAWC,QAAS,KAAQK,OAC5EuI,EAAOC,EAAaxG,SAASyG,KAAKpG,qBAAqB,SAE7D,GAAIkG,EAAM,CACR,IAAIG,EAEwB,SAAxBxH,GAAcjB,MAChByI,EAAa,EAAQ,OACY,QAAxBxH,GAAcjB,MACvByI,EAAa,EAAQ,OACY,cAAxBxH,GAAcjB,QACvByI,EAAa,EAAQ,QAGvBH,EAAKI,KAAO7J,GAAKmB,OAASyI,GAAcE,EACxCT,GAAa,CACf,CACF,CAEA,SAASU,IACP,MAAMN,EAAOC,EAAaxG,SAASyG,KAAKpG,qBAAqB,SAE7D,OAAOkG,EAAOA,EAAKI,KAAO,EAC5B,CAEA,SAASH,EAAaM,GACpB,IAAK,IAAIlG,EAAI,EAAGA,EAAIkG,EAAM3D,OAAQvC,IAAK,CACrC,MAAM2F,EAAOO,EAAMlG,GAEnB,GAAI2F,EAAKQ,KAAKlF,SAAS,QACrB,OAAO0E,CAEX,CAGF,CAEA,MAAMK,EAAiBC,G","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/components/FixedBanner.vue?cec0","webpack://cluster-log-extension/./node_modules/@rancher/shell/mixins/brand.js","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/FixedBanner.vue?abfd","webpack://cluster-log-extension/./node_modules/@rancher/shell/utils/cspAdaptor.ts","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/FixedBanner.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/FixedBanner.vue?63c7","webpack://cluster-log-extension/./node_modules/@rancher/shell/utils/banners.js","webpack://cluster-log-extension/./node_modules/@rancher/shell/utils/favicon.js"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./FixedBanner.vue?vue&type=style&index=0&id=1cf95fcb&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"528afaa6\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","import { mapGetters } from 'vuex';\nimport { MANAGEMENT } from '@shell/config/types';\nimport { SETTING } from '@shell/config/settings';\nimport { createCssVars } from '@shell/utils/color';\nimport { setTitle } from '@shell/config/private-label';\nimport { setFavIcon, haveSetFavIcon } from '@shell/utils/favicon';\nimport { allHash } from '@shell/utils/promise';\nimport { fetchInitialSettings } from '@shell/utils/settings';\nimport CspAdapterUtils from '@shell/utils/cspAdaptor';\n\nexport default {\n  async fetch() {\n    try {\n      const res = await allHash({\n        // Ensure we read the settings even when we are not authenticated\n        globalSettings: fetchInitialSettings(this.$store),\n        apps:           CspAdapterUtils.fetchCspAdaptorApp(this.$store),\n      });\n\n      // The favicon is implicitly dependent on the initial settings having already been fetched\n      if (!haveSetFavIcon()) {\n        setFavIcon(this.$store);\n      }\n\n      this.apps = res.apps;\n    } catch (e) { }\n\n    // Setting this up front will remove `computed` churn, and we only care that we've initialised them\n    this.haveAppsAndSettings = !!this.apps && !!this.globalSettings;\n  },\n\n  data() {\n    return {\n      apps: null, haveAppsAndSettings: null, canPaginate: false\n    };\n  },\n\n  computed: {\n    ...mapGetters({ loggedIn: 'auth/loggedIn' }),\n\n    // added to fix https://github.com/rancher/dashboard/issues/10788\n    // because on logout the brand mixin is mounted, but then a management store reset happens\n    // since login view get loaded, another fetchInitialSettings get's done\n    // which in turn will populate again globalSettings\n    globalSettings() {\n      return this.$store.getters['management/all'](MANAGEMENT.SETTING);\n    },\n\n    brand() {\n      const setting = this.globalSettings?.find((gs) => gs.id === SETTING.BRAND);\n\n      return setting?.value;\n    },\n\n    color() {\n      const setting = this.globalSettings?.find((gs) => gs.id === SETTING.PRIMARY_COLOR);\n\n      return setting?.value;\n    },\n\n    linkColor() {\n      const setting = this.globalSettings?.find((gs) => gs.id === SETTING.LINK_COLOR);\n\n      return setting?.value;\n    },\n\n    theme() {\n      const setting = this.globalSettings?.find((gs) => gs.id === SETTING.THEME);\n\n      // This handles cases where the settings update after the page loads (like on log out)\n      if (setting?.value) {\n        return setting?.value;\n      }\n\n      return this.$store.getters['prefs/theme'];\n    },\n\n    cspAdapter() {\n      if (!this.canCalcCspAdapter) {\n        // We only have a watch on cspAdapter to kick off persisting the brand setting.\n        // So we need to ensure we don't return an undefined here... which would match the undefined gave if no csp app was found...\n        // .. and wouldn't kick off the watcher\n        return '';\n      }\n\n      // Note! this used to be `findBy(this.app)` however for that case we lost reactivity on the collection\n      // (computed fires before fetch, fetch happens and update apps, computed would not fire again - even with vue.set)\n      // So use `.find` in method instead\n      return CspAdapterUtils.hasCspAdapter({ $store: this.$store, apps: this.apps });\n    },\n\n    canCalcCspAdapter() {\n      // We need to take consider the loggedIn state, as the brand mixin is used in the logout page where we can be in a mixed state\n      // (things in store but user has no auth to make changes)\n      return this.loggedIn && this.haveAppsAndSettings;\n    }\n  },\n\n  watch: {\n    color: {\n      handler(neu) {\n        if (neu) {\n          this.setCustomColor(neu);\n        } else {\n          this.removeCustomColor();\n        }\n      },\n      immediate: true\n    },\n    linkColor: {\n      handler(neu) {\n        if (neu) {\n          this.setCustomColor(neu, 'link');\n        } else {\n          this.removeCustomColor('link');\n        }\n      },\n      immediate: true\n    },\n    theme: {\n      handler() {\n        if (this.color) {\n          this.setCustomColor(this.color);\n        }\n        if (this.linkColor) {\n          this.setCustomColor(this.linkColor, 'link');\n        }\n        this.setBodyClass();\n      },\n      immediate: true\n    },\n\n    cspAdapter: {\n      handler(neu) {\n        if (!this.canCalcCspAdapter) {\n          return;\n        }\n\n        // The brand setting will only get updated if...\n        if (neu && !this.brand) {\n          // 1) There should be a brand... but there's no brand setting\n          const brandSetting = this.globalSettings?.find((gs) => gs.id === SETTING.BRAND);\n\n          if (brandSetting) {\n            brandSetting.value = 'csp';\n            brandSetting.save();\n          } else {\n            const schema = this.$store.getters['management/schemaFor'](MANAGEMENT.SETTING);\n            const url = schema?.linkFor('collection');\n\n            if (url) {\n              this.$store.dispatch('management/create', {\n                type: MANAGEMENT.SETTING, metadata: { name: SETTING.BRAND }, value: 'csp', default: ''\n              }).then((setting) => setting.save());\n            }\n          }\n        }\n      },\n      immediate: true\n    },\n    brand: {\n      handler() {\n        this.setBodyClass();\n      },\n      immediate: true\n    }\n\n  },\n  mounted() {\n    this.setBodyClass();\n    setTitle();\n  },\n  methods: {\n    setCustomColor(color, name = 'primary') {\n      const vars = createCssVars(color, this.theme, name);\n\n      for (const prop in vars) {\n        document.body.style.setProperty(prop, vars[prop]);\n      }\n    },\n\n    removeCustomColor(name = 'primary') {\n      const vars = createCssVars('rgb(0,0,0)', this.theme, name);\n\n      for (const prop in vars) {\n        document.body.style.removeProperty(prop);\n      }\n    },\n    setBodyClass() {\n      const body = document.getElementsByTagName('body')[0];\n      const cssClass = `overflow-hidden dashboard-body`;\n      let bodyClass = `theme-${ this.theme } ${ cssClass }`;\n\n      if ( this.brand ) {\n        try {\n          const brandMeta = require(`~shell/assets/brand/${ this.brand }/metadata.json`);\n\n          if (brandMeta?.hasStylesheet === 'true') {\n            bodyClass = `${ cssClass } ${ this.brand } theme-${ this.theme }`;\n          } else {\n            bodyClass = `theme-${ this.theme } overflow-hidden dashboard-body`;\n            this.$store.dispatch('prefs/setBrandStyle', this.theme === 'dark');\n          }\n        } catch {}\n      }\n      body.className = bodyClass;\n    }\n  }\n\n};\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.banner[data-v-1cf95fcb]{line-height:2em;width:100%}.banner.banner-text[data-v-1cf95fcb]{padding:0 20px;text-align:center}.banner.banner-consent[data-v-1cf95fcb]{height:unset;min-height:2em;overflow:hidden}.banner-dialog[data-v-1cf95fcb],.banner-dialog-glass[data-v-1cf95fcb]{position:absolute;top:0;left:0;width:100vw;height:100vh}.banner-dialog-glass[data-v-1cf95fcb]{z-index:5000;background-color:var(--default);opacity:.75}.banner-dialog[data-v-1cf95fcb]{z-index:5001;display:flex;align-items:center;justify-content:center}.banner-dialog .banner-dialog-frame[data-v-1cf95fcb]{border:2px solid var(--border);display:flex;align-items:center;flex-direction:column;padding:20px;height:-moz-fit-content;height:fit-content;width:-moz-fit-content;width:fit-content;min-width:50%;max-width:80%;max-height:90%}.banner-dialog .banner-dialog-frame .banner[data-v-1cf95fcb]{height:auto;overflow-y:auto}.banner-dialog .banner-dialog-frame button[data-v-1cf95fcb]{margin-top:10px;max-width:50%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:-moz-fit-content;width:fit-content}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// For testing these could be changed to something like...\n\nimport { CATALOG } from '@shell/config/types';\nimport { FilterArgs, PaginationFilterField, PaginationParamFilter } from '@shell/types/store/pagination.types';\nimport { VuexStore } from '@shell/types/store/vuex';\n\nconst CSP_ADAPTER_APPS = ['rancher-csp-adapter', 'rancher-csp-billing-adapter'];\n// For testing above line could be replaced with below line...\n// const cspAdaptorApp = ['rancher-webhooka', 'rancher-webhook'];\n\n/**\n * Helpers in order to\n */\nclass CspAdapterUtils {\n  static canPagination($store: VuexStore): boolean {\n    return $store.getters[`management/paginationEnabled`]({ id: CATALOG.APP, context: 'branding' });\n  }\n\n  static fetchCspAdaptorApp($store: VuexStore): Promise<any> {\n    // For the login page, the schemas won't be loaded - we don't need the apps in this case\n    if ($store.getters['management/canList'](CATALOG.APP)) {\n      if (CspAdapterUtils.canPagination($store)) {\n        // Restrict the amount of apps we need to fetch\n        return $store.dispatch('management/findPage', {\n          type: CATALOG.APP,\n          opt:  { // Of type ActionFindPageArgs\n            pagination: new FilterArgs({\n              filters: PaginationParamFilter.createMultipleFields(CSP_ADAPTER_APPS.map(\n                (t) => new PaginationFilterField({\n                  field: 'metadata.name',\n                  value: t,\n                })\n              )),\n            })\n          }\n        });\n      }\n\n      return $store.dispatch('management/findAll', { type: CATALOG.APP });\n    }\n\n    return Promise.resolve([]);\n  }\n\n  static hasCspAdapter({ $store, apps }: { $store: VuexStore, apps: any[]}): Object {\n    // In theory this should contain the filtered apps when pagination is on, and all apps when off. Keep filtering though in both cases just in case\n    return apps?.find((a) => CSP_ADAPTER_APPS.includes(a.metadata?.name));\n  }\n}\n\nexport default CspAdapterUtils;\n","<script>\nimport { MANAGEMENT } from '@shell/config/types';\nimport { SETTING } from '@shell/config/settings';\nimport isEmpty from 'lodash/isEmpty';\nimport { getIndividualBanners, overlayIndividualBanners } from '@shell/utils/banners';\n\nexport default {\n  props: {\n    header: {\n      type:    Boolean,\n      default: false\n    },\n    consent: {\n      type:    Boolean,\n      default: false\n    },\n    footer: {\n      type:    Boolean,\n      default: false\n    },\n  },\n\n  data() {\n    return {\n      showDialog:  true,\n      showHeader:  false,\n      showFooter:  false,\n      showConsent: false,\n      banner:      {},\n    };\n  },\n\n  methods: {\n    hideDialog() {\n      this.showDialog = false;\n    },\n    handleLineBreaksConsentText(banner) {\n      if (banner.text?.length) {\n        // split text by newline char\n        const textArray = banner.text.split('\\n').filter((element) => element);\n\n        if (textArray.length > 1) {\n          textArray.forEach((str, i) => {\n            textArray[i] = str.trim();\n          });\n          banner.text = textArray;\n        }\n      }\n\n      return banner;\n    }\n  },\n\n  computed: {\n    uiBannerIndividual() {\n      return getIndividualBanners(this.$store);\n    },\n\n    bannerSetting() {\n      return this.$store.getters['management/all'](MANAGEMENT.SETTING).find((s) => s.id === SETTING.BANNERS);\n    },\n\n    bannerStyle() {\n      return {\n        color:              this.banner.color,\n        'background-color': this.banner.background,\n        'text-align':       this.banner.textAlignment,\n        'font-weight':      this.banner.fontWeight ? 'bold' : '',\n        'font-style':       this.banner.fontStyle ? 'italic' : '',\n        'font-size':        this.banner.fontSize,\n        'text-decoration':  this.banner.textDecoration ? 'underline' : ''\n      };\n    },\n    dialogStyle() {\n      return {\n        color:              this.banner.color,\n        'background-color': this.banner.background\n      };\n    },\n    showBanner() {\n      if (!this.banner?.text && !this.banner?.background) {\n        return false;\n      }\n\n      if (this.header) {\n        return this.showHeader;\n      } else if (this.consent) {\n        return this.showConsent;\n      } else if (this.footer) {\n        return this.showFooter;\n      }\n\n      return null;\n    },\n    isTextAnArray() {\n      return Array.isArray(this.banner?.text);\n    },\n    showAsDialog() {\n      return this.consent && !!this.banner.button;\n    },\n\n    // ID to place on the Banner DIV\n    id() {\n      if (this.header) {\n        return 'banner-header';\n      } else if (this.consent) {\n        return 'banner-consent';\n      } else if (this.footer) {\n        return 'banner-footer';\n      }\n\n      return 'banner';\n    }\n  },\n\n  watch: {\n    bannerSetting: {\n      deep: true,\n      handler(neu) {\n        if (neu?.value && neu.value !== '') {\n          try {\n            const parsed = JSON.parse(neu.value);\n\n            overlayIndividualBanners(parsed, this.uiBannerIndividual);\n\n            const {\n              bannerHeader, bannerFooter, bannerConsent, banner, showHeader, showFooter, showConsent\n            } = parsed;\n            let bannerContent = parsed?.banner || {};\n\n            if (isEmpty(banner)) {\n              if (showHeader && this.header) {\n                bannerContent = this.handleLineBreaksConsentText(bannerHeader) || {};\n              } else if (showConsent && this.consent) {\n                bannerContent = this.handleLineBreaksConsentText(bannerConsent) || {};\n              } else if (showFooter && this.footer) {\n                bannerContent = this.handleLineBreaksConsentText(bannerFooter) || {};\n              } else {\n                bannerContent = {};\n              }\n            }\n\n            this.showHeader = showHeader === 'true';\n            this.showFooter = showFooter === 'true';\n            this.showConsent = showConsent === 'true';\n            this.banner = bannerContent;\n          } catch {}\n        }\n      },\n      immediate: true\n    },\n\n  }\n};\n</script>\n\n<template>\n  <div\n    v-if=\"showBanner\"\n    :id=\"id\"\n  >\n    <div\n      v-if=\"!showAsDialog\"\n      class=\"banner\"\n      data-testid=\"fixed__banner\"\n      :style=\"bannerStyle\"\n      :class=\"{'banner-consent': consent, 'banner-text': !!banner.text}\"\n    >\n      <!-- text as array to support line breaks programmatically rather than just exposing HTML -->\n      <div v-if=\"isTextAnArray\">\n        <div\n          v-for=\"(text, index) in banner.text\"\n          :key=\"index\"\n          class=\"array-row\"\n        >\n          {{ text }}\n        </div>\n      </div>\n      <div\n        v-else-if=\"banner.text\"\n        class=\"single-row\"\n      >\n        {{ banner.text }}\n      </div>\n      <div\n        v-else-if=\"banner.html\"\n        v-clean-html=\"banner.html\"\n        class=\"single-row\"\n      />\n    </div>\n    <div v-else-if=\"showDialog\">\n      <div class=\"banner-dialog-glass\" />\n      <div class=\"banner-dialog\">\n        <div\n          class=\"banner-dialog-frame\"\n          :style=\"dialogStyle\"\n        >\n          <div\n            class=\"banner\"\n            :style=\"bannerStyle\"\n          >\n            <!-- text as array to support line breaks programmatically rather than just exposing HTML -->\n            <div v-if=\"isTextAnArray\">\n              <div\n                v-for=\"(text, index) in banner.text\"\n                :key=\"index\"\n                class=\"array-row\"\n              >\n                {{ text }}\n              </div>\n            </div>\n            <div\n              v-else-if=\"banner.text\"\n              class=\"single-row\"\n            >\n              {{ banner.text }}\n            </div>\n            <div\n              v-else-if=\"banner.html\"\n              v-clean-html=\"banner.html\"\n              class=\"single-row\"\n            />\n          </div>\n          <button\n            data-testid=\"login-confirmation-accept-button\"\n            class=\"btn role-primary\"\n            @click=\"hideDialog()\"\n          >\n            {{ banner.button }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .banner {\n    line-height: 2em;\n    width: 100%;\n\n    &.banner-text {\n      padding: 0 20px;\n      text-align: center;\n    }\n\n    &.banner-consent {\n      height: unset;\n      min-height: 2em;\n      overflow: hidden;\n    }\n  }\n  .banner-dialog, .banner-dialog-glass {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100vw;\n    height: 100vh;\n  }\n  .banner-dialog-glass {\n    z-index: 5000;\n    background-color: var(--default);\n    opacity: 0.75;\n  }\n  .banner-dialog {\n    z-index: 5001;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    .banner-dialog-frame {\n      border: 2px solid var(--border);\n      display: flex;\n      align-items: center;\n      flex-direction: column;\n      padding: 20px;\n      height: fit-content;\n      width: fit-content;\n      min-width: 50%;\n      max-width: 80%;\n      max-height: 90%;\n\n      .banner {\n        height: initial;\n        overflow-y: auto;\n      }\n\n      button {\n        margin-top: 10px;\n        max-width: 50%;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        width: fit-content;\n      }\n    }\n  }\n</style>\n","import { render } from \"./FixedBanner.vue?vue&type=template&id=1cf95fcb&scoped=true\"\nimport script from \"./FixedBanner.vue?vue&type=script&lang=js\"\nexport * from \"./FixedBanner.vue?vue&type=script&lang=js\"\n\nimport \"./FixedBanner.vue?vue&type=style&index=0&id=1cf95fcb&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1cf95fcb\"]])\n\nexport default __exports__","/**\n *\n * Helper utilities for the fixed banners that can be configured to show on pages\n *\n */\n\nimport { MANAGEMENT } from '@shell/config/types';\n\nconst BANNER_HEADER = 'bannerHeader';\nconst BANNER_FOOTER = 'bannerFooter';\nconst BANNER_LOGIN = 'bannerConsent';\n\nconst INDIVIDUAL_BANNERS = {\n  'ui-banner-header':        BANNER_HEADER,\n  'ui-banner-footer':        BANNER_FOOTER,\n  'ui-banner-login-consent': BANNER_LOGIN,\n};\n\nconst BANNER_SHOW_KEY_MAP = {\n  [BANNER_HEADER]: 'showHeader',\n  [BANNER_FOOTER]: 'showFooter',\n  [BANNER_LOGIN]:  'showConsent',\n};\n\n/**\n * Get the individual banner settings\n */\nexport function getIndividualBanners(store) {\n  const banners = {};\n\n  // Go through all settings looking for the individual settings\n  const allSettings = store.getters['management/all'](MANAGEMENT.SETTING);\n\n  allSettings.forEach((setting) => {\n    if (setting.value && !!INDIVIDUAL_BANNERS[setting.id]) {\n      const settingId = INDIVIDUAL_BANNERS[setting.id];\n\n      banners[settingId] = setting;\n    }\n  });\n\n  return banners;\n}\n\n/**\n * Overlay settings from the individual banner settings onto the single banner setting\n */\nexport function overlayIndividualBanners(parsedBanner, banners) {\n  Object.keys(banners).forEach((id) => {\n    try {\n      const parsedIndividualBanner = JSON.parse(banners[id].value);\n      const shownID = BANNER_SHOW_KEY_MAP[id];\n\n      parsedBanner[id] = parsedIndividualBanner;\n      parsedBanner[shownID] = 'true'; // If there is an individual banner setting, then banner is shown\n    } catch {}\n  });\n}\n","import { SETTING } from '@shell/config/settings';\nimport { MANAGEMENT } from '@shell/config/types';\n\nlet favIconSet = false;\n\nexport function haveSetFavIcon() {\n  return favIconSet;\n}\n\nexport function setFavIcon(store) {\n  const res = store.getters['management/byId'](MANAGEMENT.SETTING, SETTING.FAVICON);\n  const brandSetting = store.getters['management/byId'](MANAGEMENT.SETTING, SETTING.BRAND);\n  const link = findIconLink(document.head.getElementsByTagName('link'));\n\n  if (link) {\n    let brandImage;\n\n    if (brandSetting?.value === 'suse') {\n      brandImage = require('~shell/assets/brand/suse/favicon.png');\n    } else if (brandSetting?.value === 'csp') {\n      brandImage = require('~shell/assets/brand/csp/favicon.png');\n    } else if (brandSetting?.value === 'harvester') {\n      brandImage = require('~shell/assets/brand/harvester/favicon.png');\n    }\n\n    link.href = res?.value || brandImage || defaultFavIcon;\n    favIconSet = true;\n  }\n}\n\nfunction getCurrentFavIcon() {\n  const link = findIconLink(document.head.getElementsByTagName('link'));\n\n  return link ? link.href : '';\n}\n\nfunction findIconLink(links) {\n  for (let i = 0; i < links.length; i++) {\n    const link = links[i];\n\n    if (link.rel?.includes('icon')) {\n      return link;\n    }\n  }\n\n  return undefined;\n}\n\nconst defaultFavIcon = getCurrentFavIcon();\n"],"names":["content","__esModule","default","module","id","locals","exports","add","fetch","res","globalSettings","this","$store","apps","fetchCspAdaptorApp","e","haveAppsAndSettings","data","canPaginate","computed","loggedIn","getters","SETTING","brand","setting","find","gs","BRAND","value","color","PRIMARY_COLOR","linkColor","LINK_COLOR","theme","THEME","cspAdapter","canCalcCspAdapter","hasCspAdapter","watch","handler","neu","setCustomColor","removeCustomColor","immediate","setBodyClass","brandSetting","save","schema","url","linkFor","dispatch","type","metadata","name","then","mounted","methods","vars","prop","document","body","style","setProperty","removeProperty","getElementsByTagName","cssClass","bodyClass","brandMeta","hasStylesheet","className","___CSS_LOADER_EXPORT___","i","push","CSP_ADAPTER_APPS","CspAdapterUtils","canPagination","APP","context","opt","pagination","filters","createMultipleFields","map","t","field","Promise","resolve","a","includes","class","showAsDialog","dialogStyle","bannerStyle","banner","text","index","key","html","hideDialog","button","consent","props","header","Boolean","footer","showDialog","showHeader","showFooter","showConsent","handleLineBreaksConsentText","length","textArray","split","filter","element","forEach","str","trim","uiBannerIndividual","bannerSetting","s","BANNERS","background","textAlignment","fontWeight","fontStyle","fontSize","textDecoration","showBanner","isTextAnArray","Array","isArray","deep","parsed","JSON","parse","bannerHeader","bannerFooter","bannerConsent","bannerContent","__exports__","render","BANNER_HEADER","BANNER_FOOTER","BANNER_LOGIN","INDIVIDUAL_BANNERS","BANNER_SHOW_KEY_MAP","getIndividualBanners","store","banners","allSettings","settingId","overlayIndividualBanners","parsedBanner","Object","keys","parsedIndividualBanner","shownID","favIconSet","haveSetFavIcon","setFavIcon","FAVICON","link","findIconLink","head","brandImage","href","defaultFavIcon","getCurrentFavIcon","links","rel"],"ignoreList":[],"sourceRoot":""}