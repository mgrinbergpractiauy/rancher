(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[5614],{49752:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>L});var l=t(20641),i=t(90033);const n={class:"plugin-install-dialog"},s={class:"custom mt-10"},o={class:"fields"},d={class:"custom mt-10"},c={class:"fields"},u={class:"fields mt-10"},p={class:"dialog-buttons mt-20"};function r(e,a,t,r,g,f){const h=(0,l.g2)("LabeledInput"),m=(0,l.g2)("Checkbox"),v=(0,l.g2)("AsyncButton"),b=(0,l.gN)("focus");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.Lk)("h4",null,(0,i.v_)(e.t("plugins.developer.title")),1),a[7]||(a[7]=(0,l.eW)()),(0,l.Lk)("p",null,(0,i.v_)(e.t("plugins.developer.prompt")),1),a[8]||(a[8]=(0,l.eW)()),(0,l.Lk)("div",s,[(0,l.Lk)("div",o,[(0,l.bo)((0,l.bF)(h,{value:g.location,"onUpdate:value":[a[0]||(a[0]=e=>g.location=e),f.updateLocation],"label-key":"plugins.developer.fields.url"},null,8,["value","onUpdate:value"]),[[b]])])]),a[9]||(a[9]=(0,l.eW)()),(0,l.Lk)("div",d,[(0,l.Lk)("div",c,[(0,l.bF)(h,{value:g.name,"onUpdate:value":[a[1]||(a[1]=e=>g.name=e),f.updateName],"label-key":"plugins.developer.fields.name"},null,8,["value","onUpdate:value"])]),a[5]||(a[5]=(0,l.eW)()),(0,l.Lk)("div",u,[(0,l.bF)(m,{value:g.persist,"onUpdate:value":a[2]||(a[2]=e=>g.persist=e),"label-key":"plugins.developer.fields.persist"},null,8,["value"])]),a[6]||(a[6]=(0,l.eW)()),(0,l.Lk)("div",p,[(0,l.Lk)("button",{class:"btn role-secondary","data-testid":"dev-install-ext-modal-cancel-btn",onClick:a[3]||(a[3]=e=>f.closeDialog())},(0,i.v_)(e.t("generic.cancel")),1),a[4]||(a[4]=(0,l.eW)()),(0,l.bF)(v,{mode:"load","data-testid":"dev-install-ext-modal-install-btn",onClick:f.loadPlugin},null,8,["onClick"])])])])}var g=t(72268),f=t(16372),h=t(54012),m=t(55823),v=t(62428),b=t(96763);const y={emits:["close"],components:{AsyncButton:g.A,Checkbox:h.A,LabeledInput:f.o},props:{closed:{type:Function,default:()=>{},required:!0},resources:{type:Array,default:()=>[]},registerBackgroundClosing:{type:Function,default:()=>{}}},data(){return{name:"",location:"",persist:!1,canModifyName:!0,canModifyLocation:!0}},watch:{name(e){this.canModifyLocation&&(this.location=`/pkg/${e}/${e}.umd.min.js`)},location(e,a){if(this.canModifyName){const a=e.split("/");let t=a[a.length-1],l=t.indexOf(".umd.min.js");-1!==l?t=t.substr(0,l):(l=t.indexOf(".umd.js"),-1!==l&&(t=t.substr(0,l))),this.name=t}}},methods:{closeDialog(e){this.closed(e),this.$emit("close")},updateName(e){this.canModifyName=0===e.length},updateLocation(e){this.canModifyLocation=0===e.length},async loadPlugin(e){let a=this.name;const t=this.location;if(!a){const e=t.split("/"),l=e[e.length-1];a=l.split(".")[0]}let l="0.0.1",i=a;const n=a.split("-");if(n.length>=2&&(l=n.pop(),i=n.join("-")),this.persist){const n=await this.$store.dispatch("management/create",{type:m.hX,metadata:{name:a,namespace:v.th},spec:{plugin:{name:i,version:l,endpoint:t,noCache:!0,metadata:{developer:"true",direct:"true",[v.BC.EXTENSIONS_VERSION]:">= 3"},noAuth:!0}}});try{await n.save({url:`/v1/${m.hX}`,method:"POST"})}catch(s){b.error("Could not create CRD for plugin",s),e(!1)}}this.$plugin.loadAsync(a,t).then(()=>{this.closeDialog(!0),this.$store.dispatch("growl/success",{title:this.t("plugins.success.title",{name:a}),message:this.t("plugins.success.message"),timeout:3e3},{root:!0}),e(!0)}).catch(a=>{e(!1);const t="object"===typeof a?this.t("plugins.error.message"):a;this.$store.dispatch("growl/error",{title:this.t("plugins.error.title"),message:t,timeout:5e3},{root:!0})})}}};t(88919);var x=t(66262);const k=(0,x.A)(y,[["render",r],["__scopeId","data-v-acf0fd8a"]]),L=k},86353:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var l=t(31601),i=t.n(l),n=t(76314),s=t.n(n),o=t(5111),d=s()(i());d.i(o.A),d.push([e.id,".plugin-install-dialog[data-v-acf0fd8a]{padding:10px}.plugin-install-dialog h4[data-v-acf0fd8a]{font-weight:700}.plugin-install-dialog .dialog-panel[data-v-acf0fd8a]{display:flex;flex-direction:column;min-height:100px}.plugin-install-dialog .dialog-panel p[data-v-acf0fd8a]{margin-bottom:5px}.plugin-install-dialog .dialog-panel .dialog-info[data-v-acf0fd8a]{flex:1}.plugin-install-dialog .dialog-panel .toggle-advanced[data-v-acf0fd8a]{display:flex;align-items:center;cursor:pointer;margin:10px 0}.plugin-install-dialog .dialog-panel .toggle-advanced[data-v-acf0fd8a]:hover{text-decoration:none;color:var(--link)}.plugin-install-dialog .dialog-panel .version-selector[data-v-acf0fd8a]{margin:0 10px 10px 10px;width:auto}.plugin-install-dialog .dialog-buttons[data-v-acf0fd8a]{display:flex;justify-content:flex-end;margin-top:10px}.plugin-install-dialog .dialog-buttons[data-v-acf0fd8a]>:not(:last-child){margin-right:10px}",""]);const c=d},88919:(e,a,t)=>{var l=t(86353);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var i=t(99548).A;i("f4ebaeec",l,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=dialog16.c16aba7e.js.map