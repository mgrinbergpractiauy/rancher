(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[2119],{16136:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(31601),o=r.n(s),a=r(76314),n=r.n(a),i=r(5111),l=n()(o());l.i(i.A),l.push([e.id,".prompt-rotate[data-v-59231971]{margin:0}.buttons[data-v-59231971]{display:flex;justify-content:flex-end;width:100%}",""]);const c=l},19924:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(20641),o=r(90033);const a={class:"text-default-text"},n={class:"pl-10 pr-10"},i={class:"buttons"};function l(e,t,r,l,c,d){const p=(0,s.g2)("Banner"),u=(0,s.g2)("ProjectMemberEditor"),m=(0,s.g2)("AsyncButton"),h=(0,s.g2)("Card"),v=(0,s.gN)("clean-html");return(0,s.uX)(),(0,s.Wv)(h,{class:"prompt-rotate","show-highlight-border":!1,sticky:!0},{title:(0,s.k6)(()=>[(0,s.bo)((0,s.Lk)("h4",a,null,512),[[v,e.t("addProjectMemberDialog.title")]])]),body:(0,s.k6)(()=>[(0,s.Lk)("div",n,[c.error?((0,s.uX)(),(0,s.Wv)(p,{key:0,color:"error"},{default:(0,s.k6)(()=>[(0,s.eW)((0,o.v_)(c.error),1)]),_:1})):(0,s.Q3)("",!0),t[4]||(t[4]=(0,s.eW)()),(0,s.bF)(u,{value:c.member,"onUpdate:value":t[0]||(t[0]=e=>c.member=e),"use-two-columns-for-custom":!0},null,8,["value"])])]),actions:(0,s.k6)(()=>[(0,s.Lk)("div",i,[(0,s.Lk)("button",{class:"btn role-secondary mr-10",onClick:t[1]||(t[1]=(...e)=>d.close&&d.close(...e))},(0,o.v_)(e.t("generic.cancel")),1),t[5]||(t[5]=(0,s.eW)()),r.saveInModal?((0,s.uX)(),(0,s.Wv)(m,{key:0,mode:"create",onClick:t[2]||(t[2]=e=>d.saveBindings(e))})):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn role-primary",onClick:t[3]||(t[3]=(...e)=>d.apply&&d.apply(...e))},(0,o.v_)(e.t("generic.add")),1))])]),_:1,__:[6,7]})}var c=r(40949),d=r(99668),p=r(72268),u=r(59069),m=r(55823);const h={emits:["close"],components:{Card:c.Z,ProjectMemberEditor:d.A,AsyncButton:p.A,Banner:u.A},props:{resources:{type:Array,required:!0},onAdd:{type:Function,default:()=>{}},projectId:{type:String,default:null},saveInModal:{type:Boolean,default:!1}},data(){return{member:{permissionGroup:"member",custom:{},principalId:"",roleTemplateIds:[]},error:null}},computed:{principal(){const e=this.member.principalId.replace(/\//g,"%2F");return this.$store.dispatch("rancher/find",{type:m.k$.PRINCIPAL,id:this.member.principalId,opt:{url:`/v3/principals/${e}`}},{root:!0})}},methods:{async principalProperty(){const e=await this.principal;return"group"===e?.principalType?"groupPrincipalId":"userPrincipalId"},close(){this.$emit("close")},async apply(){this.onAdd(await this.createBindings()),this.close()},async createBindings(){const e=await this.principalProperty(),t=this.member.roleTemplateIds.map(t=>this.$store.dispatch("rancher/create",{type:m.k$.PROJECT_ROLE_TEMPLATE_BINDING,roleTemplateId:t,[e]:this.member.principalId,projectId:this.projectId}));return Promise.all(t)},saveBindings(e){this.error=null,this.createBindings().then(e=>Promise.all(e.map(e=>e.save()))).then(()=>{e(!0),setTimeout(this.close,500)}).catch(t=>{this.error=t,e(!1)})}}};r(64846),r(94620);var v=r(66262);const y=(0,v.A)(h,[["render",l],["__scopeId","data-v-59231971"]]),b=y},64846:(e,t,r)=>{var s=r(16136);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var o=r(99548).A;o("24c31c04",s,!0,{sourceMap:!1,shadowMode:!1})},94620:(e,t,r)=>{var s=r(98778);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var o=r(99548).A;o("0b9f546a",s,!0,{sourceMap:!1,shadowMode:!1})},98778:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(31601),o=r.n(s),a=r(76314),n=r.n(a),i=r(5111),l=n()(o());l.i(i.A),l.push([e.id,".card-container{border:1px solid var(--border);box-shadow:none}",""]);const c=l}}]);
//# sourceMappingURL=dialog6.04d4917a.js.map