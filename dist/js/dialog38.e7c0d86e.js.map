{"version":3,"file":"js/dialog38.e7c0d86e.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ImportDialog.vue?543c","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ImportDialog.vue?39ce","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ImportDialog.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ImportDialog.vue?d6db"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.yaml-editor[data-v-ca2b0dd2]{flex:1;min-height:50vh;max-height:50vh}.yaml-editor[data-v-ca2b0dd2]  .code-mirror .CodeMirror{position:static}.yaml-editor[data-v-ca2b0dd2]  .code-mirror .CodeMirror,.yaml-editor[data-v-ca2b0dd2]  .code-mirror .CodeMirror-gutters,.yaml-editor[data-v-ca2b0dd2]  .code-mirror .CodeMirror-scroll{min-height:50vh;max-height:50vh}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./ImportDialog.vue?vue&type=style&index=0&id=ca2b0dd2&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"82c8e3f2\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","<script>\nimport { mapGetters } from 'vuex';\nimport { Card } from '@components/Card';\nimport { Banner } from '@components/Banner';\nimport YamlEditor from '@shell/components/YamlEditor';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport SortableTable from '@shell/components/SortableTable';\nimport { sortBy } from '@shell/utils/sort';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\nimport { NAMESPACE } from '@shell/config/types';\nimport { NAME as NAME_COL, TYPE, NAMESPACE as NAMESPACE_COL, AGE } from '@shell/config/table-headers';\n\nexport default {\n  emits: ['close', 'onReadyYamlEditor'],\n\n  components: {\n    AsyncButton,\n    Banner,\n    Card,\n    YamlEditor,\n    FileSelector,\n    LabeledSelect,\n    SortableTable\n  },\n\n  props: {\n    defaultNamespace: {\n      type:    String,\n      default: undefined\n    },\n  },\n\n  async fetch() {\n    this.allNamespaces = (await this.$store.dispatch('cluster/findAll', { type: NAMESPACE, opt: { url: 'namespaces' } })) || [];\n\n    if (this.selectedNamespace === undefined) {\n      const defaultNamespace = 'default';\n      const hasAccessToDefaultNamespace = this.allNamespaces.some((ns) => ns.name === defaultNamespace);\n\n      this.selectedNamespace = hasAccessToDefaultNamespace ? defaultNamespace : this.allNamespaces[0]?.name;\n    }\n  },\n\n  data() {\n    return {\n      currentYaml:       '',\n      allNamespaces:     [],\n      errors:            null,\n      rows:              null,\n      done:              false,\n      selectedNamespace: this.defaultNamespace,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n\n    namespaceOptions() {\n      const out = this.allNamespaces.map((obj) => {\n        return {\n          label: obj.name,\n          value: obj.name,\n        };\n      });\n\n      return sortBy(out, 'label');\n    },\n\n    headers() {\n      return [\n        TYPE,\n        NAME_COL,\n        NAMESPACE_COL,\n        AGE\n      ];\n    },\n  },\n\n  methods: {\n    close() {\n      this.$emit('close');\n    },\n\n    onFileSelected(value) {\n      const component = this.$refs.yamleditor;\n\n      if (component) {\n        this.errors = null;\n        component.updateValue(value);\n      }\n    },\n\n    async importYaml(btnCb) {\n      try {\n        this.errors = [];\n\n        const res = await this.currentCluster.doAction('apply', {\n          yaml:             this.currentYaml,\n          defaultNamespace: this.selectedNamespace,\n        });\n\n        btnCb(true);\n\n        this.rows = res;\n        this.done = true;\n      } catch (err) {\n        this.errors = exceptionToErrorsArray(err);\n        this.done = false;\n        btnCb(false);\n      }\n    },\n\n    rowClick(e) {\n      if ( e.target.tagName === 'A' ) {\n        this.close();\n      }\n    },\n\n    onReadyYamlEditor(arg) {\n      this.$emit('onReadyYamlEditor', arg);\n    }\n  },\n};\n</script>\n\n<template>\n  <Card\n    :show-highlight-border=\"false\"\n    data-testid=\"import-yaml\"\n  >\n    <template #title>\n      <div style=\"display: block; width: 100%;\">\n        <template v-if=\"done\">\n          <h4 data-testid=\"import-yaml-success\">\n            {{ t('import.success', {count: rows.length}) }}\n          </h4>\n        </template>\n        <template v-else>\n          <h4 v-t=\"'import.title'\" />\n          <div class=\"row\">\n            <div class=\"col span-6\">\n              <FileSelector\n                role=\"button\"\n                :aria-label=\"t('generic.readFromFileArea', { area: t('import.title') })\"\n                class=\"btn role-secondary pull-left\"\n                :label=\"t('generic.readFromFile')\"\n                @selected=\"onFileSelected\"\n              />\n            </div>\n            <div class=\"col span-6\">\n              <LabeledSelect\n                v-model:value=\"selectedNamespace\"\n                :options=\"namespaceOptions\"\n                label-key=\"import.defaultNamespace.label\"\n                mode=\"edit\"\n              />\n            </div>\n          </div>\n        </template>\n      </div>\n    </template>\n    <template #body>\n      <template v-if=\"done\">\n        <div class=\"results\">\n          <SortableTable\n            :rows=\"rows\"\n            :headers=\"headers\"\n            mode=\"view\"\n            key-field=\"_key\"\n            :search=\"false\"\n            :paging=\"true\"\n            :row-actions=\"false\"\n            :table-actions=\"false\"\n            :sub-rows-description=\"false\"\n            @rowClick=\"rowClick\"\n          />\n        </div>\n      </template>\n      <YamlEditor\n        v-else\n        ref=\"yamleditor\"\n        v-model:value=\"currentYaml\"\n        class=\"yaml-editor\"\n        @onReady=\"onReadyYamlEditor\"\n      />\n      <Banner\n        v-for=\"(err, i) in errors\"\n        :key=\"i\"\n        color=\"error\"\n        :label=\"err\"\n      />\n    </template>\n    <template #actions>\n      <div\n        v-if=\"done\"\n        class=\"text-center\"\n        style=\"width: 100%\"\n      >\n        <button\n          :aria-label=\"t('generic.close')\"\n          role=\"button\"\n          type=\"button\"\n          class=\"btn role-primary\"\n          data-testid=\"import-yaml-close\"\n          @click=\"close\"\n        >\n          {{ t('generic.close') }}\n        </button>\n      </div>\n      <div\n        v-else\n        class=\"text-center\"\n        style=\"width: 100%\"\n      >\n        <button\n          :aria-label=\"t('generic.cancel')\"\n          role=\"button\"\n          type=\"button\"\n          class=\"btn role-secondary mr-10\"\n          data-testid=\"import-yaml-cancel\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n        <AsyncButton\n          v-if=\"!done\"\n          mode=\"import\"\n          :disabled=\"!currentYaml.length\"\n          data-testid=\"import-yaml-import-action\"\n          :aria-label=\"t('import.title')\"\n          @click=\"importYaml\"\n        />\n      </div>\n    </template>\n  </Card>\n</template>\n\n<style lang='scss' scoped>\n  $min: 50vh;\n  $max: 50vh;\n\n  .yaml-editor {\n    flex: 1;\n    min-height: $min;\n    max-height: $max;\n\n    :deep() .code-mirror {\n      .CodeMirror {\n        position: initial;\n      }\n\n      .CodeMirror,\n      .CodeMirror-scroll,\n      .CodeMirror-gutters {\n        min-height: $min;\n        max-height: $max;\n      }\n    }\n  }\n</style>\n","import { render } from \"./ImportDialog.vue?vue&type=template&id=ca2b0dd2&scoped=true\"\nimport script from \"./ImportDialog.vue?vue&type=script&lang=js\"\nexport * from \"./ImportDialog.vue?vue&type=script&lang=js\"\n\nimport \"./ImportDialog.vue?vue&type=style&index=0&id=ca2b0dd2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ca2b0dd2\"]])\n\nexport default __exports__"],"names":["___CSS_LOADER_EXPORT___","i","push","module","id","content","__esModule","default","locals","exports","add","style","class","title","t","count","rows","length","role","area","label","onFileSelected","value","selectedNamespace","options","namespaceOptions","mode","body","headers","search","paging","rowClick","ref","currentYaml","onReadyYamlEditor","errors","err","key","color","actions","type","close","done","disabled","importYaml","emits","components","AsyncButton","Banner","Card","YamlEditor","FileSelector","LabeledSelect","SortableTable","props","defaultNamespace","String","undefined","fetch","this","allNamespaces","$store","dispatch","opt","url","hasAccessToDefaultNamespace","some","ns","name","data","computed","out","map","obj","sort","methods","$emit","component","$refs","yamleditor","updateValue","btnCb","res","currentCluster","doAction","yaml","e","target","tagName","arg","__exports__","render"],"ignoreList":[],"sourceRoot":""}