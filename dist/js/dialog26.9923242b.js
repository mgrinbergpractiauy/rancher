(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[8031],{27388:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>r});var l=a(31601),s=a.n(l),n=a(76314),i=a.n(n),o=a(5111),c=i()(s());c.i(o.A),c.push([t.id,".plugin-install-dialog[data-v-13297eca]{padding:10px}.plugin-install-dialog h4[data-v-13297eca]{font-weight:700}.plugin-install-dialog .dialog-panel[data-v-13297eca]{display:flex;flex-direction:column;min-height:100px}.plugin-install-dialog .dialog-panel .dialog-info[data-v-13297eca]{flex:1}.plugin-install-dialog .dialog-buttons[data-v-13297eca]{display:flex;justify-content:flex-end;margin-top:10px}.plugin-install-dialog .dialog-buttons[data-v-13297eca]>:not(:last-child){margin-right:10px}",""]);const r=c},34553:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>A});var l=a(20641),s=a(90033);const n={class:"plugin-install-dialog"},i={class:"mt-10"},o={class:"mt-10 dialog-panel"},c={class:"dialog-info"},r={class:"dialog-buttons"},d=["disabled"];function g(t,e,a,g,u,p){const h=(0,l.g2)("AsyncButton");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.Lk)("h4",i,(0,s.v_)(t.t("plugins.uninstall.title",{name:a.catalog.name})),1),e[4]||(e[4]=(0,l.eW)()),(0,l.Lk)("div",o,[(0,l.Lk)("div",c,[(0,l.Lk)("p",null,(0,s.v_)(t.t("plugins.uninstall.catalog")),1)]),e[3]||(e[3]=(0,l.eW)()),(0,l.Lk)("div",r,[(0,l.Lk)("button",{disabled:u.busy,class:"btn role-secondary","data-testid":"uninstall-ext-modal-cancel-btn",onClick:e[0]||(e[0]=t=>p.closeDialog(!1))},(0,s.v_)(t.t("generic.cancel")),9,d),e[2]||(e[2]=(0,l.eW)()),(0,l.bF)(h,{mode:"uninstall","data-testid":"uninstall-ext-modal-uninstall-btn",onClick:e[1]||(e[1]=t=>p.uninstall())})])])])}var u=a(66278),p=a(55823),h=a(62428),m=a(47170),f=a(72268);const y={emits:["close"],components:{AsyncButton:f.A},props:{catalog:{type:Object,default:()=>{},required:!0},refresh:{type:Function,default:()=>{},required:!0},closed:{type:Function,default:()=>{},required:!0},resources:{type:Array,default:()=>[]},registerBackgroundClosing:{type:Function,default:()=>{}}},async fetch(){if(this.$store.getters["management/schemaFor"](p.hX)){const t=this.$store.dispatch("management/findAll",{type:p.hX});this.plugins=t||[]}},data(){return{busy:!1,plugins:null}},computed:{...(0,u.L8)({allCharts:"catalog/charts"}),pluginsFromCatalogImage(){return this.plugins.filter(t=>t.metadata?.labels?.[h.v4.CATALOG_IMAGE])}},methods:{closeDialog(t){this.closed(t),t&&this.refresh(),this.$emit("close")},async uninstall(){this.busy=!0;const t=this.catalog,e=await this.$store.dispatch("management/findAll",{type:p.W8.APP}),a=e.filter(e=>{if(e.namespace===h.th){const a=this.allCharts.filter(e=>e.repoName===t.repo?.metadata?.name);return a.some(t=>t.chartName===e.metadata.name)}return!1});if(await this.removeCatalogResources(t),a.length){try{a.forEach(t=>{t.remove()})}catch(l){this.$store.dispatch("growl/error",{title:this.t("plugins.error.generic"),message:l.message?l.message:l,timeout:1e4},{root:!0})}await this.$store.dispatch("management/findAll",{type:p.W8.OPERATION})}this.closeDialog(t)},async removeCatalogResources(t){if(t.name){const e=h.th,a={matchLabels:{[h.v4.CATALOG_IMAGE]:t.name}},l=await(0,m.kR)({deployment:this.$store.dispatch("management/findLabelSelector",{type:p.oU.DEPLOYMENT,matching:{namespace:e,labelSelector:a},opt:{transient:!0}}),service:this.$store.dispatch("management/findLabelSelector",{type:p.YV,matching:{namespace:e,labelSelector:a},opt:{transient:!0}}),repo:this.$store.dispatch("management/findLabelSelector",{type:p.W8.CLUSTER_REPO,matching:{labelSelector:a},opt:{transient:!0}})});for(const t of Object.keys(l))l[t]&&l[t].data.forEach(t=>t.remove())}}}};a(37602);var v=a(66262);const b=(0,v.A)(y,[["render",g],["__scopeId","data-v-13297eca"]]),A=b},37602:(t,e,a)=>{var l=a(27388);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[t.id,l,""]]),l.locals&&(t.exports=l.locals);var s=a(99548).A;s("33f69c78",l,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=dialog26.9923242b.js.map