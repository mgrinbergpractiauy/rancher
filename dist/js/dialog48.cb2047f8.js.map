{"version":3,"file":"js/dialog48.cb2047f8.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/RedeployWorkloadDialog.vue?3989","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/RedeployWorkloadDialog.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/RedeployWorkloadDialog.vue?ca2b","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/RedeployWorkloadDialog.vue?d690","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/RedeployWorkloadDialog.vue?134e"],"sourcesContent":["import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createTextVNode as _createTextVNode, createVNode as _createVNode, withCtx as _withCtx } from \"vue\"\n\nconst _hoisted_1 = { class: \"text-default-text\" }\nconst _hoisted_2 = { class: \"mb-10\" }\nconst _hoisted_3 = [\"aria-label\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Banner = _resolveComponent(\"Banner\")!\n  const _component_AsyncButton = _resolveComponent(\"AsyncButton\")!\n  const _component_Card = _resolveComponent(\"Card\")!\n  const _directive_clean_html = _resolveDirective(\"clean-html\")!\n\n  return (_openBlock(), _createBlock(_component_Card, {\n    role: \"alertdialog\",\n    \"aria-modal\": \"true\",\n    class: \"prompt-redeploy\",\n    \"show-highlight-border\": false\n  }, {\n    title: _withCtx(() => [\n      _createElementVNode(\"h4\", _hoisted_1, _toDisplayString(_ctx.t('promptRedeploy.title', { type: $options.type })), 1)\n    ]),\n    body: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _withDirectives(_createElementVNode(\"span\", null, null, 512), [\n          [_directive_clean_html, _ctx.t('promptRedeploy.attemptingToRedeploy', {\n            type: $options.type,\n            names: $options.resourceNames($options.names, null, _ctx.t),\n          })]\n        ]),\n        _cache[1] || (_cache[1] = _createTextVNode()),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.errors, (error, i) => {\n          return (_openBlock(), _createBlock(_component_Banner, {\n            key: i,\n            role: \"alert\",\n            color: \"error\",\n            label: error\n          }, null, 8, [\"label\"]))\n        }), 128))\n      ])\n    ]),\n    actions: _withCtx(() => [\n      _createElementVNode(\"button\", {\n        role: \"button\",\n        class: \"btn role-secondary\",\n        \"aria-label\": _ctx.t('generic.cancel'),\n        onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => ($options.close && $options.close(...args)))\n      }, _toDisplayString(_ctx.t('generic.cancel')), 9, _hoisted_3),\n      _cache[2] || (_cache[2] = _createTextVNode()),\n      _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"spacer\" }, null, -1)),\n      _cache[4] || (_cache[4] = _createTextVNode()),\n      _createVNode(_component_AsyncButton, {\n        role: \"button\",\n        class: \"btn bg-error ml-10\",\n        \"action-label\": _ctx.t('asyncButton.redeploy.action'),\n        onClick: $options.apply\n      }, null, 8, [\"action-label\", \"onClick\"])\n    ]),\n    _: 1,\n    __: [5,6]\n  }))\n}","<script lang=\"ts\">\nimport { TIMESTAMP } from '@shell/config/labels-annotations';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { Card } from '@components/Card';\nimport { Banner } from '@components/Banner';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\nimport { resourceNames } from '@shell/utils/string';\nimport { mapGetters } from 'vuex';\n\ninterface Workload {\n  nameDisplay: string;\n  type: string;\n  schema?: any;\n  spec: {\n    template: {\n      metadata?: {\n        annotations?: Record<string, string>;\n      };\n    };\n  };\n  save: () => Promise<void>;\n}\n\nexport default {\n  name: 'RedeployWorkloadDialog',\n\n  emits: ['close'],\n\n  components: {\n    Card,\n    AsyncButton,\n    Banner,\n  },\n\n  props: {\n    workloads: {\n      type:     Array as () => Workload[],\n      required: true,\n    },\n  },\n\n  data() {\n    return { errors: [] };\n  },\n\n  computed: {\n    ...mapGetters({ t: 'i18n/t', labelFor: 'type-map/labelFor' }),\n\n    names(): string[] {\n      return this.workloads.map(({ nameDisplay }) => nameDisplay);\n    },\n\n    type(): string {\n      const types = new Set(this.workloads.map(({ type }) => type));\n\n      if (types.size > 1) {\n        return this.t('generic.resource', { count: this.workloads.length });\n      }\n\n      const [{ schema } = {}] = this.workloads;\n\n      if (!schema) {\n        return `resource${ this.workloads.length === 1 ? '' : 's' }`;\n      }\n\n      return this.labelFor(schema, this.workloads.length);\n    },\n  },\n\n  methods: {\n    resourceNames,\n\n    close(): void {\n      this.$emit('close');\n    },\n\n    async apply(buttonDone?: (success: boolean) => void): Promise<void> {\n      try {\n        const now = new Date().toISOString().replace(/\\.\\d+Z$/, 'Z');\n\n        for (const workload of this.workloads) {\n          const metadata = workload.spec.template.metadata ??= {};\n          const annotations = metadata.annotations ??= {};\n\n          annotations[TIMESTAMP] = now;\n\n          await workload.save();\n        }\n\n        buttonDone?.(true);\n        this.close();\n      } catch (err) {\n        this.errors = exceptionToErrorsArray(err);\n        buttonDone?.(false);\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <Card\n    role=\"alertdialog\"\n    aria-modal=\"true\"\n    class=\"prompt-redeploy\"\n    :show-highlight-border=\"false\"\n  >\n    <template #title>\n      <h4 class=\"text-default-text\">\n        {{ t('promptRedeploy.title', { type }) }}\n      </h4>\n    </template>\n\n    <template #body>\n      <div class=\"mb-10\">\n        <span\n          v-clean-html=\"t('promptRedeploy.attemptingToRedeploy', {\n            type,\n            names: resourceNames(names, null, t),\n          })\"\n        />\n        <Banner\n          v-for=\"(error, i) in errors\"\n          :key=\"i\"\n          role=\"alert\"\n          color=\"error\"\n          :label=\"error\"\n        />\n      </div>\n    </template>\n\n    <template #actions>\n      <button\n        role=\"button\"\n        class=\"btn role-secondary\"\n        :aria-label=\"t('generic.cancel')\"\n        @click=\"close\"\n      >\n        {{ t('generic.cancel') }}\n      </button>\n      <div class=\"spacer\" />\n      <AsyncButton\n        role=\"button\"\n        class=\"btn bg-error ml-10\"\n        :action-label=\"t('asyncButton.redeploy.action')\"\n        @click=\"apply\"\n      />\n    </template>\n  </Card>\n</template>\n\n<style lang=\"scss\">\n.prompt-redeploy {\n  &.card-container {\n    box-shadow: none;\n  }\n\n  .card-actions {\n    .spacer {\n      flex: 1;\n    }\n  }\n}\n</style>\n","import { render } from \"./RedeployWorkloadDialog.vue?vue&type=template&id=4977aa88&ts=true\"\nimport script from \"./RedeployWorkloadDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./RedeployWorkloadDialog.vue?vue&type=script&lang=ts\"\n\nimport \"./RedeployWorkloadDialog.vue?vue&type=style&index=0&id=4977aa88&lang=scss\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.prompt-redeploy.card-container{box-shadow:none}.prompt-redeploy .card-actions .spacer{flex:1}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./RedeployWorkloadDialog.vue?vue&type=style&index=0&id=4977aa88&lang=scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5c523967\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","render","_ctx","_cache","$props","$setup","$data","$options","_component_Banner","_component_AsyncButton","_component_Card","_directive_clean_html","role","title","t","type","body","names","errors","error","i","key","color","label","actions","args","close","apply","_","__","name","emits","components","Card","AsyncButton","Banner","props","workloads","Array","required","data","computed","labelFor","this","map","nameDisplay","types","Set","size","count","length","schema","methods","resourceNames","$emit","buttonDone","now","Date","toISOString","replace","workload","metadata","spec","template","annotations","save","err","__exports__","___CSS_LOADER_EXPORT___","push","module","id","content","__esModule","default","locals","exports","add"],"ignoreList":[],"sourceRoot":""}