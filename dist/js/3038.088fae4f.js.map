{"version":3,"file":"js/3038.088fae4f.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ChartHeading.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ChartHeading.vue?a183","webpack://cluster-log-extension/./node_modules/@rancher/shell/pages/c/_cluster/gatekeeper/index.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/pages/c/_cluster/gatekeeper/index.vue?b3db","webpack://cluster-log-extension/./node_modules/@rancher/shell/mixins/chart.js"],"sourcesContent":["<script>\nexport default {\n  props: {\n    label: {\n      type:     String,\n      required: true\n    },\n    url: {\n      type:     String,\n      required: true\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"chart-heading\">\n    <h1>{{ t('chartHeading.overview') }}</h1>\n    {{ t('chartHeading.poweredBy') }} <a\n      :href=\"url\"\n      rel=\"nofollow noopener noreferrer\"\n      target=\"_blank\"\n    >{{ label }}</a>\n  </div>\n</template>\n","import { render } from \"./ChartHeading.vue?vue&type=template&id=00701329\"\nimport script from \"./ChartHeading.vue?vue&type=script&lang=js\"\nexport * from \"./ChartHeading.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script>\nimport ChartHeading from '@shell/components/ChartHeading';\nimport SortableTable from '@shell/components/SortableTable';\nimport { Banner } from '@components/Banner';\nimport { CONSTRAINT_VIOLATION_CONSTRAINT_LINK, CONSTRAINT_VIOLATION_COUNT, CONSTRAINT_VIOLATION_TEMPLATE_LINK } from '@shell/config/table-headers';\nimport { GATEKEEPER } from '@shell/config/types';\nimport Loading from '@shell/components/Loading';\n\nexport const OPA_GATE_KEEPER_ID = 'cluster/rancher-charts/rancher-gatekeeper';\n\nexport default {\n  components: {\n    ChartHeading, SortableTable, Banner, Loading\n  },\n  async fetch() {\n    const constraints = this.constraint ? [this.constraint] : await this.$store.dispatch('cluster/findAll', { type: GATEKEEPER.SPOOFED.CONSTRAINT });\n\n    this.violations = constraints\n      .map((constraint, i) => ({\n        id:             i,\n        constraintLink: {\n          text: constraint.nameDisplay,\n          to:   constraint.detailLocation\n        },\n        templateLink: {\n          text: constraint.kind,\n          to:   {\n            name:   'c-cluster-product-resource-id',\n            params: {\n              resource: 'templates.gatekeeper.sh.constrainttemplate', id: constraint.kind.toLowerCase(), product: 'gatekeeper'\n            }\n          }\n        },\n        count: constraint.totalViolations\n      }));\n  },\n  data(ctx) {\n    return {\n      headers: [\n        CONSTRAINT_VIOLATION_CONSTRAINT_LINK,\n        CONSTRAINT_VIOLATION_TEMPLATE_LINK,\n        CONSTRAINT_VIOLATION_COUNT\n      ],\n      violations: []\n    };\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <ChartHeading\n      :label=\"t('gatekeeperIndex.poweredBy')\"\n      url=\"https://github.com/open-policy-agent/gatekeeper\"\n    />\n    <Banner color=\"warning\">\n      <span v-clean-html=\"t('gatekeeperIndex.deprecated', {}, true)\" />\n    </Banner>\n    <div class=\"spacer\" />\n    <div class=\"mb-10\">\n      <h2><t k=\"gatekeeperIndex.violations\" /></h2>\n    </div>\n    <div>\n      <SortableTable\n        :headers=\"headers\"\n        :rows=\"violations\"\n        :search=\"false\"\n        :table-actions=\"false\"\n        :row-actions=\"false\"\n        :paging=\"true\"\n        :rows-per-page=\"10\"\n        key-field=\"id\"\n        group-by=\"templateLink.text\"\n      />\n    </div>\n  </div>\n</template>\n","import { render } from \"./index.vue?vue&type=template&id=3df8c710\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\nimport { mapGetters } from 'vuex';\nimport {\n  REPO_TYPE, REPO, CHART, VERSION, NAMESPACE, NAME, DESCRIPTION as DESCRIPTION_QUERY, DEPRECATED as DEPRECATED_QUERY, HIDDEN, _FLAGGED, _CREATE, _EDIT\n} from '@shell/config/query-params';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { SHOW_PRE_RELEASE, mapPref } from '@shell/store/prefs';\nimport { NAME as EXPLORER } from '@shell/config/product/explorer';\nimport { NAME as MANAGER } from '@shell/config/product/manager';\nimport { OPA_GATE_KEEPER_ID } from '@shell/pages/c/_cluster/gatekeeper/index.vue';\nimport { formatSi, parseSi } from '@shell/utils/units';\nimport { CAPI, CATALOG } from '@shell/config/types';\nimport { isPrerelease, compare } from '@shell/utils/version';\nimport difference from 'lodash/difference';\nimport { LINUX, APP_UPGRADE_STATUS } from '@shell/store/catalog';\nimport { clone } from '@shell/utils/object';\nimport { merge } from 'lodash';\n\nexport default {\n  data() {\n    return {\n      version:          null,\n      versionInfo:      null,\n      versionInfoError: null,\n      existing:         null,\n\n      ignoreWarning: false,\n\n      chart: null,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster', 'isRancher']),\n\n    showPreRelease: mapPref(SHOW_PRE_RELEASE),\n\n    repo() {\n      return this.$store.getters['catalog/repo']({\n        repoType: this.query.repoType,\n        repoName: this.query.repoName,\n      });\n    },\n\n    showReadme() {\n      return !!this.versionInfo?.readme;\n    },\n\n    hasReadme() {\n      return !!this.versionInfo?.appReadme || !!this.versionInfo?.readme;\n    },\n\n    mappedVersions() {\n      const versions = this.chart?.versions || [];\n      const selectedVersion = this.targetVersion;\n      const OSs = this.currentCluster?.workerOSs;\n      const out = [];\n\n      versions.forEach((version) => {\n        const nue = {\n          label:           version.version,\n          version:         version.version,\n          originalVersion: version.version,\n          id:              version.version,\n          created:         version.created,\n          disabled:        false,\n          keywords:        version.keywords\n        };\n\n        const permittedSystems = (version?.annotations?.[CATALOG_ANNOTATIONS.PERMITTED_OS] || LINUX).split(',');\n\n        if (permittedSystems.length > 0 && difference(OSs, permittedSystems).length > 0) {\n          nue.disabled = true;\n        }\n        // if only one OS is allowed, show '<OS>-only' on hover\n        if (permittedSystems.length === 1) {\n          nue.label = this.t(`catalog.install.versions.${ permittedSystems[0] }`, { ver: version.version });\n        }\n\n        if (!this.showPreRelease && isPrerelease(version.version)) {\n          return;\n        }\n\n        out.push(nue);\n      });\n\n      const selectedMatch = out.find((v) => v.id === selectedVersion);\n\n      if (!selectedMatch) {\n        out.unshift({\n          label:           selectedVersion,\n          originalVersion: selectedVersion,\n          id:              selectedVersion,\n          created:         null,\n          disabled:        false,\n          keywords:        []\n        });\n      }\n\n      const currentVersion = out.find((v) => v.originalVersion === this.currentVersion);\n\n      if (currentVersion) {\n        currentVersion.label = this.t('catalog.install.versions.current', { ver: this.currentVersion });\n      }\n\n      return out;\n    },\n\n    // Conditionally filter out prerelease versions of the chart.\n    filteredVersions() {\n      return this.showPreRelease ? this.mappedVersions : this.mappedVersions.filter((v) => !v.isPre);\n    },\n\n    query() {\n      const query = this.$route.query;\n\n      return {\n        repoType:     query[REPO_TYPE],\n        repoName:     query[REPO],\n        chartName:    query[CHART],\n        versionName:  query[VERSION],\n        appNamespace: query[NAMESPACE] || '',\n        appName:      query[NAME] || '',\n        description:  query[DESCRIPTION_QUERY],\n        hidden:       query[HIDDEN],\n        deprecated:   query[DEPRECATED_QUERY]\n      };\n    },\n\n    showDeprecated() {\n      return this.query.deprecated === 'true' || this.query.deprecated === _FLAGGED;\n    },\n\n    showHidden() {\n      return this.query.hidden === _FLAGGED;\n    },\n\n    // If the user is installing the app for the first time,\n    // warn them about CPU and memory requirements.\n    warnings() {\n      const warnings = [];\n\n      if ( this.existing ) {\n        // Ignore the limits on upgrade (or if asked by query) and don't show any warnings\n      } else {\n        // The UI will show warnings about CPU and memory if\n        // these annotations are added to Helm chart:\n        // - catalog.cattle.io/requests-cpu\n        // - catalog.cattle.io/requests-memory\n        const needCpu = parseSi(this.version?.annotations?.[CATALOG_ANNOTATIONS.REQUESTS_CPU] || '0');\n        const needMemory = parseSi(this.version?.annotations?.[CATALOG_ANNOTATIONS.REQUESTS_MEMORY] || '0');\n\n        // Note: These are null if unknown\n        const availableCpu = this.currentCluster?.availableCpu;\n        const availableMemory = this.currentCluster?.availableMemory;\n\n        if ( availableCpu !== null && availableCpu < needCpu ) {\n          warnings.push(this.t('catalog.install.error.insufficientCpu', {\n            need: Math.round(needCpu * 100) / 100,\n            have: Math.round(availableCpu * 100) / 100,\n          }));\n        }\n\n        if ( availableMemory !== null && availableMemory < needMemory ) {\n          warnings.push(this.t('catalog.install.error.insufficientMemory', {\n            need: formatSi(needMemory, {\n              increment: 1024, suffix: 'iB', firstSuffix: 'B'\n            }),\n            have: formatSi(availableMemory, {\n              increment: 1024, suffix: 'iB', firstSuffix: 'B'\n            }),\n          }));\n        }\n      }\n\n      if (this.chart?.id === OPA_GATE_KEEPER_ID) {\n        warnings.unshift(this.t('gatekeeperIndex.deprecated', {}, true));\n      }\n\n      if (this.existing && this.existing.upgradeAvailable === APP_UPGRADE_STATUS.NOT_APPLICABLE) {\n        const manager = this.existing?.spec?.chart?.metadata?.annotations?.[CATALOG_ANNOTATIONS.MANAGED] || 'Rancher';\n\n        warnings.unshift(this.t('catalog.install.warning.managed', {\n          name:    this.existing.name,\n          version: this.chart ? this.query.versionName : null,\n          manager: manager === 'true' ? 'Rancher' : manager\n        }, true));\n      }\n\n      return warnings;\n    },\n\n    requires() {\n      const requires = [];\n\n      const required = (this.version?.annotations?.[CATALOG_ANNOTATIONS.REQUIRES_GVK] || '').split(/\\s*,\\s*/).filter((x) => !!x).reverse();\n\n      if ( required.length ) {\n        for ( const gvr of required ) {\n          if ( this.$store.getters['catalog/isInstalled']({ gvr }) ) {\n            continue;\n          }\n\n          const provider = this.provider(gvr);\n\n          if ( provider ) {\n            const url = this.$router.resolve(this.chartLocation(true, provider)).href;\n\n            requires.push(this.t('catalog.install.error.requiresFound', {\n              url,\n              name: provider.name\n            }, true));\n          } else {\n            requires.push(this.t('catalog.install.error.requiresMissing', { name: gvr }));\n          }\n        }\n      }\n\n      return requires;\n    },\n\n    currentVersion() {\n      return this.existing?.spec.chart.metadata.version;\n    },\n\n    targetVersion() {\n      return this.version ? this.version.version : this.query.versionName;\n    },\n\n    action() {\n      if (!this.existing) {\n        return {\n          name: 'install', tKey: 'install', icon: 'icon-plus'\n        };\n      }\n\n      if (this.currentVersion === this.targetVersion) {\n        return {\n          name: 'editVersion', tKey: 'edit', icon: 'icon-edit'\n        };\n      }\n\n      if (compare(this.currentVersion, this.targetVersion) < 0) {\n        return {\n          name: 'upgrade', tKey: 'upgrade', icon: 'icon-upgrade-alt'\n        };\n      }\n\n      return {\n        name: 'downgrade', tKey: 'downgrade', icon: 'icon-downgrade-alt'\n      };\n    },\n\n    isChartTargeted() {\n      return this.chart?.targetNamespace && this.chart?.targetName;\n    },\n\n    hasQuestions() {\n      return this.versionInfo && !!this.versionInfo.questions;\n    },\n  },\n\n  methods: {\n    /**\n     * Populate `this.chart`\n     *\n     * `chart` used to be a computed property pointing at getter catalog/chart\n     *\n     * this however stopped recalculating given changes to the store\n     *\n     * (the store would populate a charts collection, which the getter uses to find the chart,\n     * however this did not kick off the computed property, so this.charts was not populated)\n     *\n     * Now we find and cache the chart\n     */\n    fetchStoreChart() {\n      if (!this.chart && this.repo && this.query.chartName) {\n        this.chart = this.$store.getters['catalog/chart']({\n          repoType:       this.query.repoType,\n          repoName:       this.query.repoName,\n          chartName:      this.query.chartName,\n          includeHidden:  true,\n          showDeprecated: this.showDeprecated\n        });\n      }\n\n      return this.chart;\n    },\n\n    async fetchChart() {\n      this.versionInfoError = null;\n\n      await Promise.all([\n        this.$store.dispatch('catalog/load'),\n        this.$store.dispatch('cluster/findAll', { type: CATALOG.APP })\n      ]);\n\n      this.fetchStoreChart();\n\n      if ( this.query.appNamespace && this.query.appName ) {\n        // First check the URL query for an app name and namespace.\n        // Use those values to check for a catalog app resource.\n        // If found, set the form to edit mode. If not, set the\n        // form to create mode.\n\n        try {\n          this.existing = await this.$store.dispatch('cluster/find', {\n            type: CATALOG.APP,\n            id:   `${ this.query.appNamespace }/${ this.query.appName }`,\n          });\n\n          await this.existing?.fetchValues(true);\n\n          this.mode = _EDIT;\n        } catch (e) {\n          this.mode = _CREATE;\n          this.existing = null;\n        }\n      } else if ( this.chart?.targetNamespace && this.chart?.targetName ) {\n        // If the app name and namespace values are not provided in the\n        // query, fall back on target values defined in the Helm chart itself.\n\n        // Ask to install a special chart with fixed namespace/name\n        // or edit it if there's an existing install.\n\n        try {\n          this.existing = await this.$store.dispatch('cluster/find', {\n            type: CATALOG.APP,\n            id:   `${ this.chart.targetNamespace }/${ this.chart.targetName }`,\n          });\n          this.mode = _EDIT;\n        } catch (e) {\n          this.mode = _CREATE;\n          this.existing = null;\n        }\n      } else if (this.chart) {\n        const matching = this.chart.matchingInstalledApps;\n\n        if (matching.length === 1) {\n          this.existing = matching[0];\n          this.mode = _EDIT;\n        } else {\n          this.mode = _CREATE;\n        }\n      } else {\n        // Regular create\n\n        this.mode = _CREATE;\n      }\n\n      if ( !this.chart ) {\n        return;\n      }\n\n      // If no version is given in the URL query,\n      // use the first version provided by the Helm chart\n      // as the default.\n      if ( !this.query.versionName && this.chart.versions?.length ) {\n        if (this.showPreRelease) {\n          this.query.versionName = this.chart.versions[0].version;\n        } else {\n          const firstRelease = this.chart.versions.find((v) => !isPrerelease(v.version));\n\n          this.query.versionName = firstRelease?.version || this.chart.versions[0].version;\n        }\n      }\n\n      if ( !this.query.versionName ) {\n        return;\n      }\n\n      try {\n        this.version = this.$store.getters['catalog/version']({\n          repoType:       this.query.repoType,\n          repoName:       this.query.repoName,\n          chartName:      this.query.chartName,\n          versionName:    this.query.versionName,\n          showDeprecated: this.showDeprecated\n        });\n      } catch (e) {\n        console.error('Unable to fetch Version: ', e); // eslint-disable-line no-console\n      }\n      if (!this.version) {\n        console.warn('No version found: ', this.query.repoType, this.query.repoName, this.query.chartName, this.query.versionName);// eslint-disable-line no-console\n      }\n\n      try {\n        this.versionInfo = await this.$store.dispatch('catalog/getVersionInfo', {\n          repoType:    this.query.repoType,\n          repoName:    this.query.repoName,\n          chartName:   this.query.chartName,\n          versionName: this.query.versionName\n        });\n        // Here we set us versionInfo. The returned\n        // object contains everything all info\n        // about a currently installed app, and it has the\n        // following keys:\n        //\n        // - appReadme: A short overview of what the app does. This\n        //   forms the first few paragraphs of the chart info when\n        //   you install a Helm chart app through Rancher.\n        // - chart: Metadata about the Helm chart, including the\n        //   name and version.\n        // - readme: This is more detailed information that appears\n        //   under the heading \"Chart Information (Helm README)\" when\n        //   you install or upgrade a Helm chart app through Rancher,\n        //   below the app README.\n        // - values: All Helm chart values for the currently installed\n        //   app.\n      } catch (e) {\n        this.versionInfoError = e;\n\n        console.error('Unable to fetch VersionInfo: ', e); // eslint-disable-line no-console\n      }\n    }, // End of fetchChart\n\n    // Charts have an annotation that specifies any additional charts that should be installed at the same time eg CRDs\n    async fetchAutoInstallInfo() {\n      const out = [];\n      /*\n        An example value for auto is [\"rancher-monitoring-crd=match\"].\n        It is an array of chart names that lets Rancher know of other\n        charts that should be auto-installed at the same time.\n      */\n      const auto = (this.version?.annotations?.[CATALOG_ANNOTATIONS.AUTO_INSTALL] || '').split(/\\s*,\\s*/).filter((x) => !!x).reverse();\n\n      for ( const constraint of auto ) {\n        const provider = this.$store.getters['catalog/versionSatisfying']({\n          constraint,\n          repoName:     this.chart.repoName,\n          repoType:     this.chart.repoType,\n          chartVersion: this.version.version,\n        });\n        /* An example return value for \"provider\":\n          [\n              {\n                  \"name\": \"rancher-monitoring-crd\",\n                  \"version\": \"100.1.3+up19.0.3\",\n                  \"description\": \"Installs the CRDs for rancher-monitoring.\",\n                  \"apiVersion\": \"v1\",\n                  \"annotations\": {\n                      \"catalog.cattle.io/certified\": \"rancher\",\n                      \"catalog.cattle.io/hidden\": \"true\",\n                      \"catalog.cattle.io/namespace\": \"cattle-monitoring-system\",\n                      \"catalog.cattle.io/release-name\": \"rancher-monitoring-crd\"\n                  },\n                  \"type\": \"application\",\n                  \"urls\": [\n                      \"https://192.168.0.18:8005/k8s/clusters/c-m-hhpg69fv/v1/catalog.cattle.io.clusterrepos/rancher-charts?chartName=rancher-monitoring-crd&link=chart&version=100.1.3%2Bup19.0.3\"\n                  ],\n                  \"created\": \"2022-04-27T10:04:18.343124-07:00\",\n                  \"digest\": \"ecf07ba23a9cdaa7ffbbb14345d94ea1240b7f3b8e0ce9be4640e3e585c484e2\",\n                  \"key\": \"cluster/rancher-charts/rancher-monitoring-crd/100.1.3+up19.0.3\",\n                  \"repoType\": \"cluster\",\n                  \"repoName\": \"rancher-charts\"\n              }\n          ]\n          */\n\n        if ( provider ) {\n          try {\n            const crdVersionInfo = await this.$store.dispatch('catalog/getVersionInfo', {\n              repoType:    provider.repoType,\n              repoName:    provider.repoName,\n              chartName:   provider.name,\n              versionName: provider.version\n            });\n            let existingCRDApp;\n\n            // search for an existing crd app to track any non-default values used on the previous install/upgrade\n            if (this.mode === _EDIT) {\n              const targetNamespace = crdVersionInfo?.chart?.annotations?.[CATALOG_ANNOTATIONS.NAMESPACE];\n              const targetName = crdVersionInfo?.chart?.annotations?.[CATALOG_ANNOTATIONS.RELEASE_NAME];\n\n              if (targetName && targetNamespace) {\n                existingCRDApp = await this.$store.dispatch('cluster/find', {\n                  type: CATALOG.APP,\n                  id:   `${ targetNamespace }/${ targetName }`,\n                });\n              }\n            }\n            if (existingCRDApp) {\n              await existingCRDApp.fetchValues(true);\n\n              // spec.values are any non-default values the user configured\n              // the installation form should show these, as well as any default values from the chart\n              const existingValues = clone(existingCRDApp.values || {});\n              const defaultValues = clone(existingCRDApp.chartValues || {});\n\n              crdVersionInfo.existingValues = existingValues;\n              crdVersionInfo.allValues = merge(defaultValues, existingValues);\n            } else {\n              // allValues will potentially be updated in the UI - we want to track this separately from values to avoid mutating the chart object in the store\n              // this is similar to userValues for the main chart\n              crdVersionInfo.allValues = clone(crdVersionInfo.values);\n            }\n\n            out.push(crdVersionInfo);\n          } catch (e) {\n            console.error('Unable to fetch VersionInfo: ', e); // eslint-disable-line no-console\n          }\n        } else {\n          this.errors.push(`This chart requires ${ constraint } but no matching chart was found`);\n        }\n      }\n\n      this['autoInstallInfo'] = out;\n    },\n\n    selectVersion({ id: version }) {\n      this.$router.applyQuery({ [VERSION]: version });\n    },\n\n    provider(gvr) {\n      return this.$store.getters['catalog/versionProviding']({\n        gvr,\n        repoName: this.chart.repoName,\n        repoType: this.chart.repoType\n      });\n    },\n\n    /**\n     * Location of chart install or details page for either the current chart or from gvr\n     */\n    chartLocation(install = false, prov) {\n      const provider = prov || {\n        repoType: this.chart.repoType,\n        repoName: this.chart.repoName,\n        name:     this.chart.chartName,\n        version:  this.query.versionName,\n      };\n\n      const query = {\n        [REPO_TYPE]: provider.repoType,\n        [REPO]:      provider.repoName,\n        [CHART]:     provider.name,\n        [VERSION]:   provider.version,\n      };\n\n      if (this.showDeprecated) {\n        query[DEPRECATED_QUERY] = this.query.deprecated;\n      }\n\n      return {\n        name:   install ? 'c-cluster-apps-charts-install' : 'c-cluster-apps-charts-chart',\n        params: {\n          cluster: this.$route.params.cluster,\n          product: this.$store.getters['productId'],\n        },\n        query\n      };\n    },\n\n    appLocation() {\n      return this.existing?.detailLocation || {\n        name:   `c-cluster-product-resource`,\n        params: {\n          product:  this.$store.getters['productId'],\n          cluster:  this.$store.getters['clusterId'],\n          resource: CATALOG.APP,\n        }\n      };\n    },\n\n    clusterToolsLocation() {\n      const query = {};\n\n      if (this.showDeprecated) {\n        query[DEPRECATED_QUERY] = this.query.deprecated;\n      }\n\n      return {\n        name:   `c-cluster-explorer-tools`,\n        params: {\n          product:  EXPLORER,\n          cluster:  this.$store.getters['clusterId'],\n          resource: CATALOG.APP,\n        },\n        query\n      };\n    },\n\n    clustersLocation() {\n      return {\n        name:   'c-cluster-product-resource',\n        params: {\n          cluster:  this.$route.params.cluster,\n          product:  MANAGER,\n          resource: CAPI.RANCHER_CLUSTER,\n        },\n      };\n    }\n  },\n\n};\n"],"names":["class","t","href","url","rel","target","label","props","type","String","required","__exports__","render","$fetchState","color","k","headers","rows","violations","search","paging","OPA_GATE_KEEPER_ID","components","ChartHeading","SortableTable","Banner","Loading","fetch","constraints","this","constraint","$store","dispatch","SPOOFED","CONSTRAINT","map","i","id","constraintLink","text","nameDisplay","to","detailLocation","templateLink","kind","name","params","resource","toLowerCase","product","count","totalViolations","data","ctx","version","versionInfo","versionInfoError","existing","ignoreWarning","chart","computed","showPreRelease","mapPref","SHOW_PRE_RELEASE","repo","getters","repoType","query","repoName","showReadme","readme","hasReadme","appReadme","mappedVersions","versions","selectedVersion","targetVersion","OSs","currentCluster","workerOSs","out","forEach","nue","originalVersion","created","disabled","keywords","permittedSystems","annotations","PERMITTED_OS","LINUX","split","length","ver","push","selectedMatch","find","v","unshift","currentVersion","filteredVersions","filter","isPre","$route","chartName","versionName","appNamespace","appName","description","hidden","deprecated","showDeprecated","showHidden","warnings","needCpu","REQUESTS_CPU","needMemory","REQUESTS_MEMORY","availableCpu","availableMemory","need","Math","round","have","increment","suffix","firstSuffix","upgradeAvailable","APP_UPGRADE_STATUS","NOT_APPLICABLE","manager","spec","metadata","MANAGED","requires","REQUIRES_GVK","x","reverse","gvr","provider","$router","resolve","chartLocation","action","tKey","icon","isChartTargeted","targetNamespace","targetName","hasQuestions","questions","methods","fetchStoreChart","includeHidden","fetchChart","Promise","all","APP","fetchValues","mode","e","matching","matchingInstalledApps","firstRelease","console","error","warn","fetchAutoInstallInfo","auto","AUTO_INSTALL","chartVersion","crdVersionInfo","existingCRDApp","NAMESPACE","RELEASE_NAME","existingValues","clone","values","defaultValues","chartValues","allValues","merge","errors","selectVersion","applyQuery","install","prov","cluster","appLocation","clusterToolsLocation","clustersLocation","RANCHER_CLUSTER"],"ignoreList":[],"sourceRoot":""}