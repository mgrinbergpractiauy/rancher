{"version":3,"file":"js/3195.d0e73a5e.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/pages/c/_cluster/_product/members/index.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ExplorerMembers.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ExplorerMembers.vue?f148","webpack://cluster-log-extension/./node_modules/@rancher/shell/pages/c/_cluster/_product/members/index.vue?d3ec","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ExplorerMembers.vue?f6e3","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/ExplorerMembers.vue?7b4a"],"sourcesContent":["<script>\nimport ExplorerMembers from '@shell/components/ExplorerMembers';\nexport default { components: { ExplorerMembers } };\n</script>\n\n<template>\n  <ExplorerMembers v-bind=\"$attrs\" />\n</template>\n","<script>\nimport { MANAGEMENT, NORMAN, VIRTUAL_TYPES } from '@shell/config/types';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Masthead from '@shell/components/ResourceList/Masthead';\nimport { AGE, ROLE, STATE, PRINCIPAL } from '@shell/config/table-headers';\nimport { canViewClusterPermissionsEditor } from '@shell/components/form/Members/ClusterPermissionsEditor.vue';\nimport Banner from '@components/Banner/Banner.vue';\nimport Tabbed from '@shell/components/Tabbed/index.vue';\nimport Tab from '@shell/components/Tabbed/Tab.vue';\nimport SortableTable from '@shell/components/SortableTable';\nimport { mapGetters } from 'vuex';\nimport { canViewProjectMembershipEditor } from '@shell/components/form/Members/ProjectMembershipEditor.vue';\nimport { allHash } from '@shell/utils/promise';\nimport { HARVESTER_NAME as HARVESTER } from '@shell/config/features';\n\n/**\n * Explorer members page.\n * Route: /c/local/explorer/members\n */\nexport default {\n  name: 'ExplorerMembers',\n\n  components: {\n    Banner,\n    Masthead,\n    ResourceTable,\n    Tabbed,\n    Tab,\n    SortableTable\n  },\n\n  props: {\n    // Cluster tole template binding create route - defaults to the explorer route\n    createLocationOverride: {\n      type:    Object,\n      default: () => {\n        return {\n          name:   'c-cluster-product-resource-create',\n          params: { resource: MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING }\n        };\n      }\n    }\n  },\n\n  async fetch() {\n    const clusterRoleTemplateBindingSchema = this.$store.getters[\n      `rancher/schemaFor`\n    ](NORMAN.CLUSTER_ROLE_TEMPLATE_BINDING);\n\n    const projectRoleTemplateBindingSchema = this.$store.getters['rancher/schemaFor'](NORMAN.PROJECT_ROLE_TEMPLATE_BINDING);\n\n    this['normanClusterRTBSchema'] = clusterRoleTemplateBindingSchema;\n    this['normanProjectRTBSchema'] = projectRoleTemplateBindingSchema;\n\n    if (clusterRoleTemplateBindingSchema) {\n      Promise.all([\n        this.$store.dispatch(`rancher/findAll`, { type: NORMAN.CLUSTER_ROLE_TEMPLATE_BINDING }, { root: true }),\n        this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING })\n      ]).then(([normanBindings]) => {\n        this['normanClusterRoleTemplateBindings'] = normanBindings;\n        this.loadingClusterBindings = false;\n      });\n    }\n\n    if (projectRoleTemplateBindingSchema) {\n      this.$store.dispatch('rancher/findAll', { type: NORMAN.PROJECT_ROLE_TEMPLATE_BINDING, opt: { force: true } }, { root: true })\n        .then((bindings) => {\n          this['projectRoleTemplateBindings'] = bindings;\n          this.loadingProjectBindings = false;\n        });\n    }\n\n    this.$store.dispatch('management/findAll', { type: MANAGEMENT.PROJECT })\n      .then((projects) => (this['projects'] = projects));\n\n    const hydration = {\n      normanPrincipals:  this.$store.dispatch('rancher/findAll', { type: NORMAN.PRINCIPAL }),\n      mgmt:              this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.USER }),\n      mgmtRoleTemplates: this.$store.dispatch(`management/findAll`, { type: MANAGEMENT.ROLE_TEMPLATE }),\n    };\n\n    await allHash(hydration);\n  },\n\n  data() {\n    return {\n      schema: this.$store.getters[`management/schemaFor`](\n        MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING\n      ),\n      headers:        [STATE, PRINCIPAL, ROLE, AGE],\n      createLocation: {\n        ...this.createLocationOverride,\n        params: {\n          ...this.createLocationOverride.params,\n          cluster: this.$store.getters['currentCluster'].id\n        }\n      },\n      resource:                          MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING,\n      normanClusterRTBSchema:            null,\n      normanProjectRTBSchema:            null,\n      normanClusterRoleTemplateBindings: [],\n      projectRoleTemplateBindings:       [],\n      projects:                          [],\n      VIRTUAL_TYPES,\n      projectRoleTemplateColumns:        [\n        STATE,\n        {\n          name:      'member',\n          labeKey:   'generic.name',\n          value:     'principalId',\n          formatter: 'Principal'\n        },\n        {\n          name:     'role',\n          labelKey: 'tableHeaders.role',\n          value:    'roleTemplate.nameDisplay'\n        },\n      ],\n      loadingProjectBindings: true,\n      loadingClusterBindings: true\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    clusterRoleTemplateBindings() {\n      return this.normanClusterRoleTemplateBindings.map((b) => b.clusterroletemplatebinding) ;\n    },\n    filteredClusterRoleTemplateBindings() {\n      return this.clusterRoleTemplateBindings.filter(\n        (b) => b?.clusterName === this.$store.getters['currentCluster'].id\n      );\n    },\n    filteredProjects() {\n      return this.projects.reduce((all, p) => {\n        if (p?.spec?.clusterName === this.currentCluster.id) {\n          all[p.id] = p;\n        }\n\n        return all;\n      }, {});\n    },\n    filteredProjectRoleTemplateBindings() {\n      const out = this.projectRoleTemplateBindings.filter((rb) => {\n        const projectId = rb.projectId.replace(':', '/');\n\n        return !!this.filteredProjects[projectId];\n      });\n\n      return out;\n    },\n    projectsWithoutRoles() {\n      const inUse = this.filteredProjectRoleTemplateBindings.reduce((projects, binding) => {\n        const thisProjectId = (binding.projectId || '').replace(':', '/');\n\n        if (!projects.includes(thisProjectId)) {\n          projects.push(thisProjectId);\n        }\n\n        return projects;\n      }, []);\n\n      return Object.keys(this.filteredProjects).reduce((all, projectId) => {\n        const project = this.filteredProjects[projectId];\n\n        if ( !inUse.includes(projectId)) {\n          all.push(project);\n        }\n\n        return all;\n      }, []);\n    },\n\n    // We're using this because we need to show projects as groups even if the project doesn't have any role bindings\n    rowsWithFakeProjects() {\n      const fakeRows = this.projectsWithoutRoles.map((project) => {\n        return {\n          groupByLabel:     `${ ('resourceTable.groupLabel.notInAProject') }-${ project.id }`,\n          isFake:           true,\n          mainRowKey:       project.id,\n          nameDisplay:      project.spec?.displayName, // Enable filtering by the project name\n          project,\n          availableActions: [],\n          projectId:        project.id\n        };\n      });\n\n      // We need to group each of the TemplateRoleBindings by the user + project\n      const userRoles = [...fakeRows, ...this.filteredProjectRoleTemplateBindings].reduce((rows, curr) => {\n        const {\n          userId, groupPrincipalId, roleTemplate, projectId\n        } = curr;\n\n        const userOrGroup = userId || groupPrincipalId;\n\n        if (!userOrGroup) {\n          return rows;\n        }\n\n        const userOrGroupKey = userOrGroup + projectId;\n\n        if (!rows[userOrGroupKey] ) {\n          rows[userOrGroupKey] = curr;\n          rows[userOrGroupKey].allRoles = [];\n        }\n\n        if (roleTemplate) {\n          rows[userOrGroupKey].allRoles.push(curr.roleTemplate);\n        }\n\n        return rows;\n      }, {});\n\n      return Object.values(userRoles);\n    },\n    canManageMembers() {\n      return canViewClusterPermissionsEditor(this.$store);\n    },\n    canManageProjectMembers() {\n      return canViewProjectMembershipEditor(this.$store);\n    },\n    isLocal() {\n      return this.$store.getters['currentCluster'].isLocal;\n    },\n    canEditProjectMembers() {\n      return this.normanProjectRTBSchema?.collectionMethods.find((x) => x.toLowerCase() === 'post');\n    },\n    canEditClusterMembers() {\n      return this.normanClusterRTBSchema?.collectionMethods.find((x) => x.toLowerCase() === 'post');\n    },\n    isHarvester() {\n      return this.$store.getters['currentProduct'].inStore === HARVESTER;\n    },\n  },\n  methods: {\n    getMgmtProjectId(group) {\n      return group.group.key.replace(':', '/');\n    },\n    getMgmtProject(group) {\n      return this.$store.getters['management/byId'](MANAGEMENT.PROJECT, this.getMgmtProjectId(group));\n    },\n    getProjectLabel(group) {\n      return this.getMgmtProject(group)?.spec?.displayName;\n    },\n    addProjectMember(group) {\n      this.$store.dispatch('cluster/promptModal', {\n        component:      'AddProjectMemberDialog',\n        componentProps: {\n          projectId:   group.group.key.replace('/', ':'),\n          saveInModal: true\n        },\n        modalSticky: true\n      });\n    },\n\n    getProjectRoleBinding(row, role) {\n      // Each row is a combination of project, role and user/group\n      // So find the specfic roleBindingTemplate corresponding to the specific project, role + user/group\n      const userOrGroupKey = row.userId ? 'userId' : 'groupPrincipalId';\n\n      return this.projectRoleTemplateBindings.find((r) => {\n        return r.projectId === row.projectId && r.roleTemplateId === role.id && r[userOrGroupKey] === row[userOrGroupKey];\n      });\n    },\n\n    async removeRole(row, role, event) {\n      const resource = this.getProjectRoleBinding(row, role);\n\n      await resource.promptRemove();\n    },\n\n    viewRoleInAPI(row, role) {\n      const resource = this.getProjectRoleBinding(row, role);\n\n      if (resource?.canViewInApi) {\n        resource.viewInApi();\n      }\n    },\n    slotName(project) {\n      return `main-row:${ project.id }`;\n    },\n  }\n};\n</script>\n\n<template>\n  <div class=\"project-members\">\n    <Masthead\n      :schema=\"schema\"\n      :resource=\"resource\"\n      :favorite-resource=\"VIRTUAL_TYPES.CLUSTER_MEMBERS\"\n      :create-location=\"createLocation\"\n      :create-button-label=\"t('members.createActionLabel')\"\n      :is-creatable=\"false\"\n      :type-display=\"t('members.clusterAndProject')\"\n    />\n    <Banner\n      v-if=\"isLocal\"\n      color=\"error\"\n      :label=\"t('members.localClusterWarning')\"\n    />\n    <Tabbed>\n      <Tab\n        name=\"cluster-membership\"\n        :label=\"t('members.clusterMembership')\"\n      >\n        <div\n          v-if=\"canEditClusterMembers\"\n          class=\"row mb-10 cluster-add\"\n        >\n          <router-link\n            :to=\"createLocation\"\n            class=\"btn role-primary pull-right\"\n          >\n            {{ t('members.createActionLabel') }}\n          </router-link>\n        </div>\n        <ResourceTable\n          :schema=\"schema\"\n          :headers=\"headers\"\n          :rows=\"filteredClusterRoleTemplateBindings\"\n          :groupable=\"true\"\n          :show-grouping=\"true\"\n          :namespaced=\"false\"\n          :loading=\"$fetchState.pending || !currentCluster || loadingClusterBindings\"\n          sub-search=\"subSearch\"\n          :sub-fields=\"['nameDisplay']\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"canManageProjectMembers && !isHarvester\"\n        name=\"project-membership\"\n        :label=\"t('members.projectMembership')\"\n      >\n        <SortableTable\n          group-by=\"projectId\"\n          :loading=\"$fetchState.pending || !currentCluster || loadingProjectBindings\"\n          :rows=\"rowsWithFakeProjects\"\n          :headers=\"projectRoleTemplateColumns\"\n          :table-actions=\"false\"\n          :row-actions=\"false\"\n        >\n          <template #group-by=\"group\">\n            <div class=\"group-bar\">\n              <div\n                v-trim-whitespace\n                class=\"group-tab\"\n              >\n                <div\n                  v-clean-html=\"getProjectLabel(group)\"\n                  class=\"project-name\"\n                />\n              </div>\n              <div class=\"right\">\n                <button\n                  v-if=\"canEditProjectMembers\"\n                  type=\"button\"\n                  class=\"btn btn-sm role-secondary mr-10 right\"\n                  :data-testid=\"`add-project-member-${getProjectLabel(group).replace(' ', '').toLowerCase()}`\"\n                  @click=\"addProjectMember(group)\"\n                >\n                  {{ t('members.createActionLabel') }}\n                </button>\n              </div>\n            </div>\n          </template>\n          <template\n            #cell:role=\"{row}\"\n          >\n            <span\n              v-for=\"(role, j) in row.allRoles\"\n              :key=\"j\"\n              ref=\"value\"\n              :data-testid=\"`role-value-${j}`\"\n              class=\"role\"\n            >\n              <span\n                class=\"role-value\"\n                :class=\"{'text-link-enabled' : row.canViewInApi}\"\n                @click=\"viewRoleInAPI(row, role)\"\n              >\n                {{ role.nameDisplay }}\n              </span>\n              <i\n                class=\"icon icon-close\"\n                :data-testid=\"`role-values-close-${j}`\"\n                @click=\"removeRole(row, role, $event)\"\n              />\n            </span>\n          </template>\n          <template\n            v-for=\"(project, i) in projectsWithoutRoles\"\n            :key=\"i\"\n            v-slot:[slotName(project)]\n          >\n            <tr\n              class=\"main-row\"\n            >\n              <td\n                class=\"empty text-center\"\n                colspan=\"100%\"\n              >\n                {{ t('members.noRolesAssigned') }}\n              </td>\n            </tr>\n          </template>\n        </SortableTable>\n      </Tab>\n    </Tabbed>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n\n.role {\n  align-items: center;\n    background-color: rgba(0, 0, 0, 0.05);\n    border: 1px solid var(--header-border);\n    border-radius: 5px;\n    color: var(--tag-text);\n    line-height: 20px;\n    padding: 2px 5px;\n    white-space: nowrap;\n    display: inline-flex;\n    margin-right: 3px;\n}\n\n.role-value {\n  &.text-link-enabled {\n    cursor: pointer;\n    &:hover {\n      color: var(--primary);\n    }\n  }\n  + .icon-close {\n    margin-left: 3px;\n    cursor: pointer;\n    &:hover {\n      color: var(--primary);\n    }\n  }\n}\n\n.project-members {\n  & :deep() .group-bar{\n    display: flex;\n    justify-content: space-between;\n  }\n}\n.cluster-add {\n  justify-content: flex-end;\n}\n</style>\n","import { render } from \"./ExplorerMembers.vue?vue&type=template&id=0c76d02a&scoped=true\"\nimport script from \"./ExplorerMembers.vue?vue&type=script&lang=js\"\nexport * from \"./ExplorerMembers.vue?vue&type=script&lang=js\"\n\nimport \"./ExplorerMembers.vue?vue&type=style&index=0&id=0c76d02a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0c76d02a\"]])\n\nexport default __exports__","import { render } from \"./index.vue?vue&type=template&id=6fdf374c\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.role[data-v-0c76d02a]{align-items:center;background-color:rgba(0,0,0,.05);border:1px solid var(--header-border);border-radius:5px;color:var(--tag-text);line-height:20px;padding:2px 5px;white-space:nowrap;display:inline-flex;margin-right:3px}.role-value.text-link-enabled[data-v-0c76d02a]{cursor:pointer}.role-value.text-link-enabled[data-v-0c76d02a]:hover{color:var(--primary)}.role-value+.icon-close[data-v-0c76d02a]{margin-left:3px;cursor:pointer}.role-value+.icon-close[data-v-0c76d02a]:hover{color:var(--primary)}.project-members[data-v-0c76d02a]  .group-bar{display:flex;justify-content:space-between}.cluster-add[data-v-0c76d02a]{justify-content:flex-end}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./ExplorerMembers.vue?vue&type=style&index=0&id=0c76d02a&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"aeeb9dbc\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["$attrs","class","colspan","schema","resource","VIRTUAL_TYPES","CLUSTER_MEMBERS","createLocation","t","color","label","name","to","headers","rows","filteredClusterRoleTemplateBindings","groupable","namespaced","loading","$fetchState","pending","currentCluster","loadingClusterBindings","canManageProjectMembers","isHarvester","loadingProjectBindings","rowsWithFakeProjects","projectRoleTemplateColumns","getProjectLabel","group","type","replace","toLowerCase","addProjectMember","row","allRoles","role","j","key","ref","canViewInApi","viewRoleInAPI","nameDisplay","removeRole","$event","projectsWithoutRoles","project","i","components","Banner","Masthead","ResourceTable","Tabbed","Tab","SortableTable","props","createLocationOverride","Object","default","params","CLUSTER_ROLE_TEMPLATE_BINDING","fetch","clusterRoleTemplateBindingSchema","this","$store","getters","projectRoleTemplateBindingSchema","PROJECT_ROLE_TEMPLATE_BINDING","Promise","all","dispatch","root","then","normanBindings","opt","force","bindings","PROJECT","projects","hydration","normanPrincipals","PRINCIPAL","mgmt","USER","mgmtRoleTemplates","ROLE_TEMPLATE","data","cluster","id","normanClusterRTBSchema","normanProjectRTBSchema","normanClusterRoleTemplateBindings","projectRoleTemplateBindings","labeKey","value","formatter","labelKey","computed","clusterRoleTemplateBindings","map","b","clusterroletemplatebinding","filter","clusterName","filteredProjects","reduce","p","spec","filteredProjectRoleTemplateBindings","out","rb","projectId","inUse","binding","thisProjectId","includes","push","keys","fakeRows","groupByLabel","isFake","mainRowKey","displayName","availableActions","userRoles","curr","userId","groupPrincipalId","roleTemplate","userOrGroup","userOrGroupKey","values","canManageMembers","isLocal","canEditProjectMembers","collectionMethods","find","x","canEditClusterMembers","inStore","methods","getMgmtProjectId","getMgmtProject","component","componentProps","saveInModal","modalSticky","getProjectRoleBinding","r","roleTemplateId","event","promptRemove","viewInApi","slotName","__exports__","ExplorerMembers","render","___CSS_LOADER_EXPORT___","module","content","__esModule","locals","exports","add"],"ignoreList":[],"sourceRoot":""}