{"version":3,"file":"js/dialog24.0298b2f8.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ExtensionCatalogInstallDialog.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ExtensionCatalogInstallDialog.vue?d6df","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ExtensionCatalogInstallDialog.vue?e3c5","webpack://cluster-log-extension/./node_modules/@rancher/shell/dialog/ExtensionCatalogInstallDialog.vue?b0e8"],"sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { CATALOG, SECRET, SERVICE, WORKLOAD_TYPES } from '@shell/config/types';\nimport { UI_PLUGIN_LABELS, UI_PLUGIN_NAMESPACE } from '@shell/config/uiplugins';\nimport { TYPES as SECRET_TYPES } from '@shell/models/secret';\nimport { allHash } from '@shell/utils/promise';\n\nimport ResourceManager from '@shell/mixins/resource-manager';\n\nimport AsyncButton from '@shell/components/AsyncButton';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport Loading from '@shell/components/Loading.vue';\nimport { Banner } from '@components/Banner';\nimport { LabeledInput } from '@components/Form/LabeledInput';\n\nconst DEFAULT_DEPLOYMENT = {\n  type:     WORKLOAD_TYPES.DEPLOYMENT,\n  metadata: {\n    name:      '',\n    namespace: UI_PLUGIN_NAMESPACE,\n    labels:    {}\n  },\n  spec: {\n    replicas: 1,\n    selector: { matchLabels: {} },\n    template: {\n      metadata: {\n        namespace: UI_PLUGIN_NAMESPACE,\n        labels:    {}\n      },\n      spec: {\n        containers: [\n          {\n            image:           '',\n            imagePullPolicy: 'Always',\n            name:            'container-0'\n          }\n        ],\n        imagePullSecrets: [],\n        restartPolicy:    'Always'\n      }\n    }\n  }\n};\n\nconst DEFAULT_SERVICE = {\n  type:     SERVICE,\n  metadata: {\n    name:      '',\n    namespace: UI_PLUGIN_NAMESPACE,\n    labels:    { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' }\n  },\n  spec: {\n    ports: [\n      {\n        name:       '',\n        port:       8080,\n        protocol:   'TCP',\n        targetPort: 8080\n      }\n    ],\n    selector: { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' },\n    type:     'ClusterIP'\n  }\n};\n\nconst DEFAULT_REPO = {\n  type:     CATALOG.CLUSTER_REPO,\n  metadata: {\n    name:   '',\n    labels: { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' }\n  },\n  spec: { url: null }\n};\n\nconst initialState = () => {\n  const deploymentValues = structuredClone(DEFAULT_DEPLOYMENT);\n  const serviceValues = structuredClone(DEFAULT_SERVICE);\n  const repoValues = structuredClone(DEFAULT_REPO);\n\n  return {\n    deploymentValues,\n    serviceValues,\n    repoValues,\n    canModifyName:              true,\n    canModifyImage:             true,\n    imagePullSecrets:           [],\n    imagePullNamespacedSecrets: [],\n    extensionUrl:               null,\n    extensionDeployment:        null,\n    extensionSvc:               null,\n    extensionRepo:              null,\n    extensionCrd:               null\n  };\n};\n\nexport default {\n  emits: ['close'],\n\n  components: {\n    AsyncButton, Banner, LabeledInput, Loading, LabeledSelect\n  },\n\n  mixins: [ResourceManager],\n\n  props: {\n    /**\n     * Callback to trigger refresh banner on extensions screen\n     */\n    refresh: {\n      type:     Function,\n      default:  () => {},\n      required: true\n    },\n    /**\n     * Callback when modal is closed\n     */\n    closed: {\n      type:     Function,\n      default:  () => {},\n      required: true\n    },\n    resources: {\n      type:    Array,\n      default: () => []\n    },\n    registerBackgroundClosing: {\n      type:    Function,\n      default: () => {}\n    }\n  },\n\n  async fetch() {\n    const hash = {};\n\n    if ( this.$store.getters['management/canList'](WORKLOAD_TYPES.DEPLOYMENT) ) {\n      hash.deployments = this.$store.dispatch('management/findAll', { type: WORKLOAD_TYPES.DEPLOYMENT });\n    }\n\n    if ( this.$store.getters['management/canList'](SERVICE) ) {\n      hash.services = this.$store.dispatch('management/findAll', { type: SERVICE });\n    }\n\n    await allHash(hash);\n\n    this.secondaryResourceData = this.secondaryResourceDataConfig();\n    this.resourceManagerFetchSecondaryResources(this.secondaryResourceData);\n  },\n\n  data() {\n    return {\n      ...initialState(),\n      secondaryResourceData: null\n    };\n  },\n\n  computed: {\n    ...mapGetters({ allRepos: 'catalog/repos' }),\n\n    namespacedDeployments() {\n      return this.$store.getters['management/all'](WORKLOAD_TYPES.DEPLOYMENT).filter((dep) => dep.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    },\n\n    namespacedServices() {\n      return this.$store.getters['management/all'](SERVICE).filter((svc) => svc.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    }\n  },\n\n  methods: {\n    secondaryResourceDataConfig() {\n      return {\n        namespace: UI_PLUGIN_NAMESPACE,\n        data:      {\n          [SECRET]: {\n            applyTo: [\n              {\n                var:         'imagePullNamespacedSecrets',\n                parsingFunc: (data) => {\n                  return data.filter((secret) => (secret._type === SECRET_TYPES.DOCKER || secret._type === SECRET_TYPES.DOCKER_JSON));\n                }\n              }\n            ]\n          }\n        }\n      };\n    },\n\n    closeDialog(result) {\n      this.closed(result);\n\n      // Reset state\n      Object.assign(this.$data, initialState());\n      this.secondaryResourceData = this.secondaryResourceDataConfig();\n      this.resourceManagerFetchSecondaryResources(this.secondaryResourceData);\n\n      this.$emit('close');\n    },\n\n    async loadImage(btnCb) {\n      try {\n        if (!isEmpty(this.deploymentValues.spec.template.spec.containers[0].image)) {\n          const image = this.deploymentValues.spec.template.spec.containers[0].image;\n          const name = this.extractImageName(image);\n\n          if (name) {\n            // Create deployment\n            await this.loadDeployment(image, name, btnCb);\n\n            if (this.extensionDeployment) {\n              // Create service\n              await this.loadService(name, btnCb);\n            }\n\n            if (this.extensionSvc) {\n              // Create helm repo\n              await this.loadRepo(name, btnCb);\n            }\n\n            if (this.extensionRepo) {\n              btnCb(true);\n              this.closeDialog();\n              this.$store.dispatch('growl/success', {\n                title:   this.t('plugins.manageCatalog.imageLoad.success.title', { name }),\n                message: this.t('plugins.manageCatalog.imageLoad.success.message'),\n                timeout: 4000,\n              }, { root: true });\n\n              this.refresh();\n            }\n          } else {\n            throw new Error('Unable to determine image name');\n          }\n        }\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    async loadDeployment(image, name, btnCb) {\n      const exists = this.namespacedDeployments.find((dep) => dep.spec.template.spec.containers[0].image === image);\n\n      if (!exists) {\n        // Sets deploymentValues with name, labels, and imagePullSecrets\n        const deploymentValues = this.parseDeploymentValues(name);\n\n        this.extensionDeployment = await this.$store.dispatch('management/create', deploymentValues);\n\n        try {\n          await this.extensionDeployment.save();\n        } catch (e) {\n          this.handleGrowlError(e, true);\n          btnCb(false);\n        }\n      } else {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.deployment.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.deployment.message', { image })\n        };\n\n        this.handleGrowlError(error);\n        btnCb(false);\n      }\n    },\n\n    async loadService(name, btnCb) {\n      const serviceName = `${ name }-svc`;\n      const exists = this.namespacedServices.find((svc) => svc.metadata.name === serviceName);\n\n      if (exists) {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.service.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.service.message', { svc: serviceName })\n        };\n\n        this.handleGrowlError(error, true);\n        btnCb(false);\n\n        return;\n      }\n\n      // Sets serviceValues with name, label, and selector\n      const serviceValues = this.parseServiceValues(name, serviceName);\n      const serviceResource = await this.$store.dispatch('management/create', serviceValues);\n\n      try {\n        await serviceResource.save();\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n\n        return;\n      }\n\n      try {\n        this.extensionSvc = await this.$store.dispatch('management/find', {\n          type:      SERVICE,\n          id:        `${ UI_PLUGIN_NAMESPACE }/${ serviceResource.metadata.name }`,\n          namespace: UI_PLUGIN_NAMESPACE\n        });\n\n        if (this.extensionSvc) {\n          this.extensionUrl = `http://${ this.extensionSvc.spec.clusterIP }:${ this.extensionSvc.spec.ports[0].port }`;\n        } else {\n          throw new Error('Error fetching extension service');\n        }\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    async loadRepo(name, btnCb) {\n      const chartName = `${ name }-charts`;\n      const exists = this.allRepos.find((repo) => repo.metadata.name === chartName);\n\n      if (exists) {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.repo.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.repo.message', { repo: chartName })\n        };\n\n        this.handleGrowlError(error);\n        btnCb(false);\n        this.clean();\n\n        return;\n      }\n\n      // Set repoValues with name, label, and url\n      const repoValues = this.parseRepoValues(chartName);\n\n      this.extensionRepo = await this.$store.dispatch('management/create', repoValues);\n\n      try {\n        await this.extensionRepo.save();\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    parseDeploymentValues(name) {\n      let out = {};\n\n      this.deploymentValues.metadata['name'] = name;\n\n      const addLabel = { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: name };\n      const addTo = ['metadata.labels', 'spec.selector.matchLabels', 'spec.template.metadata.labels'];\n\n      // Populates workloadselector labels\n      out = this.assignLabels(this.deploymentValues, addLabel, addTo);\n\n      if (this.imagePullSecrets.length) {\n        out.spec.template.spec.imagePullSecrets = this.imagePullSecrets.map((secret) => {\n          return { name: secret };\n        });\n      }\n\n      return out;\n    },\n\n    parseServiceValues(name, serviceName) {\n      const out = this.serviceValues;\n\n      out.metadata.name = serviceName;\n      out.metadata.labels[UI_PLUGIN_LABELS.CATALOG_IMAGE] = name;\n      out.spec.selector[UI_PLUGIN_LABELS.CATALOG_IMAGE] = name;\n\n      return out;\n    },\n\n    parseRepoValues(chartName) {\n      const out = this.repoValues;\n\n      out.metadata.name = chartName;\n      out.metadata.labels[UI_PLUGIN_LABELS.CATALOG_IMAGE] = this.deploymentValues.metadata.name;\n      out.spec.url = this.extensionUrl;\n\n      return out;\n    },\n\n    assignLabels(source, labels, args) {\n      for (let i = 0; i < args.length; i++) {\n        const path = args[i].split('.');\n        let currentObj = source;\n\n        for (let j = 0; j < path.length - 1; j++) {\n          currentObj = currentObj[path[j]];\n        }\n\n        currentObj[path[path.length - 1]] = labels;\n      }\n\n      return source;\n    },\n\n    extractImageVersion(image) {\n      // Returns the version number with optional pre-release identifiers\n      const regex = /:(\\d+\\.\\d+\\.\\d+([-\\w\\d]+)*)$/;\n      const matches = regex.exec(image);\n\n      if (matches) {\n        return matches[1];\n      }\n\n      return null;\n    },\n\n    extractImageName(image) {\n      // Returns the name within the image that prefixes the version number\n      const regex = /\\/([^/:]+)(?::\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?|$)/;\n      const matches = regex.exec(image);\n\n      if (matches) {\n        return matches[1];\n      }\n\n      return null;\n    },\n\n    clean() {\n      // Remove failed resources\n      if (this.extensionDeployment) {\n        this.extensionDeployment.remove();\n      }\n      if (this.extensionSvc) {\n        this.extensionSvc.remove();\n      }\n      if (this.extensionRepo) {\n        this.extensionRepo.remove();\n      }\n    },\n\n    handleGrowlError(e, clean = false) {\n      const error = e?.data || e;\n\n      this.$store.dispatch('growl/error', {\n        title:   error._statusText,\n        message: error.message,\n        timeout: 5000,\n      }, { root: true });\n\n      if (clean) {\n        this.clean();\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <Loading\n    v-if=\"$fetchState.loading\"\n    mode=\"relative\"\n  />\n  <div\n    v-else\n    class=\"plugin-install-dialog\"\n  >\n    <div>\n      <h4>\n        {{ t('plugins.manageCatalog.imageLoad.load') }}\n      </h4>\n      <p>\n        {{ t('plugins.manageCatalog.imageLoad.prompt') }}\n      </p>\n\n      <div class=\"custom mt-10\">\n        <Banner\n          color=\"info\"\n          :label=\"t('plugins.manageCatalog.imageLoad.banner')\"\n          class=\"mt-10\"\n        />\n      </div>\n\n      <div class=\"custom mt-10\">\n        <div class=\"fields\">\n          <LabeledInput\n            v-model:value.trim=\"deploymentValues.spec.template.spec.containers[0].image\"\n            label-key=\"plugins.manageCatalog.imageLoad.fields.image.label\"\n            placeholder-key=\"plugins.manageCatalog.imageLoad.fields.image.placeholder\"\n          />\n        </div>\n      </div>\n      <div class=\"custom mt-10\">\n        <div class=\"fields\">\n          <LabeledSelect\n            v-model:value=\"imagePullSecrets\"\n            :label=\"t('plugins.manageCatalog.imageLoad.fields.imagePullSecrets.label')\"\n            :tooltip=\"t('plugins.manageCatalog.imageLoad.fields.imagePullSecrets.tooltip')\"\n            :multiple=\"true\"\n            :taggable=\"true\"\n            :options=\"imagePullNamespacedSecrets\"\n            option-label=\"metadata.name\"\n            :reduce=\"service => service.metadata.name\"\n          />\n          <Banner\n            color=\"warning\"\n            class=\"mt-10\"\n          >\n            <span v-clean-html=\"t('plugins.manageCatalog.imageLoad.fields.secrets.banner', {}, true)\" />\n          </Banner>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"custom mt-10\">\n      <div class=\"fields\">\n        <div class=\"dialog-buttons mt-20\">\n          <button\n            class=\"btn role-secondary\"\n            data-testid=\"image-load-ext-modal-cancel-btn\"\n            @click=\"closeDialog()\"\n          >\n            {{ t('generic.cancel') }}\n          </button>\n          <AsyncButton\n            mode=\"load\"\n            data-testid=\"image-load-ext-modal-install-btn\"\n            @click=\"loadImage\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .plugin-install-dialog {\n    padding: 10px;\n\n    h4 {\n      font-weight: bold;\n    }\n\n    .dialog-panel {\n      display: flex;\n      flex-direction: column;\n      min-height: 100px;\n\n      p {\n        margin-bottom: 5px;\n      }\n\n      .dialog-info {\n        flex: 1;\n      }\n    }\n\n    .dialog-buttons {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 10px;\n\n      > *:not(:last-child) {\n        margin-right: 10px;\n      }\n    }\n  }\n</style>\n","import { render } from \"./ExtensionCatalogInstallDialog.vue?vue&type=template&id=f920c9b4&scoped=true\"\nimport script from \"./ExtensionCatalogInstallDialog.vue?vue&type=script&lang=js\"\nexport * from \"./ExtensionCatalogInstallDialog.vue?vue&type=script&lang=js\"\n\nimport \"./ExtensionCatalogInstallDialog.vue?vue&type=style&index=0&id=f920c9b4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f920c9b4\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.plugin-install-dialog[data-v-f920c9b4]{padding:10px}.plugin-install-dialog h4[data-v-f920c9b4]{font-weight:700}.plugin-install-dialog .dialog-panel[data-v-f920c9b4]{display:flex;flex-direction:column;min-height:100px}.plugin-install-dialog .dialog-panel p[data-v-f920c9b4]{margin-bottom:5px}.plugin-install-dialog .dialog-panel .dialog-info[data-v-f920c9b4]{flex:1}.plugin-install-dialog .dialog-buttons[data-v-f920c9b4]{display:flex;justify-content:flex-end;margin-top:10px}.plugin-install-dialog .dialog-buttons[data-v-f920c9b4]>:not(:last-child){margin-right:10px}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./ExtensionCatalogInstallDialog.vue?vue&type=style&index=0&id=f920c9b4&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1489b1e6\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["class","$fetchState","mode","t","color","label","value","deploymentValues","spec","template","containers","image","imagePullSecrets","tooltip","multiple","taggable","options","imagePullNamespacedSecrets","reduce","service","metadata","name","closeDialog","loadImage","DEFAULT_DEPLOYMENT","type","DEPLOYMENT","namespace","labels","replicas","selector","matchLabels","imagePullPolicy","restartPolicy","DEFAULT_SERVICE","CATALOG_IMAGE","ports","port","protocol","targetPort","DEFAULT_REPO","CLUSTER_REPO","url","initialState","structuredClone","serviceValues","repoValues","canModifyName","canModifyImage","extensionUrl","extensionDeployment","extensionSvc","extensionRepo","extensionCrd","emits","components","AsyncButton","Banner","LabeledInput","Loading","LabeledSelect","mixins","props","refresh","Function","default","required","closed","resources","Array","registerBackgroundClosing","fetch","hash","this","$store","getters","deployments","dispatch","services","secondaryResourceData","secondaryResourceDataConfig","resourceManagerFetchSecondaryResources","data","computed","allRepos","namespacedDeployments","filter","dep","namespacedServices","svc","methods","applyTo","var","parsingFunc","secret","_type","DOCKER","DOCKER_JSON","result","Object","assign","$data","$emit","btnCb","extractImageName","Error","loadDeployment","loadService","loadRepo","title","message","timeout","root","e","handleGrowlError","exists","find","error","_statusText","parseDeploymentValues","save","serviceName","parseServiceValues","serviceResource","id","clusterIP","chartName","repo","clean","parseRepoValues","out","addLabel","addTo","assignLabels","length","map","source","args","i","path","split","currentObj","j","extractImageVersion","regex","matches","exec","remove","__exports__","render","___CSS_LOADER_EXPORT___","push","module","content","__esModule","locals","exports","add"],"ignoreList":[],"sourceRoot":""}