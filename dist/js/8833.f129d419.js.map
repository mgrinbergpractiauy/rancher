{"version":3,"file":"js/8833.f129d419.js","mappings":"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","sources":["webpack://cluster-log-extension/./node_modules/@rancher/shell/components/PromptRemove.vue","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/PromptRemove.vue?fd8a","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/PromptRemove.vue?ac85","webpack://cluster-log-extension/./node_modules/@rancher/shell/components/PromptRemove.vue?00da"],"sourcesContent":["<script>\nimport { shallowRef } from 'vue';\nimport { mapState, mapGetters } from 'vuex';\nimport { get, isEmpty } from '@shell/utils/object';\nimport { escapeHtml, resourceNames } from '@shell/utils/string';\nimport { Card } from '@components/Card';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { alternateLabel } from '@shell/utils/platform';\nimport { uniq } from '@shell/utils/array';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { CATALOG } from '@shell/config/types';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport AppModal from '@shell/components/AppModal.vue';\n\nexport default {\n  name: 'PromptRemove',\n\n  components: {\n    Card, Checkbox, AsyncButton, LabeledInput, AppModal\n  },\n  props: {\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'prompt-remove'\n    }\n  },\n  data() {\n    const { resource } = this.$route.params;\n\n    return {\n      hasCustomRemove:     false,\n      randomPosition:      Math.random(),\n      confirmName:         '',\n      error:               '',\n      warning:             '',\n      preventDelete:       false,\n      removeComponent:     shallowRef(this.$store.getters['type-map/importCustomPromptRemove'](resource)),\n      chartsToRemoveIsApp: false,\n      chartsDeleteCrd:     false,\n      showModal:           false,\n      cachedDoneLocation:  null\n    };\n  },\n  computed: {\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay);\n    },\n\n    nameToMatchPosition() {\n      const visibleNames = Math.min(5, this.names.length);\n      const randomNamePos = Math.floor(this.randomPosition * visibleNames);\n\n      return randomNamePos;\n    },\n\n    nameToMatch() {\n      return this.names[this.nameToMatchPosition];\n    },\n\n    type() {\n      const types = new Set(this.toRemove.reduce((array, each) => {\n        array.push(each.type);\n\n        return array;\n      }, []));\n\n      if (types.size > 1) {\n        return this.t('generic.resource', { count: this.toRemove.length });\n      }\n\n      const schema = this.toRemove[0]?.schema;\n\n      if ( !schema ) {\n        return `resource${ this.toRemove.length === 1 ? '' : 's' }`;\n      }\n\n      return this.$store.getters['type-map/labelFor'](schema, this.toRemove.length);\n    },\n\n    selfLinks() {\n      return this.toRemove.map((resource) => {\n        return get(resource, 'links.self');\n      });\n    },\n\n    needsConfirm() {\n      const first = this.toRemove[0];\n\n      return first?.confirmRemove;\n    },\n\n    // if the current route ends with the ID of the resource being deleted, whatever page this is wont be valid after successful deletion: navigate away\n    doneLocation() {\n      // if deleting more than one resource, this is happening in list view and shouldn't redirect anywhere\n      if (this.toRemove.length > 1) {\n        return null;\n      }\n\n      if (this.toRemove[0].doneOverride) {\n        return this.toRemove[0].doneOverride;\n      }\n\n      const currentRoute = this.toRemove[0].currentRoute();\n      const out = {};\n      const params = { ...currentRoute.params };\n\n      if (params.id && (params.id === this.toRemove[0]?.metadata?.name || params.id === this.toRemove[0].id)) {\n        let { name = '' } = currentRoute;\n\n        const idIndex = name.indexOf('-id');\n\n        if (idIndex !== -1) {\n          name = name.slice(0, idIndex);\n        }\n\n        if (params.namespace) {\n          const namespaceIndex = name.indexOf('-namespace');\n\n          if (namespaceIndex !== -1) {\n            name = name.slice(0, namespaceIndex);\n          }\n          delete params.namespace;\n        }\n        delete params.id;\n\n        out.params = params;\n        out.name = name;\n      }\n\n      return out;\n    },\n\n    currentRouter() {\n      // ...don't need a router if there's no route to go to\n      if (!this.doneLocation) {\n        return null;\n      } else {\n        return this.toRemove[0].currentRouter();\n      }\n    },\n\n    protip() {\n      return this.t('promptRemove.protip', { alternateLabel });\n    },\n\n    deleteDisabled() {\n      const confirmFailed = this.needsConfirm && this.confirmName !== this.nameToMatch;\n\n      return this.preventDelete || confirmFailed;\n    },\n\n    ...mapState('action-menu', ['showPromptRemove', 'toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n  },\n\n  watch: {\n    showPromptRemove(show) {\n      if (show) {\n        const selected = this.toRemove[0];\n\n        if (this.currentRouter?.currentRoute?.value?.name === 'c-cluster-explorer-tools' &&\n            selected.type === CATALOG.APP &&\n            selected.spec?.chart?.metadata?.annotations[CATALOG_ANNOTATIONS.AUTO_INSTALL]) {\n          this.chartsToRemoveIsApp = true;\n        }\n\n        this.showModal = true;\n\n        let { resource } = this.$route.params;\n\n        if (this.toRemove.length > 0) {\n          resource = selected.type;\n        }\n\n        this.hasCustomRemove = this.$store.getters['type-map/hasCustomPromptRemove'](resource);\n\n        this.removeComponent = shallowRef(this.$store.getters['type-map/importCustomPromptRemove'](resource));\n      } else {\n        this.showModal = false;\n      }\n    },\n\n    // check for any resources with a deletion prevention message,\n    // if none found (delete is allowed), then check for any resources with a warning message\n    toRemove(neu) {\n      let message;\n      const preventDeletionMessages = neu.filter((item) => item.preventDeletionMessage);\n\n      this.preventDelete = false;\n\n      if (!!preventDeletionMessages.length) {\n        this.preventDelete = true;\n        message = preventDeletionMessages[0].preventDeletionMessage;\n      } else {\n        const warnDeletionMessages = neu.filter((item) => item.warnDeletionMessage);\n\n        if (!!warnDeletionMessages.length) {\n          message = warnDeletionMessages[0].warnDeletionMessage;\n        }\n      }\n      if (typeof message === 'function' ) {\n        this.warning = message(this.toRemove);\n      } else if (!!message) {\n        this.warning = message;\n      } else {\n        this.warning = '';\n      }\n    }\n  },\n\n  methods: {\n    resourceNames,\n    escapeHtml,\n    close() {\n      this.confirmName = '';\n      this.error = '';\n      this.chartsDeleteCrd = false;\n      this.chartsToRemoveIsApp = false;\n      this.cachedDoneLocation = null;\n      this.$store.commit('action-menu/togglePromptRemove');\n    },\n\n    async remove(btnCB) {\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        this.cachedDoneLocation = { ...this.doneLocation };\n      } else {\n        this.cachedDoneLocation = null;\n      }\n\n      if (this.hasCustomRemove && this.$refs?.customPrompt?.remove) {\n        let handled = this.$refs.customPrompt.remove(btnCB);\n\n        // If the response is a promise, then wait for the promise\n        if (handled && handled.then) {\n          try {\n            handled = await handled;\n          } catch (err) {\n            this.error = err;\n            btnCB(false);\n\n            return;\n          }\n        }\n\n        // If the remove function for the custom dialog handled the request, it can return true or not return anything\n        // if it returned false, then it wants us to continue with the deletion logic below - this is useful\n        // where the custom dialog needs to delete additional resources - it handles those and retrurns false to get us\n        // to delete the main resource\n        if (handled === undefined || handled) {\n          return;\n        }\n      }\n      const serialRemove = this.toRemove.some((resource) => resource.removeSerially);\n\n      if (serialRemove) {\n        this.serialRemove(btnCB);\n      } else {\n        this.parallelRemove(btnCB);\n      }\n    },\n    async serialRemove(btnCB) {\n      try {\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        for (const resource of this.toRemove) {\n          await resource.remove();\n        }\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    async parallelRemove(btnCB) {\n      try {\n        if (typeof this.toRemove[0].bulkRemove !== 'undefined') {\n          await this.toRemove[0].bulkRemove(this.toRemove, {});\n        } else {\n          await Promise.all(this.toRemove.map((resource) => resource.remove()));\n        }\n\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    done() {\n      if (!isEmpty(this.cachedDoneLocation) && this.currentRouter) {\n        this.currentRouter.push(this.cachedDoneLocation);\n      }\n      this.close();\n    },\n    getSpoofedTypes(resources) {\n      const uniqueResourceTypes = uniq(this.toRemove.map((resource) => resource.type));\n\n      return uniqueResourceTypes.filter(this.$store.getters['type-map/isSpoofed']);\n    },\n\n    // If spoofed we need to reload the values as the server can't have watchers for them.\n    refreshSpoofedTypes(types) {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const promises = types.map((type) => this.$store.dispatch(`${ inStore }/findAll`, { type, opt: { force: true } }, { root: true }));\n\n      return Promise.all(promises);\n    },\n\n    async chartAddCrdToRemove() {\n      try {\n        const res = await this.toRemove[0].relatedResourcesToRemove();\n\n        if (!this.toRemove.includes(res)) {\n          this.toRemove.push(res);\n        } else if (!this.chartsDeleteCrd) {\n          this.toRemove.pop(res);\n        }\n      } catch (err) {\n        this.error = err;\n        this.chartsDeleteCrd = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <app-modal\n    v-if=\"showModal\"\n    custom-class=\"remove-modal\"\n    name=\"promptRemove\"\n    :width=\"400\"\n    height=\"auto\"\n    styles=\"max-height: 100vh;\"\n    :trigger-focus-trap=\"true\"\n    @close=\"close\"\n  >\n    <Card\n      class=\"prompt-remove\"\n      :show-highlight-border=\"false\"\n    >\n      <template #title>\n        <h4 class=\"text-default-text\">\n          {{ t('promptRemove.title') }}\n        </h4>\n      </template>\n      <template #body>\n        <div class=\"mb-10\">\n          <template v-if=\"!hasCustomRemove\">\n            {{ t('promptRemove.attemptingToRemove', { type }) }} <span\n              v-clean-html=\"resourceNames(names, null, t)\"\n            />\n          </template>\n\n          <component\n            :is=\"removeComponent\"\n            v-if=\"hasCustomRemove\"\n            ref=\"customPrompt\"\n            v-model:value=\"toRemove\"\n            v-bind=\"$data\"\n            :close=\"close\"\n            :needs-confirm=\"needsConfirm\"\n            :value=\"toRemove\"\n            :names=\"names\"\n            :type=\"type\"\n            :done-location=\"doneLocation\"\n            @errors=\"e => error = e\"\n            @done=\"done\"\n          />\n          <div\n            v-if=\"needsConfirm\"\n            class=\"mt-10\"\n          >\n            <span\n              v-clean-html=\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) }, true)\"\n              class=\"confirm-text\"\n            />\n          </div>\n        </div>\n        <LabeledInput\n          v-if=\"needsConfirm\"\n          id=\"confirm\"\n          v-model:value=\"confirmName\"\n          v-focus\n          :data-testid=\"componentTestid + '-input'\"\n          type=\"text\"\n          :aria-label=\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) })\"\n        >\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n          <div\n            v-if=\"!needsConfirm\"\n            class=\"text-info mt-20\"\n          >\n            {{ protip }}\n          </div>\n        </LabeledInput>\n        <div v-else-if=\"!hasCustomRemove\">\n          <div\n            v-if=\"warning\"\n            class=\"text-warning mb-10 mt-10\"\n          >\n            {{ warning }}\n          </div>\n          <div\n            v-if=\"error\"\n            class=\"text-error mb-10 mt-10\"\n          >\n            {{ error }}\n          </div>\n        </div>\n        <Checkbox\n          v-if=\"chartsToRemoveIsApp\"\n          v-model:value=\"chartsDeleteCrd\"\n          label-key=\"promptRemoveApp.removeCrd\"\n          class=\"mt-10 type\"\n          @update:value=\"chartAddCrdToRemove\"\n        />\n      </template>\n      <template #actions>\n        <button\n          class=\"btn role-secondary\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n        <div class=\"spacer\" />\n        <AsyncButton\n          mode=\"delete\"\n          class=\"btn bg-error ml-10\"\n          :disabled=\"deleteDisabled\"\n          :data-testid=\"componentTestid + '-confirm-button'\"\n          @click=\"remove\"\n        />\n      </template>\n    </Card>\n  </app-modal>\n</template>\n\n<style lang='scss'>\n  .prompt-remove {\n    &.card-container {\n      box-shadow: none;\n    }\n    #confirm {\n      width: 90%;\n      margin-left: 3px;\n    }\n\n    .actions {\n      text-align: right;\n    }\n\n    .card-actions {\n      display: flex;\n\n      .spacer {\n        flex: 1;\n      }\n    }\n\n    .confirm-text b {\n      user-select: all;\n    }\n  }\n</style>\n","import { render } from \"./PromptRemove.vue?vue&type=template&id=a27c7e9e\"\nimport script from \"./PromptRemove.vue?vue&type=script&lang=js\"\nexport * from \"./PromptRemove.vue?vue&type=script&lang=js\"\n\nimport \"./PromptRemove.vue?vue&type=style&index=0&id=a27c7e9e&lang=scss\"\n\nimport exportComponent from \"../../../vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../xterm/css/xterm.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.prompt-remove.card-container{box-shadow:none}.prompt-remove #confirm{width:90%;margin-left:3px}.prompt-remove .actions{text-align:right}.prompt-remove .card-actions{display:flex}.prompt-remove .card-actions .spacer{flex:1}.prompt-remove .confirm-text b{-webkit-user-select:all;-moz-user-select:all;user-select:all}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../vue-loader/dist/stylePostLoader.js!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../vue-loader/dist/index.js??ruleSet[0].use[1]!./PromptRemove.vue?vue&type=style&index=0&id=a27c7e9e&lang=scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"169ba66a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["class","name","width","height","styles","close","title","t","body","hasCustomRemove","type","resourceNames","names","removeComponent","ref","value","toRemove","$data","needsConfirm","doneLocation","e","error","done","nameToMatch","escapeHtml","id","confirmName","componentTestid","warning","protip","chartsDeleteCrd","chartAddCrdToRemove","actions","mode","disabled","deleteDisabled","remove","components","Card","Checkbox","AsyncButton","LabeledInput","AppModal","props","String","default","data","resource","this","$route","params","randomPosition","Math","random","preventDelete","$store","getters","chartsToRemoveIsApp","showModal","cachedDoneLocation","computed","map","obj","nameDisplay","nameToMatchPosition","visibleNames","min","length","randomNamePos","floor","types","Set","reduce","array","each","push","size","count","schema","selfLinks","get","first","confirmRemove","doneOverride","currentRoute","out","metadata","idIndex","indexOf","slice","namespace","namespaceIndex","currentRouter","alternateLabel","confirmFailed","watch","showPromptRemove","show","selected","APP","spec","chart","annotations","AUTO_INSTALL","neu","message","preventDeletionMessages","filter","item","preventDeletionMessage","warnDeletionMessages","warnDeletionMessage","methods","commit","btnCB","$refs","customPrompt","handled","then","err","undefined","serialRemove","some","removeSerially","parallelRemove","spoofedTypes","getSpoofedTypes","refreshSpoofedTypes","bulkRemove","Promise","all","isEmpty","resources","uniqueResourceTypes","inStore","promises","dispatch","opt","force","root","res","relatedResourcesToRemove","includes","pop","__exports__","render","___CSS_LOADER_EXPORT___","i","module","content","__esModule","locals","exports","add"],"ignoreList":[],"sourceRoot":""}