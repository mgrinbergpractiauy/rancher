(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[19],{13215:(e,t,s)=>{var o=s(40085);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("61e04565",o,!0,{sourceMap:!1,shadowMode:!1})},40019:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>z});var o=s(20641),a=s(90033),l=s(53751);const i={key:1,class:"main-layout login"},r={class:"row gutless mb-20"},n={class:"col span-6 p-20"},c={class:"text-center"},d={class:"text-center login-welcome"},u={key:1,class:"text-success text-center"},g={key:2,class:"text-error text-center"},h={class:"span-6 offset-3"},p={class:"mb-20"},m={class:""},v={class:"mt-20"},b={class:"col span-12 text-center"},L={key:0,class:"mt-20"},f={key:1,class:"mt-20 text-center"},k={key:2,class:"mt-20 text-center"},y={key:3,class:"locale-selector"};function w(e,t,s,w,S,$){const E=(0,o.g2)("Loading"),C=(0,o.g2)("TabTitle"),_=(0,o.g2)("Banner"),I=(0,o.g2)("t"),O=(0,o.g2)("CopyCode"),W=(0,o.g2)("LabeledInput"),x=(0,o.g2)("Password"),N=(0,o.g2)("AsyncButton"),T=(0,o.g2)("Checkbox"),R=(0,o.g2)("LocaleSelector"),A=(0,o.g2)("BrandImage");return e.$fetchState.pending?((0,o.uX)(),(0,o.Wv)(E,{key:0,mode:"relative"})):((0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(C,{"show-child":!1,breadcrumb:!1},{default:(0,o.k6)(()=>[(0,o.eW)((0,a.v_)(`${S.vendor} - ${e.t("login.login")}`),1)]),_:1}),t[33]||(t[33]=(0,o.eW)()),(0,o.Lk)("div",r,[(0,o.Lk)("div",n,[(0,o.Lk)("p",c,(0,a.v_)(e.t("login.howdy")),1),t[26]||(t[26]=(0,o.eW)()),(0,o.Lk)("h1",d,(0,a.v_)(e.t("login.welcome",{vendor:S.vendor})),1),t[27]||(t[27]=(0,o.eW)()),(0,o.Lk)("div",{class:(0,a.C4)(["login-messages",{"login-messages--hasContent":$.hasLoginMessage}]),"data-testid":"login__messages"},[$.errorToDisplay?((0,o.uX)(),(0,o.Wv)(_,{key:0,label:$.errorToDisplay,color:"error"},null,8,["label"])):S.loggedOut?((0,o.uX)(),(0,o.CE)("h4",u,(0,a.v_)($.loggedOutSuccessMsg),1)):S.timedOut?((0,o.uX)(),(0,o.CE)("h4",g,(0,a.v_)(e.t("login.loginAgain")),1)):(0,o.Q3)("",!0)],2),t[28]||(t[28]=(0,o.eW)()),S.firstLogin?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,a.C4)(["first-login-message pl-10 pr-10",{"mt-30":!$.hasLoginMessage}]),"data-testid":"first-login-message"},[(0,o.bF)(I,{k:"setup.defaultPassword.intro",raw:!0}),t[9]||(t[9]=(0,o.eW)()),(0,o.Lk)("div",null,[(0,o.bF)(I,{k:"setup.defaultPassword.dockerPrefix",raw:!0})]),t[10]||(t[10]=(0,o.eW)()),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.bF)(I,{k:"setup.defaultPassword.dockerPs",raw:!0})]),t[8]||(t[8]=(0,o.eW)()),(0,o.Lk)("li",null,[(0,o.bF)(O,null,{default:(0,o.k6)(()=>t[7]||(t[7]=[(0,o.eW)("\n                docker logs ",-1),(0,o.Lk)("u",null,"container-id",-1),(0,o.eW)(' 2>&1 | grep "Bootstrap Password:"\n              ',-1)])),_:1,__:[7]})])]),t[11]||(t[11]=(0,o.eW)()),(0,o.Lk)("div",null,[(0,o.bF)(I,{k:"setup.defaultPassword.dockerSuffix",raw:!0})]),t[12]||(t[12]=(0,o.eW)()),t[13]||(t[13]=(0,o.Lk)("br",null,null,-1)),t[14]||(t[14]=(0,o.eW)()),(0,o.Lk)("div",null,[(0,o.bF)(I,{k:"setup.defaultPassword.helmPrefix",raw:!0})]),t[15]||(t[15]=(0,o.eW)()),t[16]||(t[16]=(0,o.Lk)("br",null,null,-1)),t[17]||(t[17]=(0,o.eW)()),(0,o.bF)(O,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,a.v_)($.kubectlCmd),1)]),_:1}),t[18]||(t[18]=(0,o.eW)()),t[19]||(t[19]=(0,o.Lk)("br",null,null,-1)),t[20]||(t[20]=(0,o.eW)()),(0,o.Lk)("div",null,[(0,o.bF)(I,{k:"setup.defaultPassword.helmSuffix",raw:!0})])],2)):(0,o.Q3)("",!0),t[29]||(t[29]=(0,o.eW)()),(!S.hasLocal||S.hasLocal&&!S.showLocal)&&S.providers.length?((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,a.C4)({"mt-30":!$.hasLoginMessage})},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(S.providers,(e,s)=>((0,o.uX)(),(0,o.Wv)((0,o.$y)(S.providerComponents[s]),{key:s,class:"mb-10","focus-on-mount":0===s&&!S.showLocal,name:e,open:!S.showLocal,onShowInputs:t[0]||(t[0]=e=>S.showLocal=!1),onError:$.handleProviderError},null,40,["focus-on-mount","name","open","onError"]))),128))],2)):(0,o.Q3)("",!0),t[30]||(t[30]=(0,o.eW)()),S.hasLocal?((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[S.showLocal?((0,o.uX)(),(0,o.CE)("form",{key:0,class:(0,a.C4)({"mt-30":!$.hasLoginMessage}),onSubmit:t[4]||(t[4]=(0,l.D$)(()=>{},["prevent"]))},[(0,o.Lk)("div",h,[(0,o.Lk)("div",p,[S.firstLogin?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(W,{key:0,ref:"username",value:S.username,"onUpdate:value":t[1]||(t[1]=e=>S.username=e),valueModifiers:{trim:!0},"data-testid":"local-login-username",label:e.t("login.username"),autocomplete:"username"},null,8,["value","label"]))]),t[21]||(t[21]=(0,o.eW)()),(0,o.Lk)("div",m,[(0,o.bF)(x,{ref:"password",value:S.password,"onUpdate:value":t[2]||(t[2]=e=>S.password=e),"data-testid":"local-login-password",label:e.t("login.password"),autocomplete:"current-password"},null,8,["value","label"])])]),t[23]||(t[23]=(0,o.eW)()),(0,o.Lk)("div",v,[(0,o.Lk)("div",b,[(0,o.bF)(N,{id:"submit","data-testid":"login-submit",type:"submit","action-label":e.t("login.loginWithLocal"),"waiting-label":e.t("login.loggingIn"),"success-label":e.t("login.loggedIn"),"error-label":e.t("asyncButton.default.error"),onClick:$.loginLocal},null,8,["action-label","waiting-label","success-label","error-label","onClick"]),t[22]||(t[22]=(0,o.eW)()),S.firstLogin?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",L,[(0,o.bF)(T,{value:S.remember,"onUpdate:value":t[3]||(t[3]=e=>S.remember=e),label:e.t("login.remember.label"),type:"checkbox"},null,8,["value","label"])]))])])],34)):(0,o.Q3)("",!0),t[24]||(t[24]=(0,o.eW)()),S.hasLocal&&!S.showLocal?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("a",{id:"login-useLocal","data-testid":"login-useLocal",role:"button",onClick:t[5]||(t[5]=(...e)=>$.toggleLocal&&$.toggleLocal(...e))},(0,a.v_)(e.t("login.useLocal")),1)])):(0,o.Q3)("",!0),t[25]||(t[25]=(0,o.eW)()),S.hasLocal&&S.showLocal&&S.providers.length?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("a",{role:"button",onClick:t[6]||(t[6]=(...e)=>$.toggleLocal&&$.toggleLocal(...e))},(0,a.v_)($.nonLocalPrompt),1)])):(0,o.Q3)("",!0)],64)):(0,o.Q3)("",!0),t[31]||(t[31]=(0,o.eW)()),S.showLocaleSelector&&e.hasMultipleLocales&&!$.isHarvester?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(R,{mode:"login"})])):(0,o.Q3)("",!0)]),t[32]||(t[32]=(0,o.eW)()),(0,o.bF)(A,{class:"col span-6 landscape","data-testid":"login-landscape__img","file-name":"login-landscape.svg",alt:e.t("login.landscapeAlt")},null,8,["alt"])])]))}var S=s(65843),$=s(26685),E=s(16372),C=s(72268),_=s(87132),I=s(64430),O=s(1974),W=s(64391),x=s(14492),N=s(46405),T=s(35800),R=s(21782),A=s(18561),P=s(14026),G=s(66278),M=s(50953),F=s(21324),X=s(55823),Q=s(95822),H=s(82943),B=s(10874),D=s(51229),U=s(57090),j=s(71883),q=s(95753);const J={name:"Login",components:{LabeledInput:E.o,AsyncButton:C.A,Checkbox:T.S,BrandImage:I.A,Banner:x.l,InfoBox:O.A,CopyCode:W.A,Password:R.A,LocaleSelector:_.A,Loading:U.A,TabTitle:q.A},data(){return{username:"",remember:!1,password:"",timedOut:this.$route.query[N.VP]===N.Qp,loggedOut:this.$route.query[N.gZ]===N.Qp,isSsoLogout:this.$route.query[N.r3]===N.Qp,isSlo:this.$route.query[N.kM]===N.Qp,err:this.$route.query.err,showLocaleSelector:!0,hasLocal:!1,showLocal:!1,providers:[],providerComponents:[],customLoginError:{},firstLogin:!1,vendor:(0,B.f7)()}},computed:{...(0,G.L8)(["isSingleProduct"]),...(0,G.L8)({t:"i18n/t",hasMultipleLocales:"i18n/hasMultipleLocales"}),loggedOutSuccessMsg(){return this.isSlo?this.t("login.loggedOutFromSlo"):this.isSsoLogout?this.t("login.loggedOutFromSso"):this.t("login.loggedOut")},isHarvester(){return this.isSingleProduct?.productName===j.T3},singleProvider(){return 1===this.providers.length?this.providers[0]:void 0},nonLocalPrompt(){if(this.singleProvider){const e=this.displayName(this.singleProvider);return this.t("login.useProvider",{provider:e})}return this.t("login.useNonLocal")},errorMessage(){return this.isSlo?this.err?.length?this.t("logout.error",{msg:this.err}):"":this.err===H.LOGIN_ERRORS.CLIENT_UNAUTHORIZED?this.t("login.clientError"):this.err===H.LOGIN_ERRORS.CLIENT||this.err===H.LOGIN_ERRORS.SERVER?this.t("login.error"):this.err===H.LOGIN_ERRORS.NONCE?this.t("login.invalidResponseError"):this.err===H.LOGIN_ERRORS.USER_UNAUTHORIZED?this.t("login.userUnauthorized"):this.err?.length?this.t("login.specificError",{msg:this.err}):""},errorToDisplay(){return"true"===this.customLoginError?.showMessage&&this.customLoginError?.message&&this.errorMessage?`${this.customLoginError.message} \n ${this.errorMessage}`:this.errorMessage?this.errorMessage:""},kubectlCmd(){return"kubectl get secret --namespace cattle-system bootstrap-secret -o go-template='{{.data.bootstrapPassword|base64decode}}{{\"\\n\"}}'"},hasLoginMessage(){return this.errorToDisplay||this.loggedOut||this.timedOut}},async fetch(){const e=this.$store.getters["cookies/get"]({key:$.HF,options:{parseJSON:!1}}),t=e||"";this.username=t,this.remember=!!t;const{firstLoginSetting:s}=await this.loadInitialSettings(),{value:o}=await this.$store.dispatch("management/find",{type:X.Mc.SETTING,id:Q.HG.BANNERS}),a=await this.$store.dispatch("auth/getAuthProviders"),l=(0,A.Ul)(a.map(e=>e.id),["id"]),i=l.includes("local"),r=i&&!!l.find(e=>"local"!==e);i&&(0,S.Gj)(l,"local"),this.vendor=(0,B.f7)(),this.providers=l,this.hasLocal=i,this.showLocal=!r||this.$route.query[N.G8]===N.Qp,this.customLoginError=JSON.parse(o).loginError,this.firstLogin="true"===s?.value,this.username=this.firstLogin?"admin":this.username,this.providerComponents=this.providers.map(e=>(0,M.IG)(this.$store.getters["type-map/importLogin"](P.configType[e]||e))),this.$nextTick(()=>{this.focusSomething()})},methods:{async loadInitialSettings(){let e,t,s;try{e=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.FIRST_LOGIN),t=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.PL),s=this.$store.getters["management/byId"](X.Mc.SETTING,Q.HG.BRAND)}catch(o){e=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.FIRST_LOGIN,opt:{url:`/v3/settings/${Q.HG.FIRST_LOGIN}`}}),t=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.PL,opt:{url:`/v3/settings/${Q.HG.PL}`}}),s=await this.$store.dispatch("rancher/find",{type:X.k$.SETTING,id:Q.HG.BRAND,opt:{url:`/v3/settings/${Q.HG.BRAND}`}})}return t.value?.length&&t.value!==(0,B.f7)()&&(0,B.xc)(t.value),s?.value?.length&&s.value!==(0,B.o7)()&&(0,B.aA)(s.value),{firstLoginSetting:e,plSetting:t,brand:s}},displayName(e){return this.t(`model.authConfig.provider.${e}`)},toggleLocal(){this.showLocal=!this.showLocal,this.$router.applyQuery({[N.G8]:N.Qp}),this.$nextTick(()=>{this.focusSomething()})},focusSomething(){if(!this.showLocal)return;let e;e=this.username?this.$refs.password:this.$refs.username,e?.focus&&(e.focus(),e.select&&e.select())},handleProviderError(e){this.err=e},async loginLocal(e){try{await this.$store.dispatch("auth/login",{provider:"local",body:{username:this.username,password:this.password}});const e=await this.$store.dispatch("rancher/findAll",{type:X.k$.USER,opt:{url:"/v3/users?me=true",load:F.lh}});if(e?.[0]&&this.$store.dispatch("auth/gotUser",e[0]),this.remember){const e={encode:e=>e,maxAge:31536e3,path:"/",sameSite:!0,secure:!0};this.$store.commit("cookies/set",{key:$.HF,value:this.username,options:e})}else this.$store.commit("cookies/remove",{key:$.HF});await(0,D.A)({app:this.$store.app,store:this.$store,$plugin:this.$store.$plugin}),this.firstLogin||e[0]?.mustChangePassword?(this.$store.dispatch("auth/setInitialPass",this.password),this.$router.push({name:"auth-setup"})):this.$router.push({name:"index"})}catch(t){this.err=t,this.timedOut=null,this.loggedOut=null,e(!1)}}}};s(13215);var K=s(66262);const Z=(0,K.A)(J,[["render",w],["__scopeId","data-v-39f0cc42"]]),z=Z},40085:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var o=s(31601),a=s.n(o),l=s(76314),i=s.n(l),r=s(5111),n=i()(a());n.i(r.A),n.push([e.id,".login[data-v-39f0cc42]{overflow:hidden;position:relative}.login .row[data-v-39f0cc42]{align-items:center}.login .landscape[data-v-39f0cc42]{height:100vh;margin:0;-o-object-fit:cover;object-fit:cover}.login .login-welcome[data-v-39f0cc42]{margin:0}.login .login-messages[data-v-39f0cc42]{display:flex;justify-content:center;align-items:center}.login .login-messages .banner[data-v-39f0cc42]{margin:5px}.login .login-messages h4[data-v-39f0cc42]{margin:0}.login .login-messages--hasContent[data-v-39f0cc42]{min-height:70px}.login .login-messages .banner[data-v-39f0cc42],.login .login-messages .text-error[data-v-39f0cc42]{max-width:80%}.login .first-login-message .banner[data-v-39f0cc42]{margin-bottom:0;border-left:0}.login .first-login-message .banner[data-v-39f0cc42]  code{font-size:12px;padding:0}.gutless[data-v-39f0cc42]{height:100vh}.gutless>.span-6[data-v-39f0cc42]{overflow-y:auto;display:flex;flex-direction:column;height:100%;place-content:center}.locale-selector[data-v-39f0cc42]{position:absolute;bottom:30px}",""]);const c=n},52128:(e,t,s)=>{var o=s(77122);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(99548).A;a("6301066e",o,!0,{sourceMap:!1,shadowMode:!1})},77122:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var o=s(31601),a=s.n(o),l=s(76314),i=s.n(l),r=s(5111),n=i()(a());n.i(r.A),n.push([e.id,".baseline{align-items:baseline}.locale-selector-btn{align-items:center;display:flex}",""]);const c=n},87132:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var o=s(20641),a=s(53751),l=s(90033);const i={key:0},r={key:1};function n(e,t,s,n,c,d){const u=(0,o.g2)("rc-dropdown-trigger"),g=(0,o.g2)("rc-dropdown-item"),h=(0,o.g2)("rc-dropdown"),p=(0,o.g2)("Select"),m=(0,o.gN)("t");return(0,o.uX)(),(0,o.CE)("div",null,["login"===s.mode?((0,o.uX)(),(0,o.CE)("div",i,[d.showLocale?((0,o.uX)(),(0,o.Wv)(h,{key:0,"aria-label":e.$attrs["aria-label"]||void 0,"aria-labelledby":e.$attrs["aria-labelledby"]||void 0,"aria-describedby":e.$attrs["aria-describedby"]||void 0},{dropdownCollection:(0,o.k6)(()=>[d.showNone?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(g,{key:0,onClick:t[0]||(t[0]=e=>d.switchLocale("none"))},null,512)),[[m,"locale.none"]]):(0,o.Q3)("",!0),t[3]||(t[3]=(0,o.eW)()),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.availableLocales,(e,t)=>((0,o.uX)(),(0,o.Wv)(g,{key:t,lang:t,onClick:(0,a.D$)(e=>d.switchLocale(t),["stop"])},{default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(e),1)]),_:2},1032,["lang","onClick"]))),128))]),default:(0,o.k6)(()=>[(0,o.bF)(u,{"data-testid":"locale-selector",link:"",class:"baseline locale-selector-btn","aria-label":e.t("locale.menu")},(0,o.eX)({default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(e.selectedLocaleLabel)+" ",1)]),_:2},[s.showIcon?{name:"after",fn:(0,o.k6)(()=>[t[2]||(t[2]=(0,o.Lk)("i",{class:"ml-5 icon icon-chevron-down"},null,-1))]),key:"0"}:void 0]),1032,["aria-label"]),t[4]||(t[4]=(0,o.eW)())]),_:1,__:[4]},8,["aria-label","aria-labelledby","aria-describedby"])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(p,{"aria-label":e.$attrs["aria-label"]||void 0,"aria-labelledby":e.$attrs["aria-labelledby"]||void 0,"aria-describedby":e.$attrs["aria-describedby"]||void 0,value:d.selectedOption,options:d.localesOptions,"is-lang-select":!0,"onUpdate:value":t[1]||(t[1]=e=>d.switchLocale(e))},null,8,["aria-label","aria-labelledby","aria-describedby","value","options"])]))])}var c=s(66278),d=s(89303),u=s(49214);const g={name:"LocaleSelector",components:{Select:d.A,RcDropdown:u.Jj,RcDropdownItem:u.s$,RcDropdownTrigger:u.Nq},props:{mode:{type:String,default:""},showIcon:{type:Boolean,default:!0}},data(){return{isLocaleSelectorOpen:!1}},computed:{...(0,c.L8)("i18n",["selectedLocaleLabel","availableLocales"]),localesOptions(){return Object.keys(this.availableLocales).map(e=>({label:this.t(`locale.${e}`),value:e}))},selectedOption(){return Object.keys(this.availableLocales)[Object.values(this.availableLocales).indexOf(this.selectedLocaleLabel)]},showLocale(){return this.availableLocales&&Object.keys(this.availableLocales).length>1||this.dev},showNone(){return!1}},methods:{openLocaleSelector(){this.isLocaleSelectorOpen=!0},closeLocaleSelector(){this.isLocaleSelectorOpen=!1},switchLocale(e){this.$store.dispatch("i18n/switchTo",e),this.closeLocaleSelector()}}};s(52128);var h=s(66262);const p=(0,h.A)(g,[["render",n]]),m=p}}]);
//# sourceMappingURL=19.c47a9f67.js.map