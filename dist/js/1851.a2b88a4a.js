(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[152,823,1851,3145],{3204:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(20641),a=s(90033);function n(e,t,s,n,o,i){const l=(0,r.g2)("router-link"),c=(0,r.g2)("PaginatedResourceTable");return o.schema?((0,r.uX)(),(0,r.Wv)(c,{key:0,schema:o.schema,headers:o.eventHeaders,"pagination-headers":o.paginationHeaders,"key-field":"id",search:!1,"table-actions":!1,"row-actions":!1,groupable:!1,"rows-per-page":10},{"header-right":(0,r.k6)(()=>[(0,r.bF)(l,{"data-testid":"events-link",to:o.allEventsLink,class:"events-link"},{default:(0,r.k6)(()=>[(0,r.Lk)("span",null,(0,a.v_)(e.t("glance.eventsTable")),1)]),_:1},8,["to"])]),_:1},8,["schema","headers","pagination-headers"])):(0,r.Q3)("",!0)}var o=s(31645),i=s(55823),l=s(69883),c=s(92098),u=s(14584),d=s(18727);const p={...o.rh,canBeVariable:!0,width:130},h=[p,o.qv,o.w5,o.o_,{name:"date",label:"Date",labelKey:"clusterIndexPage.sections.events.date.label",value:"timestamp",sort:"timestamp:desc",formatter:"Date",width:220,defaultSort:!0}],g={components:{PaginatedResourceTable:l.A},data(){return{schema:null,events:[],eventHeaders:h,paginationHeaders:null,allEventsLink:{name:"c-cluster-product-resource",params:{product:d.NAME,resource:i.ll}}}},beforeMount(){const e=this.$store.getters["cluster/schemaFor"](i.ll),t=e?[p,c.Jv,o.w5,{...c.l3,defaultSort:!1},c.IZ,c.ke,(0,u.UQ)("Count",e,this.$store.getters,!0)]:[];this.schema=e,this.paginationHeaders=t},mounted(){this.dismissRouteHandler=this.$router.beforeEach(this.onRouteChange)},methods:{async onRouteChange(e,t,s){this.$route.name!==e.name&&await this.$store.dispatch("cluster/forgetType",i.ll),s()}},beforeUnmount(){this.dismissRouteHandler()}};s(71292);var v=s(66262);const m=(0,v.A)(g,[["render",n],["__scopeId","data-v-6a2f0f0a"]]),f=m},9280:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>f,xS:()=>h});var r=s(20641),a=s(90033);const n={class:"warnings"},o={key:0,class:"warn-count mb-10 chip"},i={key:1,class:"error-count chip"};function l(e,t,s,l,c,u){const d=(0,r.g2)("SimpleBox");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.bF)(d,{class:(0,a.C4)(["container",{"has-link":!!u.location}]),onClick:u.goToResource},{default:(0,r.k6)(()=>[(0,r.Lk)("h1",null,(0,a.v_)(u.resourceCounts.total),1),t[1]||(t[1]=(0,r.eW)()),(0,r.Lk)("h3",null,(0,a.v_)(u.name),1),t[2]||(t[2]=(0,r.eW)()),(0,r.Lk)("div",n,[u.resourceCounts.warningCount?((0,r.uX)(),(0,r.CE)("div",o,(0,a.v_)(u.resourceCounts.warningCount),1)):(0,r.Q3)("",!0),t[0]||(t[0]=(0,r.eW)()),u.resourceCounts.errorCount?((0,r.uX)(),(0,r.CE)("div",i,(0,a.v_)(u.resourceCounts.errorCount),1)):(0,r.Q3)("",!0)])]),_:1,__:[1,2]},8,["class","onClick"])])}var c=s(69953),u=s(55823),d=s(33852);function p(e){switch(e){case"text-success":case"text-info":return"useful";case"text-warning":return"warningCount";default:return"errorCount"}}function h(e,t){const s=e.getters["currentStore"](u.i2),r=e.getters[`${s}/all`](u.i2)?.[0]?.counts,a=r?.[t]?.summary||{},n={total:a.count||0,useful:a.count||0,warningCount:0,errorCount:0};return Object.entries(a.states||{}).forEach(e=>{const t=(0,d.uU)(e[0]),s=e[1],r=p(t);n["useful"]-=s,n[r]+=s}),n}const g={components:{SimpleBox:c.A},props:{resource:{type:String,default:""},spoofedCounts:{type:Object,default:null},cluster:{type:String,default:null}},computed:{resourceCounts(){return this.spoofedCounts?this.spoofedCounts:h(this.$store,this.resource)},location(){if(this.spoofedCounts)return this.spoofedCounts.location;const e={name:"c-cluster-product-resource",params:{product:this.$store.getters["currentProduct"].name,resource:this.resource}};return this.cluster&&(e.params.cluster=this.cluster),e},name(){if(this.spoofedCounts)return this.spoofedCounts.name;const e=this.$store.getters["currentStore"](this.resource),t=this.$store.getters[`${e}/schemaFor`](this.resource);return this.$store.getters["type-map/labelFor"](t,this.resourceCounts.useful)}},methods:{goToResource(){this.location&&this.$router.push(this.location)}}};s(61561);var v=s(66262);const m=(0,v.A)(g,[["render",l],["__scopeId","data-v-39c6e929"]]),f=m},11396:(e,t,s)=>{var r=s(31285);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("5da7c3ae",r,!0,{sourceMap:!1,shadowMode:!1})},18110:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".banner[data-v-6132b05d]{display:flex;justify-content:space-evenly;align-items:center}.banner .datum[data-v-6132b05d]{text-align:center;margin-right:5px}.banner[data-v-6132b05d]  label{color:var(--info)}",""]);const c=l},18156:(e,t,s)=>{var r=s(48906);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("85f5aed6",r,!0,{sourceMap:!1,shadowMode:!1})},29703:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".has-link[data-v-39c6e929]{cursor:pointer}.has-link[data-v-39c6e929]:hover{border-color:var(--link)}[data-v-39c6e929]  .content{display:flex;justify-content:space-between;align-items:center}[data-v-39c6e929]  .content H1,[data-v-39c6e929]  .content H3{margin:0}[data-v-39c6e929]  .content .chip{border-radius:2em;color:var(--body-bg);padding:0 1em}[data-v-39c6e929]  .content .chip.warn-count{background:var(--warning)}[data-v-39c6e929]  .content .chip.error-count{background:var(--error)}",""]);const c=l},31285:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".hardware-resource-gauge[data-v-0e4e8f37]{position:relative;display:flex;flex-direction:column}.hardware-resource-gauge .hw-gauge[data-v-0e4e8f37]:not(:first-of-type){margin-top:20px}.hardware-resource-gauge .values[data-v-0e4e8f37]{font-size:12px;padding-left:10px}",""]);const c=l},37462:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".events-link[data-v-6a2f0f0a]{align-self:center;padding-right:20px;white-space:nowrap}",""]);const c=l},48906:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".extension-card-container[data-v-096fe2b1]{display:grid;grid-template-columns:repeat(auto-fit,minmax(calc(33.33333% - 40px),1fr));grid-column-gap:15px;grid-row-gap:20px}.harvester-cluster-link[data-v-096fe2b1]{line-height:inherit;min-height:inherit;padding:0;vertical-align:bottom}@media only screen and (max-width:992px){.extension-card-container[data-v-096fe2b1]{grid-template-columns:1fr!important}}.cluster-dashboard-glance[data-v-096fe2b1]{align-items:center;border-top:1px solid var(--border);border-bottom:1px solid var(--border);padding:10px 0;display:flex}.cluster-dashboard-glance[data-v-096fe2b1]>:not(:nth-last-child(-n+2)){margin-right:40px}.cluster-dashboard-glance>:not(:nth-last-child(-n+2)) SPAN[data-v-096fe2b1]{font-weight:700}.title h1[data-v-096fe2b1]{margin:0}.title .cluster-dashboard-description[data-v-096fe2b1]{margin:5px 0;opacity:.7}.actions-span[data-v-096fe2b1]{align-self:center}.events[data-v-096fe2b1]{margin-top:30px}.graph-options[data-v-096fe2b1]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.etcd-metrics[data-v-096fe2b1]  .external-link{top:-107px}.cluster-tools-tip[data-v-096fe2b1]{margin-top:0}.cluster-tools-link[data-v-096fe2b1]{display:flex;margin-right:10px}.cluster-tools-link>I[data-v-096fe2b1]{line-height:inherit;margin-right:4px}.cert-table-link[data-v-096fe2b1]{display:flex;justify-content:flex-end;margin-bottom:20px}.k8s-service-status[data-v-096fe2b1]{align-items:center;display:inline-flex;border:1px solid;border-color:var(--border);margin-top:20px}.k8s-service-status .label[data-v-096fe2b1]{border-left:1px solid var(--border)}.k8s-service-status[data-v-096fe2b1]:not(:last-child){margin-right:20px}.k8s-service-status>div[data-v-096fe2b1]{padding:5px 20px}.k8s-service-status>I[data-v-096fe2b1]{text-align:center;padding:5px 10px}.k8s-service-status.unhealthy[data-v-096fe2b1]{border-color:var(--error-border);cursor:pointer}.k8s-service-status.unhealthy>I[data-v-096fe2b1]{color:var(--error)}.k8s-service-status.warning[data-v-096fe2b1]{cursor:pointer}.k8s-service-status.warning>I[data-v-096fe2b1]{color:var(--warning)}.k8s-service-status.healthy>I[data-v-096fe2b1]{color:var(--success)}.k8s-service-status.off[data-v-096fe2b1]{display:none}",""]);const c=l},49104:(e,t,s)=>{var r=s(18110);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("2a2d7180",r,!0,{sourceMap:!1,shadowMode:!1})},58824:(e,t,s)=>{var r=s(59610);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("211cbeb7",r,!0,{sourceMap:!1,shadowMode:!1})},59610:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".top[data-v-48821e48]{display:flex;position:relative}.top>h2[data-v-48821e48]{flex:1}.close-button[data-v-48821e48]{cursor:pointer;display:flex;align-items:center;justify-content:center;padding:2px}.close-button>i[data-v-48821e48]{font-size:14px;opacity:.5}.close-button[data-v-48821e48]:hover{background-color:var(--wm-closer-hover-bg)}",""]);const c=l},61561:(e,t,s)=>{var r=s(29703);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("3e751f92",r,!0,{sourceMap:!1,shadowMode:!1})},63447:(e,t,s)=>{var r=s(85929);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("9921c832",r,!0,{sourceMap:!1,shadowMode:!1})},69953:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var r=s(20641),a=s(90033);const n={key:0,class:"simple-box","data-testid":"simple-box-container"},o={key:0,class:"top"},i={key:0,"data-testid":"simple-box-title"},l={class:"content"};function c(e,t,s,c,u,d){return e.shown?((0,r.uX)(),(0,r.CE)("div",n,[s.title||s.canClose||e.$slots.title?((0,r.uX)(),(0,r.CE)("div",o,[(0,r.RG)(e.$slots,"title",{},()=>[s.title?((0,r.uX)(),(0,r.CE)("h2",i,(0,a.v_)(s.title),1)):(0,r.Q3)("",!0)],!0),t[2]||(t[2]=(0,r.eW)()),s.canClose||e.pref?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"close-button","data-testid":"simple-box-close",onClick:t[0]||(t[0]=e=>d.closeBox(e))},t[1]||(t[1]=[(0,r.Lk)("i",{class:"icon icon-close"},null,-1)]))):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),t[3]||(t[3]=(0,r.eW)()),(0,r.Lk)("div",l,[(0,r.RG)(e.$slots,"default",{},void 0,!0)])])):(0,r.Q3)("",!0)}var u=s(83714);const d={name:"SimpleBox",emits:["close"],mixins:[u.A],props:{title:{type:String,default:null},canClose:{type:Boolean,default:!1}},methods:{closeBox(e){this.hide(),this.$emit("close",e)}}};s(58824),s(85898);var p=s(66262);const h=(0,p.A)(d,[["render",c],["__scopeId","data-v-48821e48"]]),g=h},71292:(e,t,s)=>{var r=s(37462);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("c5a0ba74",r,!0,{sourceMap:!1,shadowMode:!1})},71851:(e,t,s)=>{"use strict";s.r(t),s.d(t,{RESOURCES:()=>Ie,default:()=>Oe});var r=s(20641),a=s(90033);const n={class:"dashboard"},o={class:"title"},i={key:0,class:"cluster-dashboard-description"},l={class:"cluster-dashboard-glance"},c={"data-testid":"clusterProvider__label"},u={key:0},d=["aria-label"],p={key:1},h={"data-testid":"kubernetesVersion__label"},g={key:0,style:{"font-size":"0.75em"}},v={key:0,"data-testid":"architecture__label"},m={"data-testid":"created__label"},f={key:1},b={class:"resource-gauges"},y={key:0,class:"extension-card-container mt-20"},C={key:1,class:"mt-40"},k={key:2,class:"hardware-resource-gauges"},x={key:3},_=["data-testid","onClick"],A={class:"label"},E={class:"mt-30"},w={class:"cert-table-link"};function S(e,t,s,S,L,T){const R=(0,r.g2)("TabTitle"),M=(0,r.g2)("LiveDate"),W=(0,r.g2)("router-link"),I=(0,r.g2)("ConfigBadge"),$=(0,r.g2)("ResourceSummary"),D=(0,r.g2)("SimpleBox"),P=(0,r.g2)("HardwareResourceGauge"),U=(0,r.g2)("EventsTable"),X=(0,r.g2)("Tab"),N=(0,r.g2)("AlertTable"),B=(0,r.g2)("Certificates"),H=(0,r.g2)("Tabbed"),Q=(0,r.g2)("DashboardMetrics"),F=(0,r.g2)("EtcdInfoBanner"),j=(0,r.gN)("clean-tooltip");return(0,r.uX)(),(0,r.CE)("section",n,[(0,r.Lk)("header",null,[(0,r.Lk)("div",o,[(0,r.Lk)("h1",null,[(0,r.bF)(R,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,a.v_)(e.t("clusterIndexPage.header")),1)]),_:1})]),t[1]||(t[1]=(0,r.eW)()),T.hasDescription?((0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("span",null,(0,a.v_)(e.currentCluster.spec.description),1)])):(0,r.Q3)("",!0)])]),t[25]||(t[25]=(0,r.eW)()),(0,r.Lk)("div",l,[(0,r.Lk)("div",c,[(0,r.Lk)("label",null,(0,a.v_)(e.t("glance.provider"))+": ",1),t[2]||(t[2]=(0,r.eW)()),T.isHarvesterCluster?((0,r.uX)(),(0,r.CE)("span",u,[(0,r.Lk)("button",{class:"btn role-link harvester-cluster-link",role:"button","aria-label":T.displayProvider,onClick:t[0]||(t[0]=(...e)=>T.goToHarvesterCluster&&T.goToHarvesterCluster(...e))},(0,a.v_)(T.displayProvider),9,d)])):((0,r.uX)(),(0,r.CE)("span",p,(0,a.v_)(T.displayProvider),1))]),t[7]||(t[7]=(0,r.eW)()),(0,r.Lk)("div",h,[(0,r.Lk)("label",null,(0,a.v_)(e.t("glance.version"))+": ",1),t[3]||(t[3]=(0,r.eW)()),(0,r.Lk)("span",null,(0,a.v_)(e.currentCluster.kubernetesVersionBase),1),t[4]||(t[4]=(0,r.eW)()),e.currentCluster.kubernetesVersionExtension?((0,r.uX)(),(0,r.CE)("span",g,(0,a.v_)(e.currentCluster.kubernetesVersionExtension),1)):(0,r.Q3)("",!0)]),t[8]||(t[8]=(0,r.eW)()),T.hasNodes?((0,r.uX)(),(0,r.CE)("div",v,[(0,r.Lk)("label",null,(0,a.v_)(e.t("glance.architecture"))+": ",1),t[5]||(t[5]=(0,r.eW)()),(0,r.bo)(((0,r.uX)(),(0,r.CE)("span",null,[(0,r.eW)((0,a.v_)(T.architecture.label),1)])),[[j,T.architecture.tooltip]])])):(0,r.Q3)("",!0),t[9]||(t[9]=(0,r.eW)()),(0,r.Lk)("div",m,[(0,r.Lk)("label",null,(0,a.v_)(e.t("glance.created"))+": ",1),t[6]||(t[6]=(0,r.eW)()),(0,r.Lk)("span",null,[(0,r.bF)(M,{value:e.currentCluster.metadata.creationTimestamp,"add-suffix":!0,"show-tooltip":!0},null,8,["value"])])]),t[10]||(t[10]=(0,r.eW)()),t[11]||(t[11]=(0,r.Lk)("div",{style:{flex:1}},null,-1)),t[12]||(t[12]=(0,r.eW)()),T.showClusterTools?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.bF)(W,{to:{name:"c-cluster-explorer-tools"},class:"cluster-tools-link",role:"link","aria-label":e.t("nav.clusterTools")},{default:(0,r.k6)(()=>[(0,r.Lk)("span",null,(0,a.v_)(e.t("nav.clusterTools")),1)]),_:1},8,["aria-label"])])):(0,r.Q3)("",!0),t[13]||(t[13]=(0,r.eW)()),e.currentCluster.canUpdate?((0,r.uX)(),(0,r.Wv)(I,{key:2,cluster:e.currentCluster},null,8,["cluster"])):(0,r.Q3)("",!0)]),t[26]||(t[26]=(0,r.eW)()),(0,r.Lk)("div",b,[(0,r.bF)($,{"spoofed-counts":T.totalCountGaugeInput},null,8,["spoofed-counts"]),t[14]||(t[14]=(0,r.eW)()),T.canAccessNodes?((0,r.uX)(),(0,r.Wv)($,{key:0,resource:"node"})):(0,r.Q3)("",!0),t[15]||(t[15]=(0,r.eW)()),T.canAccessDeployments?((0,r.uX)(),(0,r.Wv)($,{key:1,resource:"apps.deployment"})):(0,r.Q3)("",!0)]),t[27]||(t[27]=(0,r.eW)()),L.extensionCards.length?((0,r.uX)(),(0,r.CE)("div",y,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(L.extensionCards,(s,n)=>((0,r.uX)(),(0,r.Wv)(D,{key:`extensionCards${n}`,class:"extension-card",style:(0,a.Tr)(s.style)},{default:(0,r.k6)(()=>[(0,r.Lk)("h3",null,(0,a.v_)(s.label),1),t[16]||(t[16]=(0,r.eW)()),((0,r.uX)(),(0,r.Wv)((0,r.$y)(s.component),{resource:e.currentCluster},null,8,["resource"]))]),_:2,__:[16]},1032,["style"]))),128))])):(0,r.Q3)("",!0),t[28]||(t[28]=(0,r.eW)()),T.hasStats?((0,r.uX)(),(0,r.CE)("h3",C,(0,a.v_)(e.t("clusterIndexPage.sections.capacity.label")),1)):(0,r.Q3)("",!0),t[29]||(t[29]=(0,r.eW)()),T.hasStats?((0,r.uX)(),(0,r.CE)("div",k,[(0,r.bF)(P,{name:e.t("clusterIndexPage.hardwareResourceGauge.pods"),used:T.podsUsed},null,8,["name","used"]),t[17]||(t[17]=(0,r.eW)()),(0,r.bF)(P,{name:e.t("clusterIndexPage.hardwareResourceGauge.cores"),reserved:T.cpuReserved,used:T.cpuUsed,units:T.cpuReserved.units},null,8,["name","reserved","used","units"]),t[18]||(t[18]=(0,r.eW)()),(0,r.bF)(P,{name:e.t("clusterIndexPage.hardwareResourceGauge.ram"),reserved:T.ramReserved,used:T.ramUsed,units:T.ramReserved.units},null,8,["name","reserved","used","units"])])):(0,r.Q3)("",!0),t[30]||(t[30]=(0,r.eW)()),T.clusterServices?((0,r.uX)(),(0,r.CE)("div",x,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(T.clusterServices,(s,n)=>(0,r.bo)(((0,r.uX)(),(0,r.CE)("div",{key:n,class:(0,a.C4)(["k8s-service-status",{[s.status]:!0}]),"data-testid":`k8s-service-${s.name}`,onClick:s.goTo},[(0,r.Lk)("i",{class:(0,a.C4)(["icon",s.icon])},null,2),t[19]||(t[19]=(0,r.eW)()),(0,r.Lk)("div",A,(0,a.v_)(e.t(s.labelKey)),1)],10,_)),[[j,s.tooltip]])),128))])):(0,r.Q3)("",!0),t[31]||(t[31]=(0,r.eW)()),(0,r.Lk)("div",E,[(0,r.bF)(H,{onChanged:T.tabChange},{default:(0,r.k6)(()=>[L.canViewEvents?((0,r.uX)(),(0,r.Wv)(X,{key:0,name:"cluster-events",label:e.t("clusterIndexPage.sections.events.label"),weight:2},{default:(0,r.k6)(()=>[(0,r.bF)(U)]),_:1},8,["label"])):(0,r.Q3)("",!0),t[21]||(t[21]=(0,r.eW)()),T.hasMonitoring?((0,r.uX)(),(0,r.Wv)(X,{key:1,name:"cluster-alerts",label:e.t("clusterIndexPage.sections.alerts.label"),weight:1},{default:(0,r.k6)(()=>["cluster-alerts"===L.selectedTab?((0,r.uX)(),(0,r.Wv)(N,{key:0})):(0,r.Q3)("",!0)]),_:1},8,["label"])):(0,r.Q3)("",!0),t[22]||(t[22]=(0,r.eW)()),(0,r.bF)(X,{name:"cluster-certs",label:e.t("clusterIndexPage.sections.certs.label"),weight:1},{default:(0,r.k6)(()=>[(0,r.Lk)("span",w,[(0,r.bF)(W,{to:T.allSecretsLink},{default:(0,r.k6)(()=>[(0,r.Lk)("span",null,(0,a.v_)(e.t("glance.secretsTable")),1)]),_:1},8,["to"])]),t[20]||(t[20]=(0,r.eW)()),"cluster-certs"===L.selectedTab?((0,r.uX)(),(0,r.Wv)(B,{key:0})):(0,r.Q3)("",!0)]),_:1,__:[20]},8,["label"])]),_:1,__:[21,22]},8,["onChanged"])]),t[32]||(t[32]=(0,r.eW)()),T.hasMetricsTabs?((0,r.uX)(),(0,r.Wv)(H,{key:4,"default-tab":"cluster-metrics","use-hash":!1,class:"mt-30"},{default:(0,r.k6)(()=>[L.showClusterMetrics?((0,r.uX)(),(0,r.Wv)(X,{key:0,name:"cluster-metrics",label:e.t("clusterIndexPage.sections.clusterMetrics.label"),weight:2},{default:(0,r.k6)(e=>[e.active?((0,r.uX)(),(0,r.Wv)(Q,{key:0,"detail-url":L.CLUSTER_METRICS_DETAIL_URL,"summary-url":L.CLUSTER_METRICS_SUMMARY_URL,"graph-height":"875px"},null,8,["detail-url","summary-url"])):(0,r.Q3)("",!0)]),_:1},8,["label"])):(0,r.Q3)("",!0),t[23]||(t[23]=(0,r.eW)()),L.showK8sMetrics?((0,r.uX)(),(0,r.Wv)(X,{key:1,name:"k8s-metrics",label:e.t("clusterIndexPage.sections.k8sMetrics.label"),weight:1},{default:(0,r.k6)(e=>[e.active?((0,r.uX)(),(0,r.Wv)(Q,{key:0,"detail-url":L.K8S_METRICS_DETAIL_URL,"summary-url":L.K8S_METRICS_SUMMARY_URL,"graph-height":"600px"},null,8,["detail-url","summary-url"])):(0,r.Q3)("",!0)]),_:1},8,["label"])):(0,r.Q3)("",!0),t[24]||(t[24]=(0,r.eW)()),L.showEtcdMetrics?((0,r.uX)(),(0,r.Wv)(X,{key:2,name:"etcd-metrics",label:e.t("clusterIndexPage.sections.etcdMetrics.label"),weight:0},{default:(0,r.k6)(e=>[e.active?((0,r.uX)(),(0,r.Wv)(Q,{key:0,class:"etcd-metrics","detail-url":L.ETCD_METRICS_DETAIL_URL,"summary-url":L.ETCD_METRICS_SUMMARY_URL,"graph-height":"600px"},{default:(0,r.k6)(()=>[(0,r.bF)(F)]),_:1},8,["detail-url","summary-url"])):(0,r.Q3)("",!0)]),_:1},8,["label"])):(0,r.Q3)("",!0)]),_:1,__:[23,24]})):(0,r.Q3)("",!0)])}var L=s(19506),T=s(66278),R=s(55823),M=s(96676),W=s(47170),I=s(87246),$=s(14492),D=s(13970),P=s(31645),U=s(4055),X=s(24935),N=s(98642),B=s(86485);const H={class:"datum"},Q={class:"datum"},F={class:"datum"};function j(e,t,s,n,o,i){const l=(0,r.g2)("Loading"),c=(0,r.g2)("Banner");return e.$fetchState.pending?((0,r.uX)(),(0,r.Wv)(l,{key:0})):((0,r.uX)(),(0,r.Wv)(c,{key:1,class:"banner",color:"info"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",H,[(0,r.Lk)("label",null,(0,a.v_)(e.t("etcdInfoBanner.hasLeader")),1),(0,r.eW)(" "+(0,a.v_)(o.hasLeader)+",\r\n    ",1)]),t[0]||(t[0]=(0,r.eW)()),(0,r.Lk)("div",Q,[(0,r.Lk)("label",null,(0,a.v_)(e.t("etcdInfoBanner.leaderChanges")),1),(0,r.eW)(" "+(0,a.v_)(o.leaderChanges)+",\r\n    ",1)]),t[1]||(t[1]=(0,r.eW)()),(0,r.Lk)("div",F,[(0,r.Lk)("label",null,(0,a.v_)(e.t("etcdInfoBanner.failedProposals")),1),(0,r.eW)(" "+(0,a.v_)(o.failedProposals),1)])]),_:1,__:[0,1]}))}var O=s(57090);const G={components:{Banner:$.l,Loading:O.A},async fetch(){const e=this.$store.getters["currentProduct"].inStore;let t="";if(this.$store.getters[`${e}/canList`](R.W8.APP))try{const s=await this.$store.dispatch(`${e}/find`,{type:R.W8.APP,id:"cattle-monitoring-system/rancher-monitoring"});t=s?.currentVersion}catch(r){}const s=await(0,B.CT)(t,this.$store.dispatch,this.currentCluster.id);this.hasLeader=s?"Yes":"No",this.leaderChanges=await(0,B.Hv)(t,this.$store.dispatch,this.currentCluster.id),this.failedProposals=await(0,B.zG)(t,this.$store.dispatch,this.currentCluster.id)},data(){return{hasLeader:"No",leaderChanges:0,failedProposals:0}},computed:{...(0,T.L8)(["currentCluster"])}};s(49104);var K=s(66262);const Y=(0,K.A)(G,[["render",j],["__scopeId","data-v-6132b05d"]]),V=Y;var q=s(23371),z=s(9280);const J={class:"chart"},Z={key:0,class:"hw-gauge"},ee={class:"values text-muted"},te={key:0},se={key:1},re={key:2},ae={key:3},ne={key:1,class:"hw-gauge"},oe={class:"values text-muted"},ie={key:0},le={key:1},ce={key:2},ue={key:3};function de(e,t,s,n,o,i){const l=(0,r.g2)("ConsumptionGauge"),c=(0,r.g2)("SimpleBox");return(0,r.uX)(),(0,r.Wv)(c,{class:"hardware-resource-gauge"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",J,[(0,r.Lk)("h3",null,(0,a.v_)(s.name),1),t[4]||(t[4]=(0,r.eW)()),!s.reserved||void 0===s.reserved.total&&void 0===s.reserved.useful?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",Z,[(0,r.bF)(l,{capacity:s.reserved.total,used:s.reserved.useful,"color-stops":i.colorStops},{title:(0,r.k6)(()=>[(0,r.Lk)("span",null,[(0,r.eW)((0,a.v_)(s.reservedTitle??e.t("clusterIndexPage.hardwareResourceGauge.reserved"))+" ",1),(0,r.Lk)("span",ee,[s.reserved.formattedUseful?((0,r.uX)(),(0,r.CE)("span",te,(0,a.v_)(s.reserved.formattedUseful),1)):((0,r.uX)(),(0,r.CE)("span",se,(0,a.v_)(i.maxDecimalPlaces(s.reserved.useful)),1)),t[0]||(t[0]=(0,r.eW)("\n                /\n                ",-1)),s.reserved.formattedTotal?((0,r.uX)(),(0,r.CE)("span",re,(0,a.v_)(s.reserved.formattedTotal),1)):((0,r.uX)(),(0,r.CE)("span",ae,(0,a.v_)(i.maxDecimalPlaces(s.reserved.total))+" "+(0,a.v_)(s.reserved.units),1))])]),t[1]||(t[1]=(0,r.eW)()),(0,r.Lk)("span",null,(0,a.v_)(i.percentage(s.reserved)),1)]),_:1},8,["capacity","used","color-stops"])])),t[5]||(t[5]=(0,r.eW)()),s.used&&void 0!==s.used.useful?((0,r.uX)(),(0,r.CE)("div",ne,[(0,r.bF)(l,{capacity:s.used.total,used:s.used.useful,"color-stops":i.colorStops},{title:(0,r.k6)(()=>[(0,r.Lk)("span",null,[(0,r.eW)((0,a.v_)(s.usedTitle??e.t("clusterIndexPage.hardwareResourceGauge.used"))+" ",1),(0,r.Lk)("span",oe,[s.used.formattedUseful?((0,r.uX)(),(0,r.CE)("span",ie,(0,a.v_)(s.used.formattedUseful),1)):((0,r.uX)(),(0,r.CE)("span",le,(0,a.v_)(i.maxDecimalPlaces(s.used.useful)),1)),t[2]||(t[2]=(0,r.eW)("\n                /\n                ",-1)),s.used.formattedTotal?((0,r.uX)(),(0,r.CE)("span",ce,(0,a.v_)(s.used.formattedTotal),1)):((0,r.uX)(),(0,r.CE)("span",ue,(0,a.v_)(i.maxDecimalPlaces(s.used.total))+" "+(0,a.v_)(s.used.units),1))])]),t[3]||(t[3]=(0,r.eW)()),(0,r.Lk)("span",null,(0,a.v_)(i.percentage(s.used)),1)]),_:1},8,["capacity","used","color-stops"])])):(0,r.Q3)("",!0)])]),_:1})}var pe=s(59930),he=s(69953);const ge={components:{ConsumptionGauge:pe.A,SimpleBox:he.A},props:{name:{type:String,required:!0},units:{type:String,default:""},used:{type:Object,default:null},usedTitle:{type:String,default:null},reserved:{type:Object,default:null},reservedTitle:{type:String,default:null}},computed:{colorStops(){return{0:"--success",30:"--warning",70:"--error"}}},methods:{maxDecimalPlaces(e){return Math.round(100*e)/100},strokes(e,t){return{primaryStrokeColor:this.rgba(e,1),primaryStrokeGradientColor:this.rgba(t,1),secondaryStrokeColor:this.rgba(e,.1),secondaryStrokeGradientColor:this.rgba(t,.1)}},rgba(e,t){return`rgba(var(${e}), ${t})`},percentage(e){return 0===e.total?0:`${(e.useful/e.total*100).toFixed(2)}%`}}};s(11396);const ve=(0,K.A)(ge,[["render",de],["__scopeId","data-v-0e4e8f37"]]),me=ve;var fe=s(6826),be=s(80152),ye=s(3204),Ce=s(83145),ke=s(25803),xe=s(80731);function _e(e,t,s,a,n,o){const i=(0,r.g2)("Banner"),l=(0,r.g2)("BadgeState"),c=(0,r.g2)("ResourceTable");return(0,r.uX)(),(0,r.CE)("div",null,[e.expiredData.expiring?((0,r.uX)(),(0,r.Wv)(i,{key:0,"data-testid":"cert-expiring-banner",color:"warning",label:e.expiredData.expiring},null,8,["label"])):(0,r.Q3)("",!0),t[0]||(t[0]=(0,r.eW)()),e.expiredData.expired?((0,r.uX)(),(0,r.Wv)(i,{key:1,color:"error",label:e.expiredData.expired},null,8,["label"])):(0,r.Q3)("",!0),t[1]||(t[1]=(0,r.eW)()),(0,r.bF)(c,{loading:e.$fetchState.pending,schema:e.schema,headers:e.headers,rows:e.certs,"paging-label":"secret.certificate.paging","paging-params":e.pagingParams,"ignore-filter":!0,"hide-manual-refresh-button":!0},{"col:certState":(0,r.k6)(({row:e})=>[(0,r.Lk)("td",null,[(0,r.bF)(l,{color:e.certStateBackground,label:e.certStateDisplay},null,8,["color","label"])])]),_:1},8,["loading","schema","headers","rows","paging-params"])])}var Ae=s(56935),Ee=s(15860),we=s(33852),Se=s(68138);const Le=(0,r.pM)({components:{ResourceTable:Ae.A,Banner:$.l,BadgeState:Se.j},async fetch(){this.$store.dispatch("cluster/forgetType",R.bB),this.certs=await this.$store.dispatch("cluster/findAll",{type:R.bB,opt:{watch:!1,filter:{"metadata.fields.1":Ee.TYPES.TLS}}})},data(){return{schema:this.$store.getters["cluster/schemaFor"](R.bB),headers:[{...P.c4,formatter:null,name:"certState",sort:["certState","nameSort"],value:"certState"},P.o_,P.CU,{name:"cn",labelKey:"secret.certificate.cn",value:e=>{if(e.cn)return e.cn+(e.unrepeatedSans.length?` ${this.t("secret.certificate.plusMore",{n:e.unrepeatedSans.length})}`:"")},sort:["cn"],search:["cn"]},{name:"cert-expires2",labelKey:"secret.certificate.expiresDuration",value:e=>e.timeTilExpirationDate,formatter:"LiveDate",sort:["timeTilExpiration"],search:["timeTilExpiration"],defaultSort:!0,width:100},{name:"cert-expires",labelKey:"secret.certificate.expiresOn",value:"cachedCertInfo.notAfter",formatter:"Date",sort:["cachedCertInfo.notAfter"],search:["cachedCertInfo.notAfter"]},{name:"cert-lifetime",labelKey:"secret.certificate.lifetime",value:e=>e.certLifetime,sort:["certLifetime"],search:["certLifetime"]},P.K],certs:[],pagingParams:{pluralLabel:this.t("secret.certificate.certificates"),singularLabel:this.t("secret.certificate.certificate")}}},computed:{expiredData(){let e=0,t=0;for(let s=0;s<this.certs.length;s++){const r=this.certs[s];r.certState===we.jv.EXPIRING&&e++,r.certState===we.jv.EXPIRED&&t++}return{expiring:e?this.t("secret.certificate.warnings.expiring",{count:e}):"",expired:t?this.t("secret.certificate.warnings.expired",{count:t}):""}}},beforeUnmount(){this.$store.dispatch("cluster/forgetType",R.bB)}}),Te=(0,K.A)(Le,[["render",_e]]),Re=Te;var Me=s(18727),We=s(95753);const Ie=[R.CU,R.kf,R.PV,R.oU.DEPLOYMENT,R.oU.STATEFUL_SET,R.oU.JOB,R.oU.DAEMON_SET,R.YV],$e="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-cluster-nodes-1/rancher-cluster-nodes?orgId=1",De="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-cluster-1/rancher-cluster?orgId=1",Pe="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-k8s-components-nodes-1/rancher-kubernetes-components-nodes?orgId=1",Ue="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-k8s-components-1/rancher-kubernetes-components?orgId=1",Xe="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-etcd-nodes-1/rancher-etcd-nodes?orgId=1",Ne="/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-etcd-1/rancher-etcd?orgId=1",Be=["etcd","scheduler","controller-manager"],He=[P.c4,P.o_,P.gg],Qe={[we.jv.IN_PROGRESS]:"icon-spinner icon-spin",[we.jv.HEALTHY]:"icon-checkmark",[we.jv.WARNING]:"icon-warning",[we.jv.UNHEALTHY]:"icon-warning"},Fe={name:"ClusterExplorerIndexPage",components:{EtcdInfoBanner:V,DashboardMetrics:L.A,HardwareResourceGauge:me,ResourceSummary:z.Ay,Tab:N.A,Tabbed:X.A,AlertTable:I.A,Banner:$.l,ConfigBadge:be["default"],EventsTable:ye["default"],SimpleBox:he.A,Certificates:Re,TabTitle:We.A},mixins:[q.A],fetch(){(0,Ce.fetchClusterResources)(this.$store,R.NW),this.currentCluster&&((0,W.DD)((0,B.Qr)(this.$store,this.currentCluster.id,[$e,De]),this,"showClusterMetrics","Determine cluster metrics"),(0,W.DD)((0,B.Qr)(this.$store,this.currentCluster.id,[Pe,Ue]),this,"showK8sMetrics","Determine k8s metrics"),(0,W.DD)((0,B.Qr)(this.$store,this.currentCluster.id,[Xe,Ne]),this,"showEtcdMetrics","Determine etcd metrics"),(0,W.DD)((0,U.kj)(this.$store),this,"canViewMetrics","Determine Grafana Permission"),this.currentCluster.isLocal&&this.$store.getters["management/schemaFor"](R.Mc.NODE)&&this.$store.dispatch("management/findAll",{type:R.Mc.NODE}))},data(){return{nodeHeaders:He,constraints:[],cattleAgentResource:"loading",fleetControllerResource:"loading",fleetAgentResource:"loading",disconnected:!1,events:[],nodeMetrics:[],showClusterMetrics:!1,showK8sMetrics:!1,showEtcdMetrics:!1,canViewMetrics:!1,CLUSTER_METRICS_DETAIL_URL:$e,CLUSTER_METRICS_SUMMARY_URL:De,K8S_METRICS_DETAIL_URL:Pe,K8S_METRICS_SUMMARY_URL:Ue,ETCD_METRICS_DETAIL_URL:Xe,ETCD_METRICS_SUMMARY_URL:Ne,STATES_ENUM:we.jv,selectedTab:"cluster-events",extensionCards:(0,xe.A)(this,ke.c7.CARD,ke.O4.CLUSTER_DASHBOARD_CARD,this.$route),canViewEvents:!!this.$store.getters["cluster/schemaFor"](R.ll),clusterServiceIcons:Qe}},beforeUnmount(){this.$store.dispatch("cluster/forgetType",R.ll),this.$store.dispatch("cluster/forgetType",R.NW),this.$store.dispatch("cluster/forgetType",R.Hr),this.$store.dispatch("cluster/forgetType",R.$v.NODE),this.$store.dispatch("cluster/forgetType",R.Mc.NODE),this.$store.dispatch("cluster/forgetType",R.oU.DEPLOYMENT),clearInterval(this.interval)},watch:{canViewAgents:{handler(e,t){e&&!t&&this.loadAgents()},immediate:!0}},computed:{...(0,T.L8)(["currentCluster"]),...(0,U.dO)(),clusterCounts(){return this.$store.getters["cluster/all"](R.i2)},nodes(){return this.$store.getters["cluster/all"](R.NW)},mgmtNodes(){return this.$store.getters["management/all"](R.Mc.CLUSTER)},fleetAgentNamespace(){return this.$store.getters["cluster/canList"](R.oU.DEPLOYMENT)&&this.$store.getters["cluster/byId"](R.CU,"cattle-fleet-system")},cattleAgentNamespace(){if(!this.currentCluster.isLocal)return this.$store.getters["cluster/canList"](R.oU.DEPLOYMENT)&&this.$store.getters["cluster/byId"](R.CU,"cattle-system")},canViewAgents(){return!!this.fleetAgentNamespace||!this.currentCluster.isLocal&&this.cattleAgentNamespace},showClusterTools(){return this.$store.getters["cluster/canList"](R.W8.CLUSTER_REPO)&&this.$store.getters["cluster/canList"](R.W8.APP)},displayProvider(){const e="other";let t=this.currentCluster?.status?.provider||e;return"rke.windows"===t&&(t="rkeWindows"),this.$store.getters["i18n/exists"](`cluster.provider.${t}`)||(t="other"),this.t(`cluster.provider.${t}`)},nodesArchitecture(){const e={};return this.nodes?.forEach(t=>{if(!t.metadata?.state?.transitioning){const s=t.labels?.[M.Pl],r=s||this.t("cluster.architecture.label.unknown");e[r]=(e[r]||0)+1}}),e},architecture(){const e=Object.keys(this.nodesArchitecture);switch(e.length){case 0:return{label:this.t("generic.provisioning")};case 1:return{label:e[0]};default:return{label:this.t("cluster.architecture.label.mixed"),tooltip:e.reduce((e,t)=>`${e}${t}: ${this.nodesArchitecture[t]}<br>`,"")}}},isHarvesterCluster(){return this.currentCluster?.isHarvester},isRKE(){return["rke","rke.windows","rke2","rke2.windows"].includes((this.currentCluster.status.provider||"").toLowerCase())},accessibleResources(){const e=Object.keys(this.clusterCounts?.[0]?.counts||{}).filter(e=>this.$store.getters["type-map/isIgnored"]({id:e})),t=[...new Set([...e,...Ie])];return t.filter(e=>this.$store.getters["cluster/schemaFor"](e))},clusterServices(){const e=[];return Be.forEach(t=>{const s=this.getComponentStatus(t);e.push({name:t,status:s.state,labelKey:`clusterIndexPage.sections.componentStatus.component.${t}.label`,icon:this.clusterServiceIcons[s.state],tooltip:s.tooltip,goTo:()=>null})}),this.cattleAgentNamespace&&e.push({name:"cattle",status:this.cattleAgent.state,labelKey:"clusterIndexPage.sections.componentStatus.component.cattle.label",icon:this.clusterServiceIcons[this.cattleAgent.state],tooltip:this.cattleAgent.tooltip,goTo:()=>this.goToClusterService(this.cattleAgent)}),this.fleetAgentNamespace&&e.push({name:"fleet",status:this.fleetAgent.state,labelKey:"clusterIndexPage.sections.componentStatus.component.fleet.label",icon:this.clusterServiceIcons[this.fleetAgent.state],tooltip:this.fleetAgent.tooltip,goTo:()=>this.goToClusterService(this.fleetAgent)}),e},cattleAgent(){const e=[this.cattleAgentResource];return this.getAgentStatus(e,{checkDisconnected:!0})},fleetAgent(){const e=this.currentCluster.isLocal?[...this.fleetAgentResource?[this.fleetAgentResource,this.fleetControllerResource]:[this.fleetControllerResource]]:[this.fleetAgentResource];return this.getAgentStatus(e)},totalCountGaugeInput(){const e={name:this.t("clusterIndexPage.resourceGauge.totalResources"),total:0,useful:0,warningCount:0,errorCount:0};return this.accessibleResources.forEach(t=>{const s=(0,z.xS)(this.$store,t);Object.entries(s).forEach(t=>{e[t[0]]+=t[1]})}),e},hasStats(){return this.currentCluster?.status?.allocatable&&this.currentCluster?.status?.requested},cpuReserved(){const e=(0,D.ao)(this.currentCluster?.status?.allocatable?.cpu);return{total:e,useful:(0,D.ao)(this.currentCluster?.status?.requested?.cpu),units:this.t("clusterIndexPage.hardwareResourceGauge.units.cores",{count:e})}},podsUsed(){return{total:(0,D.ao)(this.currentCluster?.status?.allocatable?.pods||"0"),useful:(0,D.ao)(this.currentCluster?.status?.requested?.pods||"0")}},ramReserved(){return(0,D.S0)(this.currentCluster?.status?.allocatable?.memory,this.currentCluster?.status?.requested?.memory)},metricAggregations(){let e=this.nodes;if(this.currentCluster.isLocal){const t=this.nodes.reduce((e,t)=>(e[t.id]=t,e),{});e=this.mgmtNodes.filter(e=>{const s=e.metadata?.labels?.["management.cattle.io/nodename"]||e.id;return!!t[s]})}const t=e.some(e=>e.hasARole&&!e.isWorker),s=this.nodeMetrics.filter(e=>{const s=this.nodes.find(t=>t.id===e.id);return s&&(!t||s.isWorker)}),r={cpu:0,memory:0};return(0,fe.isEmpty)(s)?null:s.reduce((e,t)=>(e.cpu+=(0,D.ao)(t.usage.cpu),e.memory+=(0,D.ao)(t.usage.memory),e),r)},cpuUsed(){const e=(0,D.ao)(this.currentCluster?.status?.capacity?.cpu);return{total:e,useful:this.metricAggregations?.cpu,units:this.t("clusterIndexPage.hardwareResourceGauge.units.cores",{count:e})}},ramUsed(){return(0,D.S0)(this.currentCluster?.status?.capacity?.memory,this.metricAggregations?.memory)},hasMonitoring(){return!!this.clusterCounts?.[0]?.counts?.[R.W8.APP]?.namespaces?.["cattle-monitoring-system"]},canAccessNodes(){return!!this.clusterCounts?.[0]?.counts?.[R.NW]},canAccessDeployments(){return!!this.clusterCounts?.[0]?.counts?.[R.oU.DEPLOYMENT]},hasMetricsTabs(){return this.canViewMetrics&&(this.showClusterMetrics||this.showK8sMetrics||this.showEtcdMetrics)},hasBadge(){return!!this.currentCluster?.badge},hasDescription(){return!!this.currentCluster?.spec?.description},allSecretsLink(){return{name:"c-cluster-product-resource",params:{product:Me.NAME,resource:R.bB}}},hasNodes(){return this.nodes?.length>0}},methods:{loadAgents(){this.fleetAgentNamespace&&(this.currentCluster.isLocal?(this.setAgentResource("fleetControllerResource","cattle-fleet-system/fleet-controller"),this.setAgentResource("fleetAgentResource","cattle-fleet-local-system/fleet-agent")):this.setAgentResource("fleetAgentResource","cattle-fleet-system/fleet-agent")),this.cattleAgentNamespace&&(this.setAgentResource("cattleAgentResource","cattle-system/cattle-cluster-agent"),this.interval=setInterval(()=>{this.disconnected=!!this.$store.getters["cluster/inError"]({type:R.NW})},1e3))},async setAgentResource(e,t){try{this[e]=await this.$store.dispatch("cluster/find",{type:R.oU.DEPLOYMENT,id:t})}catch(s){this[e]=null}},getAgentStatus(e,t={checkDisconnected:!1}){if(1===e.length&&null===e[0])return{state:we.jv.OFF};if(e.find(e=>"loading"===e))return{state:we.jv.IN_PROGRESS};for(const s of e)if(!s||t.checkDisconnected&&this.disconnected||s.status.conditions?.find(e=>"True"!==e.status)||s.metadata.state?.error)return{resource:s,tooltip:s?.stateDescription||this.t("clusterIndexPage.sections.componentStatus.tooltip.disconnected"),state:we.jv.UNHEALTHY};for(const s of e)if(s.spec.replicas!==s.status.readyReplicas||s.status.unavailableReplicas>0)return{resource:s,tooltip:s?.stateDescription||this.t("clusterIndexPage.sections.componentStatus.tooltip.unavailableReplicas"),state:we.jv.WARNING};return{state:we.jv.HEALTHY}},getComponentStatus(e){const t=(this.currentCluster?.status?.componentStatuses||[]).filter(t=>t.name.startsWith(e));if(!t.length)return{state:we.jv.HEALTHY};const s=t.reduce((e,t)=>{const s=t.conditions.find(e=>"True"!==e.status);return s?[...e,s]:e},[]);return s.length>0?{tooltip:s[0].message,state:we.jv.UNHEALTHY}:{state:we.jv.HEALTHY}},showActions(){this.$store.commit("action-menu/show",{resources:this.currentCluster,elem:this.$refs["cluster-actions"]})},async loadMetrics(){this.nodeMetrics=await(0,Ce.fetchClusterResources)(this.$store,R.$v.NODE,{force:!0})},tabChange(e){this.selectedTab=e?.selectedName},async goToHarvesterCluster(){try{const e=await this.$store.dispatch("management/findAll",{type:R.qt.RANCHER_CLUSTER}),t=e.find(e=>e.mgmt.id===this.currentCluster.id);await t.goToHarvesterCluster()}catch{}},goToClusterService(e){e.resource&&e.state!==we.jv.HEALTHY&&this.$router.push({name:"c-cluster-product-resource-namespace-id",params:{cluster:this.currentCluster.id,product:"explorer",resource:e.resource.type,namespace:e.resource.metadata.namespace,id:e.resource.metadata.name}})}}};s(18156);const je=(0,K.A)(Fe,[["render",S],["__scopeId","data-v-096fe2b1"]]),Oe=je},80152:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(20641);const a={class:"config-badge"};function n(e,t,s,n,o,i){const l=(0,r.gN)("clean-tooltip"),c=(0,r.gN)("stripped-aria-label");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("div",null,[(0,r.bo)(((0,r.uX)(),(0,r.CE)("button",{class:"badge-install btn btn-sm role-secondary","data-testid":"add-custom-cluster-badge",role:"button",onClick:t[0]||(t[0]=(...e)=>i.customBadgeDialog&&i.customBadgeDialog(...e))},t[1]||(t[1]=[(0,r.Lk)("i",{class:"icon icon-brush-icon"},null,-1)]))),[[l,{content:i.tooltip,triggers:["hover","touch","focus"]}],[c,i.tooltip]])])])}var o=s(46405);const i={props:{cluster:{type:Object,required:!0}},name:"ConfigBadge",computed:{tooltip(){return this.t("clusterBadge.customizeAppearance")}},methods:{customBadgeDialog(){this.$store.dispatch("cluster/promptModal",{component:"AddCustomBadgeDialog",componentProps:{mode:o.G5}})}}};s(63447);var l=s(66262);const c=(0,l.A)(i,[["render",n],["__scopeId","data-v-85b58890"]]),u=c},83145:(e,t,s)=>{"use strict";s.r(t),s.d(t,{fetchClusterResources:()=>a});var r=s(96763);async function a(e,t,s={}){const a=e.getters["cluster/schemaFor"](t);if(a)try{const r=await e.dispatch("cluster/findAll",{type:t,opt:s});return r}catch(n){return r.error(`Failed fetching cluster resource ${t} with error:`,n),[]}return[]}},83714:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});const r={props:{pref:{type:String,default:null},prefKey:{type:String,default:null}},computed:{shown(){let e=!0;if(this.pref){const t=this.$store.getters["prefs/get"](this.pref);e=this.prefKey?!t[this.prefKey]:!t}return e}},methods:{async hide(){if(this.pref){let e=this.$store.getters["prefs/get"](this.pref);this.prefKey&&((!0===e||!1===e||e.length>0)&&(e={}),e[this.prefKey]=!0),await this.$store.dispatch("prefs/set",{key:this.pref,value:e})}}}}},85898:(e,t,s)=>{var r=s(92680);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var a=s(99548).A;a("4b6848cb",r,!0,{sourceMap:!1,shadowMode:!1})},85929:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".badge-install[data-v-85b58890]:hover{cursor:pointer}.badge-install[data-v-85b58890]{display:flex;margin-left:10px}.badge-install[data-v-85b58890]:hover{border-color:var(--lightest)}.badge-install>I[data-v-85b58890]{line-height:inherit}.badge-install[data-v-85b58890]:focus{outline:0}",""]);const c=l},92680:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(31601),a=s.n(r),n=s(76314),o=s.n(n),i=s(5111),l=o()(a());l.i(i.A),l.push([e.id,".simple-box{background:var(--simple-box-bg) 0 0 no-repeat padding-box;box-shadow:0 0 10px var(--simple-box-shadow);border:1px solid var(--simple-box-border);padding:15px}.simple-box .top{line-height:24px;font-size:18px;border-bottom:1px solid var(--simple-box-divider);padding-bottom:15px;margin:0 -15px 10px -15px;padding:0 15px 15px 15px;align-items:center;display:flex .simple-box .top BUTTON;display-padding:0;display-height:fit-content;display-align-self:flex-start}.simple-box .top H2{margin-bottom:0}.simple-box .content{padding:15px}",""]);const c=l}}]);
//# sourceMappingURL=1851.a2b88a4a.js.map