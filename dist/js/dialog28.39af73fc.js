(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[5233],{19509:(e,t,a)=>{var s=a(51256);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var r=a(99548).A;r("4a5721cb",s,!0,{sourceMap:!1,shadowMode:!1})},36888:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(20641),r=a(90033);const i={class:"text-default-text"},l={key:0,class:"mb-10"},n={key:0},o={key:0,class:"mt-10"},c={style:{"align-items":"center"},class:"row mt-10"},d={class:"col pl-5"},u={key:1},p={class:"text-error mb-10"},h={class:"text-default-text"},g={class:"waiting"};function v(e,t,a,v,b,m){const k=(0,s.g2)("LabeledInput"),f=(0,s.g2)("AsyncButton"),y=(0,s.g2)("Banner"),w=(0,s.g2)("Card");return b.waiting?((0,s.uX)(),(0,s.Wv)(w,{key:1,class:"prompt-update","show-highlight-border":!1},{title:(0,s.k6)(()=>[(0,s.Lk)("h4",h,(0,r.v_)(e.t("featureFlags.restart.title")),1)]),body:(0,s.k6)(()=>[(0,s.Lk)("div",g,[(0,s.Lk)("p",null,(0,r.v_)(e.t("featureFlags.restart.wait")),1),t[11]||(t[11]=(0,s.eW)()),t[12]||(t[12]=(0,s.Lk)("span",{class:"restarting-icon"},[(0,s.Lk)("i",{class:"icon icon-spinner icon-spin"})],-1))])]),actions:(0,s.k6)(()=>[(0,s.Lk)("button",{class:"btn role-secondary",onClick:t[2]||(t[2]=(...e)=>m.close&&m.close(...e))},(0,r.v_)(e.t("generic.cancel")),1)]),_:1,__:[13,14]})):((0,s.uX)(),(0,s.Wv)(w,{key:0,class:"prompt-update","show-highlight-border":!1},{title:(0,s.k6)(()=>[(0,s.Lk)("h4",i,(0,r.v_)(e.t("featureFlags.title")),1)]),body:(0,s.k6)(()=>[b.update?((0,s.uX)(),(0,s.CE)("div",l,[b.enabling?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("span",null,(0,r.v_)(e.t("featureFlags.promptActivate",{flag:b.update.id})),1),t[5]||(t[5]=(0,s.eW)()),m.promptForUrl?((0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("span",null,(0,r.v_)(e.t("featureFlags.requiresSetting")),1),t[4]||(t[4]=(0,s.eW)()),(0,s.Lk)("div",c,[(0,s.bF)(k,{value:b.serverUrl,"onUpdate:value":t[0]||(t[0]=e=>b.serverUrl=e),label:e.t("setup.serverUrl.label")},null,8,["value","label"]),t[3]||(t[3]=(0,s.eW)()),(0,s.Lk)("div",d,[(0,s.bF)(f,{onClick:m.saveUrl},null,8,["onClick"])])])])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("span",u,(0,r.v_)(e.t("featureFlags.promptDeactivate",{flag:b.update.id})),1)),t[6]||(t[6]=(0,s.eW)()),b.restart?((0,s.uX)(),(0,s.Wv)(y,{key:2,color:"error",label:e.t("featureFlags.restartRequired",b.vendor)},null,8,["label"])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),t[7]||(t[7]=(0,s.eW)()),(0,s.Lk)("div",p,(0,r.v_)(b.error),1)]),actions:(0,s.k6)(()=>[(0,s.Lk)("button",{class:"btn role-secondary",onClick:t[1]||(t[1]=(...e)=>m.close&&m.close(...e))},(0,r.v_)(e.t("generic.cancel")),1),t[8]||(t[8]=(0,s.eW)()),(0,s.bF)(f,{disabled:m.promptForUrl&&!b.serverUrlSetting.value,mode:b.updateMode,class:"btn bg-error ml-10",onClick:m.toggleFlag},null,8,["disabled","mode","onClick"])]),_:1,__:[9,10]}))}var b=a(66278),m=a(40949),k=a(14492),f=a(16372),y=a(72268),w=a(55823),U=a(95822),_=a(10874);const F={name:"FeatureFlagListDialog",emits:["close"],components:{Card:m.Z,Banner:k.l,LabeledInput:f.o,AsyncButton:y.A},props:{resources:{type:Array,default:()=>[]},registerBackgroundClosing:{type:Function,default:()=>{}}},async fetch(){this.update=this.resources[0],this.update&&(this.restart=this.update.restartRequired,this.enabling=!this.update.enabled,this.updateMode=this.enabling?"activate":"deactivate"),this.serverUrlSetting=this.$store.getters["management/byId"](w.Mc.SETTING,U.HG.SERVER_URL),this.serverUrlSetting?.value?this.serverUrl=this.serverUrlSetting.value:(this.noUrlSet=!0,this.serverUrl=window.location.origin)},data(){return{update:[],updateMode:"activate",error:null,enabling:!1,restart:!1,waiting:!1,timer:null,serverUrlSetting:{},serverUrl:"",noUrlSet:!1,vendor:(0,_.f7)()}},computed:{...(0,b.L8)({t:"i18n/t"}),promptForUrl(){return"multi-cluster-management"===this.update?.id&&this.noUrlSet}},methods:{close(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.$emit("close")},toggleFlag(e){this.restart?this.doToggleWithRestart(e):this.doToggle(e)},async doToggle(e){this.error=null;try{this.update.spec.value=!this.update.enabled,await this.update.save(),e(!0),this.close()}catch(t){this.update.spec.value=!this.update.enabled,this.error=t.message||t,e(!1)}},doToggleWithRestart(e){this.error=null;try{this.update.spec.value=!this.update.enabled,this.update.save()}catch(t){}this.waitForBackend(e,this.update.id),this.waiting=!0},waitForBackend(e,t){const a=`/v3/features/${t}`;this.timer=setTimeout(async()=>{try{const t=await this.$axios.get(a,{timeout:5e3});200===t?.status&&(e(!0),this.waiting=!1,this.close(),await this.$store.dispatch("management/findAll",{type:this.resource,opt:{force:!0}}))}catch(s){}this.waiting&&this.waitForBackend(e,t)},5e3)},async saveUrl(e){try{this.serverUrlSetting.value=this.serverUrl,await this.serverUrlSetting.save(),e(!0)}catch(t){this.error=t,e(!1)}}}};a(19509);var x=a(66262);const L=(0,x.A)(F,[["render",v],["__scopeId","data-v-5baecfdb"]]),C=L},51256:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(31601),r=a.n(s),i=a(76314),l=a.n(i),n=a(5111),o=l()(r());o.i(n.A),o.push([e.id,".prompt-update.card-container[data-v-5baecfdb]{box-shadow:none}.prompt-update[data-v-5baecfdb]  .card-actions{display:flex;justify-content:center}.prompt-update .waiting[data-v-5baecfdb]{text-align:center;font-size:14px;margin:10px 0}.prompt-update .waiting p[data-v-5baecfdb]{line-height:20px}.prompt-update .restarting-icon[data-v-5baecfdb]{display:flex;justify-content:center;margin-top:10px}.prompt-update .restarting-icon>I[data-v-5baecfdb]{font-size:24px}",""]);const c=o}}]);
//# sourceMappingURL=dialog28.39af73fc.js.map