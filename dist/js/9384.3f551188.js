"use strict";(self["webpackChunkcluster_log_extension"]=self["webpackChunkcluster_log_extension"]||[]).push([[9384],{39384:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(20641),r=a(90033);const l={key:1},c={class:"title"},o={class:"m-0"},n={class:"actions-container"},h={class:"actions"};function i(e,t,a,i,u,L){const b=(0,s.g2)("Loading"),E=(0,s.g2)("router-link"),d=(0,s.g2)("ResourceTable"),m=(0,s.g2)("Tab"),T=(0,s.g2)("Tabbed");return e.$fetchState.pending?((0,s.uX)(),(0,s.Wv)(b,{key:0})):((0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("header",null,[(0,s.Lk)("div",c,[(0,s.Lk)("h1",o,(0,r.v_)(e.t("auth.roleTemplate")),1)]),t[0]||(t[0]=(0,s.eW)()),(0,s.Lk)("div",n,[(0,s.Lk)("div",h,[L.canCreate?((0,s.uX)(),(0,s.Wv)(E,{key:0,to:L.createLocation,class:"btn role-primary"},{default:(0,s.k6)(()=>[(0,s.eW)((0,r.v_)(L.createLabel),1)]),_:1},8,["to"])):(0,s.Q3)("",!0)])])]),t[3]||(t[3]=(0,s.eW)()),(0,s.bF)(T,null,{default:(0,s.k6)(()=>[u.tabs[u.GLOBAL].canFetch?((0,s.uX)(),(0,s.Wv)(m,{key:0,name:u.GLOBAL,weight:u.tabs[u.GLOBAL].weight,"label-key":u.tabs[u.GLOBAL].labelKey},{default:(0,s.k6)(()=>[(0,s.bF)(d,{schema:u.tabs[u.GLOBAL].schema,rows:L.globalResources},null,8,["schema","rows"])]),_:1},8,["name","weight","label-key"])):(0,s.Q3)("",!0),t[1]||(t[1]=(0,s.eW)()),u.tabs[u.CLUSTER].canFetch?((0,s.uX)(),(0,s.Wv)(m,{key:1,name:u.CLUSTER,weight:u.tabs[u.CLUSTER].weight,"label-key":u.tabs[u.CLUSTER].labelKey},{default:(0,s.k6)(()=>[(0,s.bF)(d,{schema:u.tabs[u.CLUSTER].schema,headers:u.tabs[u.CLUSTER].headers,rows:L.clusterResources},null,8,["schema","headers","rows"])]),_:1},8,["name","weight","label-key"])):(0,s.Q3)("",!0),t[2]||(t[2]=(0,s.eW)()),u.tabs[u.PROJECT].canFetch?((0,s.uX)(),(0,s.Wv)(m,{key:2,name:u.PROJECT,weight:u.tabs[u.PROJECT].weight,"label-key":u.tabs[u.PROJECT].labelKey},{default:(0,s.k6)(()=>[(0,s.bF)(d,{schema:u.tabs[u.PROJECT].schema,headers:u.tabs[u.PROJECT].headers,rows:L.namespaceResources},null,8,["schema","headers","rows"])]),_:1},8,["name","weight","label-key"])):(0,s.Q3)("",!0)]),_:1,__:[1,2]})]))}var u=a(98642),L=a(24935),b=a(55823),E=a(56935),d=a(57090),m=a(28008),T=a(4218),R=a(21616);const A=m.SUBTYPE_MAPPING.GLOBAL.key,y=m.SUBTYPE_MAPPING.CLUSTER.key,g=m.SUBTYPE_MAPPING.NAMESPACE.key,P={name:`c-cluster-${T.NAME}-roles-resource-create`,params:{cluster:R.w,resource:b.Mc.GLOBAL_ROLE}},p={name:`c-cluster-${T.NAME}-roles-resource-create`,params:{cluster:R.w,resource:b.Mc.ROLE_TEMPLATE}},C={name:"Roles",components:{Tab:u.A,Tabbed:L.A,ResourceTable:E.A,Loading:d.A},async fetch(){const e=this.$store.getters["management/schemaFor"](b.Mc.GLOBAL_ROLE),t=this.$store.getters["management/schemaFor"](b.Mc.ROLE_TEMPLATE);this["globalRoles"]=e?await this.$store.dispatch("management/findAll",{type:b.Mc.GLOBAL_ROLE}):[],this["roleTemplates"]=t?await this.$store.dispatch("management/findAll",{type:b.Mc.ROLE_TEMPLATE}):[]},data(){const e=this.$store.getters["management/schemaFor"](b.Mc.GLOBAL_ROLE),t=this.$store.getters["management/schemaFor"](b.Mc.ROLE_TEMPLATE),a=this.$store.getters["type-map/headersFor"](t),s=a.findIndex(e=>"default"===e.name);return{tabs:{[A]:{canFetch:e?.collectionMethods.find(e=>"GET"===e),canCreate:e?.resourceMethods.find(e=>m.CREATE_VERBS.has(e)),weight:3,labelKey:m.SUBTYPE_MAPPING.GLOBAL.labelKey,schema:e,createLocation:{...P,query:{roleContext:A}}},[y]:{canFetch:t?.collectionMethods.find(e=>"GET"===e),canCreate:t?.resourceMethods.find(e=>m.CREATE_VERBS.has(e)),labelKey:m.SUBTYPE_MAPPING.CLUSTER.labelKey,weight:2,schema:t,headers:this.applyDefaultHeaderLabel(a,s,"tableHeaders.authRoles.clusterDefault"),createLocation:{...p,query:{roleContext:y}}},[g]:{canFetch:t?.collectionMethods.find(e=>"GET"===e),canCreate:t?.resourceMethods.find(e=>m.CREATE_VERBS.has(e)),labelKey:m.SUBTYPE_MAPPING.NAMESPACE.labelKey,weight:1,schema:t,headers:this.applyDefaultHeaderLabel(a,s,"tableHeaders.authRoles.projectDefault"),createLocation:{...p,query:{roleContext:g}}}},GLOBAL:A,CLUSTER:y,PROJECT:g,globalRoles:null,roleTemplates:null}},computed:{globalResources(){return this.globalRoles},clusterResources(){return this.roleTemplates.filter(e=>e.context===m.SUBTYPE_MAPPING.CLUSTER.context)},namespaceResources(){return this.roleTemplates.filter(e=>e.context===m.SUBTYPE_MAPPING.NAMESPACE.context)},type(){return this.$route.hash.endsWith(g)?g:this.$route.hash.endsWith(y)?y:A},canCreate(){return this.tabs[this.type].canCreate},createLabel(){return this.t(`rbac.roletemplate.subtypes.${this.type}.createButton`)},createLocation(){return this.tabs[this.type].createLocation}},methods:{applyDefaultHeaderLabel(e,t,a){const s=[...e];return s[t]={...e[t],labelKey:a},s}}};var _=a(66262);const M=(0,_.A)(C,[["render",i]]),k=M}}]);
//# sourceMappingURL=9384.3f551188.js.map